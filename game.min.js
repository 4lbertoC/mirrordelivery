var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame;var a=document.getElementById("c").getContext("2d"),b=16,c=[100,300],d=!1,e=!1,f=0,g=null,h=[],k=null,l=[5,340],n={};window.addEventListener("keyup",function(m){n[m.keyCode]=void 0},!1);window.addEventListener("keydown",function(m){n[m.keyCode]=Date.now()},!1);var p=0,q=0,r=640/b,s=400/b;
h.length=r*s;for(p=0;p<r;p++)for(q=0;q<s;q++)h[r*q+p]=0;var t=g=new Image;t.width=16;t.height=32;t.src="man.png";t=k=new Image;t.width=80;t.height=48;t.src="truck.png";for(p=960;1E3>p;p++)h[p]=1;h[940]=1;h[941]=1;h[900]=1;h[901]=1;h[942]=2;h[902]=2;h[862]=2;h[822]=2;h[782]=2;h[742]=2;h[783]=1;h[784]=1;h[785]=1;h[786]=1;function u(m){return h[r*Math.round(c[1]/b)+Math.round(c[0]/b)]===m||h[r*Math.round(c[1]/b)+Math.round(c[0]/b+1)]===m?!0:!1}
(function x(){var v=c[0],w=c[1];n[37]&&(c[0]=Math.max(b,v-5));n[38]?2===h[r*Math.round(c[1]/b-1)+Math.round(c[0]/b)]||2===h[r*Math.round(c[1]/b-1)+Math.round(c[0]/b+1)]?c[1]=Math.min(400-b,w-2):d||e||(f=-7,e=d=!0):!n[38]&&d&&(d=!1);n[39]&&(c[0]=Math.min(640-b,v+5));n[40]&&u(2)&&(c[1]=Math.min(400,w+2));0<f&&(u(2)||u(1))?(f=0,e=!1,u(2)||(c[1]=c[1]-c[1]%b+b/2)):c[1]<400-b&&(f+=1);c[1]=Math.min(400-b,c[1]+f);a.setFillColor("black");a.fillRect(0,0,640,400);for(p=0;p<r;p++)for(q=0;q<s;q++)0===h[r*q+p]?
a.setFillColor("00deff"):1===h[r*q+p]?a.setFillColor("green"):2===h[r*q+p]&&a.setFillColor("brown"),a.fillRect(p*b,q*b,b,b);a.drawImage(k,l[0],l[1]);a.drawImage(g,c[0]+8,c[1]-16);a.setFillColor("red");a.fillText("("+c[0]+", "+c[1]+")",10,20);a.fillText("Vert speed: "+f,10,10);a.fillText(r*Math.round(c[1]/b)+Math.round(c[0]/b),10,30);a.fillText(h[r*Math.round(c[1]/b)+Math.round(c[0]/b)],10,40);window.requestAnimationFrame(x)})();
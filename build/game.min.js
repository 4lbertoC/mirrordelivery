var $={};
(function(b){function f(b,c){return c?l(b&255)+f(b>>8,c-1):""}var u=this.fa=b||44100,t=2*u,l=String.fromCharCode,r;this.wa=function(b){var c=Audio,l=btoa,z="",L=b.length;for(m=0;m<L;m++)var h=32767*b[m]|0,h=-32768>h?-32768:32767<h?32767:h,h=h+(0>h?65536:0),z=z+String.fromCharCode(h&255,h>>8);b=z;b=["RIFF",36+(r=b.length),"WAVEfmt ",16,1,1,u,t,2,16,"data",r,b];z="";for(m=0;m<b.length;m++)z+="s"=="s4s4224422s4s"[m]?b[m]:f(b[m],"s4s4224422s4s".charCodeAt(m)-48);return new c("data:audio/wav;base64,"+l(z))};
var h,m,E=Math.sin,c=2*Math.PI;this.filter=function(b,c,f,l,r,u,w,t,n,E){f=f?f:1;l=l?l:b.length;h=b.slice(0);for(m=f;m<l;m++)h[m]=c(b,h,f,l,m,r,u,w,t,n,E);return h};this.filters={Fa:function(b,c,f,l,h,m){return c[h-1]+m*(b[h]-c[h-1])},Ga:function(b,c,f,l,h,m){return c[h-1]+m*(l-h)/(l-f)*(b[h]-c[h-1])},Ea:function(b,c,f,l,h,m){return m*(c[h-1]+b[h]-b[h-1])}};this.ha=function(b,f,l,h,r,t,w,n,E){f=f*c/u;var C=Array(b|0);for(m=0;m<b;m++)C[m]=l(m*f,h,r,t,w,n,E);return C};var n=0;this.w={ya:function(b){4>
b%c&&(n=2*Math.random()-1);return n},Ha:Math.random,Ca:Math.sin,Da:function(b){return E(b)+0.5*E(b/2)+0.3*E(b/4)},Ba:function(b){return 2*(b/c-(b/c+0.5|0))},ia:function(b,c){return E(b)>c?1:E(b)<c?-1:c}}}).apply($);var ka={};
(function(){this.R=[];this.P={square:$.w.ia,saw:$.w.Ba,sine:$.w.Ca,noise:$.w.ya,synth:$.w.Da};this.sa=function(){var b=[],f;for(f in this.P)b.push(f);return b};this.ta=function(){function b(b,r,h,m,t){void 0===t&&(t=(h-r)/1E3);b={name:b,id:b.replace(/ /g,""),min:r,max:h,step:t,ra:m,type:"range",group:u};f.push(b)}var f=[],u=0,t=this.sa();(function(b,r,h){b={name:b,id:b.replace(/ /g,""),options:r,ra:h,type:"option",group:u};f.push(b)})("Generator",t,t[0]);b("SuperSamplingQuality",0,16,0,1);b("MasterVolume",
0,1,0.4);u++;b("AttackTime",0,1,0.1);b("SustainTime",0,2,0.3);b("SustainPunch",0,3,2);b("DecayTime",0,2,1);u++;b("MinFrequency",20,2400,0,1);b("StartFrequency",20,2400,440,1);b("MaxFrequency",20,2400,2E3,1);b("Slide",-1,1,0);b("DeltaSlide",-1,1,0);u++;b("VibratoDepth",0,1,0);b("VibratoFrequency",0.01,48,8);b("VibratoDepth Slide",-0.3,1,0);b("VibratoFrequencySlide",-1,1,0);u++;b("ChangeAmount",-1,1,0);b("ChangeSpeed",0,1,0.1);u++;b("SquareDuty",0,0.5,0);b("SquareDutySweep",-1,1,0);u++;b("RepeatSpeed",
0,0.8,0);u++;b("PhaserOffset",-1,1,0);b("PhaserSweep",-1,1,0);u++;b("LPFilterCutoff",0,1,1);b("LPFilterCutoffSweep",-1,1,0);b("LPFilterResonance",0,1,0);b("HPFilterCutoff",0,1,0);b("HPFilterCutoffSweep",-1,1,0);return f};this.ha=function(b){var f=2*Math.PI,u=Math.sin,t=Math.pow,l=Math.abs,r=$.fa,h=b.SuperSamplingQuality|0;1>h&&(h=1);for(var r=r*h,m=[{v:0,K:1,time:b.AttackTime},{v:1+b.SustainPunch,K:1,time:b.SustainTime},{v:1,K:0,time:b.DecayTime}],E=m.length,c=0;c<E;c++)m[c].H=1+(m[c].time*r|0);for(var n=
void 0,W=0,Y=-1,y=0,z=-1,L=0,c=0;c<E;c++)L+=m[c].H;L<r/2&&(L=r/2);var fa=Array(L/h|0),w=0,ca=0,ga=ka.P[b.Generator];void 0===ga&&(ga=this.P.ia);var C=0,C=b.SquareDuty,aa=b.SquareDutySweep/r,Q=0,M=b.StartFrequency*f/r,R=1+64*t(b.Slide,3)/r,N=t(b.DeltaSlide,3)/(1E3*r);void 0!==h&&(N/=h);b.MinFrequency>b.StartFrequency&&(b.MinFrequency=b.StartFrequency);b.MaxFrequency<b.StartFrequency&&(b.MaxFrequency=b.StartFrequency);for(var X=b.MinFrequency*f/r,ha=b.MaxFrequency*f/r,ia=0,ja=b.VibratoFrequency*f/r,
S=b.VibratoDepth,qa=1+3*t(b.VibratoFrequencySlide,3)/r,F=b.VibratoDepthSlide/r,d=0,Z=b.ChangeSpeed*r,s=t(b.ChangeAmount,2),s=0<b.ChangeAmount?1+10*s:1-0.9*s,q=Array(1024),c=0;1024>c;c++)q[c]=0;var O=0,T=1020*t(b.PhaserOffset,2),A=4E3*t(b.PhaserSweep,3)/r,G=1E-5<l(A)||1E-5<l(T),H=0.0010<b.HPFilterCutoff||0.999>b.LPFilterCutoff,k=0,D=0,P=t(b.LPFilterCutoff,3)/10,x=1+b.HPFilterCutoffSweep/1E4,v=5/(1+20*t(b.LPFilterResonance,2))*(0.01+b.LPFilterCutoff);0.8<v&&(v=0.8);var v=1-v,ra=0.999>b.LPFilterCutoff,
U=0,V=t(b.HPFilterCutoff,2)/10,ua=1+b.HPFilterCutoffSweep/1E4,da=0,la=L;0<b.RepeatSpeed&&(la=t(1-b.RepeatSpeed,2)*r+32);for(var a=b.MasterVolume,K=0,c=0;c<L;c++)w=ga(Q,C,0),C+=aa,0>C?C=0:0.5<C&&(C=0.5),da>la&&(Q=0,M=b.StartFrequency*f/r,R=1+3*t(b.Slide,3)/r,N=t(b.DeltaSlide,3)/(1E3*r),void 0!==h&&(N/=h),d=0,Z=b.ChangeSpeed*r,s=1+(b.ChangeAmount|0)/12,da=0),da+=1,Q+=M,R+=N,M*=R,d>Z&&(M*=s,Z=L),d+=1,M>ha?M=ha:M<X&&(M=X),ia+=ja,n=M*u(ia)*S,Q+=n,ja*=qa,F&&(S+=F,0>S?F=S=0:1<S&&(S=1,F=0)),H&&(0.0010<l(V)&&
(V*=ua,1E-5>V?V=1E-5:0.1<V&&(V=0.1)),n=k,P*=x,0>P?P=0:0.1<P&&(P=0.1),ra?(D+=(w-k)*P,D*=v):(k=w,D=0),k+=D,U+=k-n,w=U*=1-V),G&&(T+=A,0>T&&(T=-T,A=-A),1023<T&&(T=1023,A=0),q[O]=w,w+=q[O-(T|0)+1024&1023],O=O+1&1023),c>z&&(Y+=1,n=Y<E?m[Y]:{v:0,K:0,H:L},W=n.v,y=(n.K-n.v)/(n.H+1),z+=n.H),w*=W,W+=y,w*=a,1<h?(ca+=w,0===(c+1)%h&&(fa[K]=ca/h,K+=1,ca=0)):fa[c]=w;b=r/100|0;f=Array(b);for(c=0;c<b;c++)f[c]=0;return f.concat(fa).concat(f)};this.R=this.ta()}).apply(ka);var va={};(function(){this.ga=function(b){b=ka.ha(this.qa(b));return $.wa(b)};this.qa=function(b){for(var f={},u=ka.R.length,t=0;t<u;t++)f[ka.R[t].id]=b[t];return f}}).apply(va);(function(){var b,f,u,t,l,r,h,m,E,c;function n(a,b,c,e){var f=new Image;f.width=b||16;f.height=c||16;f.onload=e;f.src=a;return f}function W(a){var b=document.createElement("canvas"),c=n("img/man2.png",32,32,function(){var e=b.getContext("2d");a&&(e.translate(32,0),e.scale(-1,1));e.drawImage(c,0,0)});b.width=32;b.height=32;return b}function Y(){p.e&&0<wa.length&&(xa[wa.shift()].play(),setTimeout(Y,200))}function y(a,b){ma[a]=va.ga(b)}function z(a){ma[a]&&(ma[a].pause(),ma[a].currentTime=0,ma[a].play())}
function L(a,b,c,e,f){var h=a.fillColor,d=a.textAlign;a.fillStyle="black";f&&(a.textAlign=f);for(b=b.slice();0<b.length;)a.fillText(b.shift(),c,e),e+=10;a.fillStyle=h;a.textAlign=d}function fa(a){var b=a.k,c,e,f,h;na.s=b;for(var d=I.length=0;d<a.d.length;d++)c=a.d[d],e=Object.create(na),e.size=c,f=document.createElement("canvas"),f.width=U+c,f.height=U+c,h=f.getContext("2d"),h.fillStyle="yellow",h.fillRect(0,0,U+c,U+c),h.fillStyle="black",h.fillText(c,5,10),e.b=f,f=b[0]+16*d,c=b[1]-c,e.position=[f,
c],e.s=[f,c],I.push(e)}function w(b){b=p.p=B[b]||B[s];p.e=!1;a.position=b.o.slice();l=b.n.slice();a.u=0;a.J=0;a.c=void 0;a.d=ra;a.m=!1;a.r=!1;a.a=!1;a.l=!1;a.h=!0;r=da;h=0;p.time=0;p.g=!1;A=0;b.j?(f=b.j.slice(),u=[b.j[0]+15,b.j[1]+23],c=u.slice()):u=f=null;K="4444444444444444444444444444444444444444"+b.map+"4444444444444444444444444444444444444444";K=K.split("");fa(b);ea.length=0;ba.length=0;sa.width=G;sa.height=H;var d=sa.getContext("2d");d.fillStyle="rgba(0,0,0,0.7)";d.fillRect(0,0,G,H);d.fillStyle=
"#fff";d.font="20px courier";d.textAlign="center";d.fillText(p.p.name,G/2,H/2-50);d.fillText("Delivery Boy "+p.T+" - "+p.V+" Crow",G/2,H/2);d.font="15px courier";d.fillText("Select level with arrows",G/2,H/2+80);d.fillText("Click the crow to start!",G/2,H/2+100);d.fillText(b.F?"N: new   E: edit   D: delete   J: insert/copy JSON":"E: edit",G/2,H/2+120);d.beginPath();d.arc(l[0],l[1],16,0,360);d.lineWidth=1;d.strokeStyle="#fff";d.stroke();wa=la.slice()}function ca(){p.T+=1;F.style.cursor="auto";z(v.ea);
w(s)}function ga(){p.V+=1;F.style.cursor="auto";z(v.Z);w(s)}function C(a){return[a.clientX-p.U.left,a.clientY-p.U.top]}function aa(){return Math.max(1,a.speed+a.I-(void 0!==a.c?I[a.c].size:0))}function Q(a,b){return Math.round(a[0]/k)===Math.round(b[0]/k)&&Math.round(a[1]/k)===Math.round(b[1]/k)}function M(){var b=a.D,c=aa();a.a||(b=0);b=Math.min(c,b+c/5);a.D=b;return X(x.i)?c/3:b}function R(b){return Q(a.position,[a.position[0],a.position[1]+k/2])||K[D*Math.round(a.position[1]/k)+Math.round(a.position[0]/
k-1)]!==b&&K[D*Math.round(a.position[1]/k)+Math.round(a.position[0]/k)]!==b?!1:!0}function N(a,b){return K[D*Math.round(a[1]/k-1)+Math.round(a[0]/k-0.5)]===b?!0:!1}function X(b){return N(a.position,b)}function ha(a,b){return Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)}function ia(){return void 0!==a.c?I[a.c]:void 0}function ja(){var b=ia();b&&(z(v.ca),a.c=void 0,b.position=b.s.slice(),a.d--,0>=a.d&&ga())}function S(){var b=ia();b&&a.f>ua-b.size&&ja()}function qa(a,b,c){var e=null,f="#00deff";a===
x.C?e=oa.pa.b:a===x.S?e=oa.na.b:a===x.oa?f="#000":a===x.$?f="#0f0":a===x.Q?e=oa.ma.b:a===x.i?e=oa.la.b:a===x.t&&(e=oa.ka.b);d.fillStyle=f;d.fillRect(b,c,k,k);null!==e&&d.drawImage(e,b,c,k,k)}window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;var F=document.getElementById("c"),d=F.getContext("2d"),Z=0,s=0,q=[0,0],O=!1,T=1,A=0,G=640,H=400,k=16,D=G/k,P=H/k,x={EMPTY:"0",C:"1",i:"2",S:"3",oa:"4",
$:"5",Q:"6",t:"7"},v={ba:0,ca:1,Y:2,ja:3,M:4,X:5,ea:6,Z:7,da:8,N:9,t:10,aa:11},ra=10,U=12,V=[1,-6],ua=12,da=10,la="023123467".split(""),a={position:null,speed:4,D:0,I:0,J:0,va:2,ua:-7,r:!1,l:!1,a:!1,m:!1,f:0,images:{B:W(),G:W(!0)},Ia:!1,c:void 0,u:0,d:ra,h:!0};l=null;b=n("img/crow2.png");m=3;E=!1;h=0;r=da;var K=[],oa={la:{b:n("img/ladder.png")},ma:{b:n("img/nest.png")},ka:{b:n("img/dispenser.png")},na:{b:n("img/roof.gif")},pa:{b:n("img/wall.gif")}},na={b:null,size:1,position:null,s:[0,0]},I=[],Aa=
{b:n("img/crumbs.png"),position:null},ea=[],Ba={b:n("img/shot.png"),position:null,speed:6},ba=[],p={e:!1,U:F.getBoundingClientRect(),time:0,T:0,V:0,p:null,g:!1},sa=document.createElement("canvas");c=null;f=[80,53];t=n("img/granny.png");u=[95,78];var B=[{name:"Tutorial 1",o:[33,370],n:[G-24,24],k:[53,365],map:"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005555000000000000000000000000000000000000555500000000000000000000000000000000000055551111111111111111111111111111111111111111",
d:[1],q:3E4,A:{L:["PLAYER 1","ARROWS: move/jump","SPACEBAR: grab/release crate","Leave crate into the green zone."],O:["PLAYER 2","MOUSE: move","LClick: shoot","RClick: recharge from nest","Shoot boy to make his crate fall."]}},{name:"Tutorial 2",o:[33,370],n:[G-24,24],k:[53,365],map:"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033333300000000000000000000000000000333330000000000000000000000000000000000005555000000000000000000000000000000000000555500000000007000000000000000000000000055551111111111111111111111111111111111111111",
d:[3],q:3E4,A:{L:["SPACEBAR: buy candies when not holding a crate.","E: use candy","Candies give a speed boost."],O:["Roofs block shots.","Don't touch the roofs or the boy.","RClick: eat candy crumbs to get 5 shots."]}},{name:"Tutorial 3",o:[33,370],n:[G-24,24],k:[53,365],j:[100,227],map:"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333333300000000000000000000000000000000055555500000000000000000000000000000000005555550000000000000000000000000000000000555555000000000200000000000000033330000011111111111111120000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000700200033333300000000021111111100011111111120000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000000000000020001111111111111111111111111111111111111111",
d:[2,3],q:6E4,A:{L:["ARROWS: climb ladder","Crates will break if you fall from too high."],O:["Don't get shot!","Hide in the nest."]}},{name:"Level 5",o:[75,370],n:[G-24,24],k:[83,365],j:[80,53],map:"33333300000000000000000000000000000000605555530000000000000000000000000000000011555550000000000000000000003333000000000055555000000000000002000000000000000000001111110010011001111201110011110000000000000000000000000000020000000000100000000000000000000000000702000000000001000000000001110000000000111111000000000010020000002000000000000033333330000333330102100000200033333300000000000000000000000200000020000000000000000000000000000000020000002000000000000010010010011000020202000000201111111111111000000033311001111211100020033333333330000000000003300000033333002000000000000000000000000000000000000000200000000000000000200000000000020000000020111100111110011120111001111112011111002000000000000000002000000000000200000000200000000000000000207000000000020000000000333330000000000011110000200002000000000000000000000000000000000021111200000000000000000000000000000000002000000000001111111111111111111111111111111111111111",
d:[1,2,3],q:3E5}],pa={W:{},Aa:function(a){pa.W[a.keyCode]=void 0},za:function(a){pa.W[a.keyCode]=Z}};window.addEventListener("keyup",pa.Aa,!1);window.addEventListener("keydown",pa.za,!1);for(var ya=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],xa={},ta=0;ta<ya.length;ta++)xa[ta]=va.ga(["synth",0,0.4,0,0.208,0,0.12,20,ya[ta],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);var wa=la.slice(),ma={};y(v.ba,["square",0,0.4,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,
0,0,0,0.783,0,0,0,0]);y(v.ca,["noise",0,0.4,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);y(v.X,["square",0,0.4,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);y(v.da,["saw",0,0.4,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);y(v.Y,["saw",0,0.4,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,0,0.5,-0.592,0,0.094,0.066,1,0,0,0.28,0]);y(v.Z,["synth",0,0.4,0,0.32,0.348,0.44,20,372,417,0,0,
0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);y(v.ea,["synth",0,0.4,0,0.13,0.345,0.41,253,1168,1407,-0.0060,-0.082,0,0.01,3E-4,0,0.206,0.166,0,0,0,0,0,1,0,0,0,0]);y(v.M,["noise",0,0.4,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);y(v.ja,["noise",0,0.4,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);y(v.N,["square",0,0.4,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);
y(v.t,["square",0,0.4,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);y(v.aa,["noise",0,0.4,0,0.108,0.336,0.124,20,462,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);w(s);F.addEventListener("click",function(){if(p.g)if(8===A)a.position[0]=q[0],a.position[1]=q[1];else if(9===A)l[0]=q[0],l[1]=q[1];else if(10===A&&f)f[0]=q[0],f[1]=q[1],u=[f[0]+15,f[1]+23],c=u.slice();else{if(11===A){na.s[0]=q[0];na.s[1]=q[1];for(var b=0;b<I.length;b++){var d=I[b];d.position[0]=q[0]+
16*b;d.position[1]=q[1]-d.size}}}else p.e?0<m&&h<Z&&(m--,z(v.Y),b=Object.create(Ba),b.position=l.slice(),ba.push(b)):q[0]>l[0]-16&&(q[0]<l[0]+16&&q[1]>l[1]-16&&q[1]<l[1]+16)&&(p.e=!0,p.time=Z+p.p.q,Y(),F.style.cursor="none")});F.addEventListener("mousedown",function(a){1===a.which&&(O=!0);p.g&&(O&&8>A)&&(a=Math.floor(q[1]/k),0<a&&a<P-1&&(K[D*a+Math.floor(q[0]/k)]=""+A))});F.addEventListener("mouseup",function(a){1===a.which&&(O=!1)});F.addEventListener("mousemove",function(a){var b=C(a);q=[b[0],b[1]];
p.e?l=C(a).slice():p.g&&O&&8>A&&(a=Math.floor(q[1]/k),0<a&&a<P-1&&(K[D*a+Math.floor(q[0]/k)]=""+A))});F.addEventListener("contextmenu",function(a){a.preventDefault();if(p.e&&h<Z)if(a=C(a),K[D*Math.round(l[1]/k-0.5)+Math.round(l[0]/k-0.5)]===x.Q&&3>m)z(v.N),m++;else{var b;for(b=0;b<ea.length;b++)if(Q(a,ea[b].position)){m=Math.max(m,5);z(v.N);ea.splice(b,1);break}}});(function za(n){var e=aa(),y=a.va,C=a.position[0],O=a.position[1],g=pa.W;if(p.e||p.g){if(p.g){g[37]&&!a.a&&(A=(A+12-1)%12,a.a=!0);g[39]&&
!a.a&&(A=(A+1)%12,a.a=!0);g[71]&&!a.a&&(f instanceof Array?c=u=f=null:(f=[32,32],u=[f[0]+15,f[1]+23],c=u.slice()),a.a=!0);if(g[67]&&!a.a){a.a=!0;try{var J=JSON.parse(prompt("Set crates",JSON.stringify(B[s].d)));if(J instanceof Array)for(e=0;e<J.length;e++)"number"===!typeof e&&alert("Crates not valid"),J[e]=Math.min(1,Math.max(5,e));B[s].d=J;fa(B[s])}catch(U){alert("Crates not valid: "+U.message)}g[67]=void 0}g[37]||(g[39]||g[71]||g[67])||(a.a=!1)}else if(p.e){if(!g[32]||a.r||a.l||a.m)g[69]&&!a.m?
(a.m=!0,0<a.u&&(a.u--,a.I=3,a.J=n+5E3,J=Object.create(Aa),J.position=[a.position[0]+4,a.position[1]-7],ea.push(J),z(v.da))):g[32]||(g[69]||!a.m)||(a.m=!1);else{a.m=!0;a:{var J=a.c,W=void 0!==J?I[J]:void 0;if(void 0===W){for(J=0;J<I.length;J++)if(Q(a.position,I[J].position)){a.c=J;z(v.M);break a}X(x.t)&&(a.u=3,z(v.t))}else a.c=void 0,z(v.M),X(x.$)&&void 0!==W&&(I.splice(J,1),0>=I.length?ca():z(v.X))}}g[38]?X(x.i)?(a.position[1]=Math.min(H-k,O-y),a.a=!0):a.r||a.l||(a.f=a.ua,a.D=e,a.r=!0,a.l=!0,z(v.ba)):
!g[38]&&a.r&&(a.r=!1);g[37]&&(a.position[0]=Math.max(k,C-M()),a.a=!0,a.h=!1);g[39]&&(a.position[0]=Math.min(G-2*k,C+M()),a.a=!0,a.h=!0);g[40]&&((X(x.i)||R(x.i))&&!R(x.C))&&(a.position[1]=Math.min(H,O+y),a.a=!0);g[37]||(g[38]||g[39]||g[40])||(a.a=!1)}g[27]&&(F.style.cursor="auto",p.g&&(B[s].map=K.join("").substring(D,D*P-D),B[s].o=a.position.slice(),B[s].n=l.slice(),f instanceof Array&&(B[s].j=f.slice()),B[s].k=na.s.slice()),w(s))}else{g[37]&&!a.a&&(s=(s+B.length-1)%B.length,w(s),a.a=!0);g[39]&&!a.a&&
(s=(s+1)%B.length,w(s),a.a=!0);g[69]&&!a.a&&(B[s].F||(e=B[s],e={name:"CustomLevel"+T++,o:e.o.slice(),n:e.n.slice(),k:e.k.slice(),j:e.j&&e.j.slice(),map:e.map,d:e.d.slice(),q:e.q,F:!0},B.push(e),s=B.length-1,w(s)),p.g=!0);g[68]&&!a.a&&(a.a=!0,B[s].F&&(B.splice(s,1),s--,w(s)));if(g[74]&&B[s].F&&!a.a){if(y=e=prompt("LEVEL JSON",JSON.stringify(B[s])))a:{try{JSON.parse(e);y=!0;break a}catch(Y){alert("Level not valid: "+Y.message)}y=!1}y&&(B[s]=JSON.parse(e),w(s));g[74]=void 0}g[37]||(g[39]||g[69]||g[74])||
(a.a=!1)}Z=n;if(p.e){p.U=F.getBoundingClientRect();a.f>k/2&&(a.f+a.position[1]>a.xa&&a.f)&&(a.f=k/2,S());if(X(x.i)||R(x.i)||R(x.C)||a.position[1]>H-k){if(R(x.i)||0<a.f)S(),a.f=0,a.D=0,a.l=!1;X(x.i)||R(x.i)||0!==a.f||(a.position[1]=a.position[1]-a.position[1]%k+1)}else S(),a.f+=1,a.l=!0;a.position[1]+=a.f;g=a.position[0];for(e=a.position[1];e<H-k&&!N([g,e],x.C);)e+=k;e-=e%k;a.xa=e;void 0!==a.c&&(I[a.c].position[0]=a.position[0]+V[0],I[a.c].position[1]=a.position[1]+V[1]);a.J<n&&0<a.I&&(a.I=0);for(g=
0;g<ba.length;g++)if(e=ba[g],e.position[1]+=e.speed,Q(a.position,e.position))ja(),ba.splice(g,1),g--;else if(e.position[1]>H||N(e.position,x.S))ba.splice(g,1),g--;p.time<n&&ga();E=Math.pow(7*aa()+75,2)>=ha(l,a.position);f&&(g=N(l,x.Q)?u:l,e=Math.atan((g[1]-c[1])/(g[0]-c[0])),y=c[0]>g[0]?-1:1,3<Math.abs(g[0]-c[0])||3<Math.abs(g[1]-c[1]))&&(c[0]+=1*Math.cos(e)*y,c[1]+=1*Math.sin(e)*y);(Math.pow(7*aa()+25,2)>=ha(l,a.position)||N(l,x.S)||f&&3>Math.sqrt(ha(c,l)))&&h<n&&(h=n+5E3,z(v.aa),m=0,r--,0>=r&&ca())}d.fillStyle=
"black";d.fillRect(0,0,G,H);for(g=0;g<D;g++)for(e=0;e<P;e++)qa(K[D*e+g],g*k,e*k);for(e=0;e<I.length;e++)e!==a.c&&(g=I[e],d.drawImage(g.b,g.position[0]-8,g.position[1]-8));for(e=0;e<ea.length;e++)g=ea[e],d.drawImage(g.b,g.position[0]-8,g.position[1]-8);for(e=0;e<ba.length;e++)g=ba[e],d.drawImage(g.b,g.position[0]-8,g.position[1]-8);f&&d.drawImage(t,f[0],f[1]);p.p.A&&(L(d,p.p.A.L,120,330),L(d,p.p.A.O,620,70,"right"));p.e?a.l?d.drawImage(a.h?a.images.B:a.images.G,a.h?0:16,0,16,32,a.position[0]-8,a.position[1]-
24,16,32):a.a?d.drawImage(a.h?a.images.B:a.images.G,1>Math.floor(n/100)%2?0:17,0,15,32,a.position[0]-8,a.position[1]-24,16,32):d.drawImage(a.h?a.images.B:a.images.G,a.h?17:0,0,15,32,a.position[0]-8,a.position[1]-24,16,32):d.drawImage(a.h?a.images.B:a.images.G,a.h?17:0,0,15,32,a.position[0]-8,a.position[1]-24,16,32);void 0!==a.c&&(g=I[a.c],d.drawImage(g.b,a.h?g.position[0]-16-g.size:g.position[0]+2,g.position[1]-10));E&&(d.beginPath(),d.arc(a.position[0],a.position[1],7*aa()+25,0,360),d.lineWidth=
2,d.strokeStyle="#f09",d.stroke());p.e?h>n&&0===Math.floor(n/100)%2||d.drawImage(b,3>Math.floor(n/100)%6?0:16,0,16,16,l[0]-8,l[1]-8,16,16):d.drawImage(b,0,0,16,16,l[0]-8,l[1]-8,16,16);f&&(d.fillStyle="red",d.fillRect(c[0]-1,c[1]-1,2,2),d.beginPath(),d.arc(c[0],c[1],5,0,360),d.lineWidth=2,d.strokeStyle="red",d.stroke());d.fillStyle="#00deff";d.fillText("BOY",10,396);d.fillStyle="red";d.fillText("CROW",600,12);d.fillStyle="white";d.fillText("SPEED: "+aa()+"   BOOST: "+Math.max(0,Math.ceil((a.J-n)/1E3))+
"   TIME: "+Math.max(0,Math.ceil((p.time-n)/1E3))+"   CANDIES: "+a.u+"   CRATES: "+a.d,50,396);d.fillText("SHOTS: "+m+"   STUN: "+Math.max(0,Math.ceil((h-n)/1E3))+"   HEALTH: "+r,410,12);p.g&&d.fillText("< > CHANGE BLOCK   G: GRANNY   C: CRATES",12,12);p.e||p.g||d.drawImage(sa,0,0);p.g&&(d.globalAlpha=0.6,8>A?(qa(""+A,q[0]-q[0]%k,q[1]-q[1]%k),d.strokeStyle="#000",d.strokeRect(q[0]-q[0]%k,q[1]-q[1]%k,k,k)):8===A?d.drawImage(a.images.B,17,0,15,32,q[0]-8,q[1]-24,16,32):9===A?d.drawImage(b,0,0,16,16,
q[0]-8,q[1]-8,16,16):10===A?d.drawImage(t,q[0],q[1]):11===A&&(d.fillStyle="yellow",d.fillRect(q[0]-8,q[1]-8,16,16),d.fillStyle="#000",d.fillText("C",q[0]-4,q[1]+4)),d.globalAlpha=1);window.requestAnimationFrame(za)})()})();

var h={};
(function(a){function d(a,b){return b?p(a&255)+d(a>>8,b-1):""}var c=this.n=a||44100,b=2*c,p=String.fromCharCode;this.J=function(a){var f=Audio,n=btoa,p="",ia=a.length;for(g=0;g<ia;g++)var q=32767*a[g]|0,q=-32768>q?-32768:32767<q?32767:q,q=q+(0>q?65536:0),p=p+String.fromCharCode(q&255,q>>8);a=p;a=["RIFF",36+(l=a.length),"WAVEfmt ",16,1,1,c,b,2,16,"data",l,a];p="";for(g=0;g<a.length;g++)p+="s"=="s4s4224422s4s"[g]?a[g]:d(a[g],"s4s4224422s4s".charCodeAt(g)-48);return new f("data:audio/wav;base64,"+n(p))};
var f,g,r=Math.sin,u=2*Math.PI;this.filter=function(a,b,c,d,p,q,n,s,r,u){c=c?c:1;d=d?d:a.length;f=a.slice(0);for(g=c;g<d;g++)f[g]=b(a,f,c,d,g,p,q,n,s,r,u);return f};this.filters={aa:function(a,b,c,d,f,g){return b[f-1]+g*(a[f]-b[f-1])},ba:function(a,b,c,d,f,g){return b[f-1]+g*(d-f)/(d-c)*(a[f]-b[f-1])},$:function(a,b,c,d,f,g){return g*(b[f-1]+a[f]-a[f-1])}};this.p=function(a,b,d,f,p,n,r,s,Y){b=b*u/c;var Z=Array(a|0);for(g=0;g<a;g++)Z[g]=d(g*b,f,p,n,r,s,Y);return Z};var n=0;this.d={q:function(a){4>
a%u&&(n=2*Math.random()-1);return n},ca:Math.random,s:Math.sin,u:function(a){return r(a)+0.5*r(a/2)+0.3*r(a/4)},r:function(a){return 2*(a/u-(a/u+0.5|0))},j:function(a,b){return r(a)>b?1:r(a)<b?-1:b}}}).apply(h);var da={};
(function(){this.i=[];this.g={j:h.d.j,r:h.d.r,s:h.d.s,q:h.d.q,u:h.d.u};this.H=function(){var a=[];for(e in this.g)a.push(e);return a};this.I=function(){function a(a,b,g,r,u){void 0===u&&(u=(g-b)/1E3);a={name:a,id:a.replace(/ /g,""),min:b,max:g,step:u,G:r,type:"range",group:c};d.push(a)}var d=[],c=0,b=this.H();(function(a,b,g){a={name:a,id:a.replace(/ /g,""),options:b,G:g,type:"option",group:c};d.push(a)})("Generator",b,b[0]);a("Super Sampling Quality",0,16,0,1);a("Master Volume",0,1,0.4);c++;a("Attack Time",
0,1,0.1);a("Sustain Time",0,2,0.3);a("Sustain Punch",0,3,2);a("Decay Time",0,2,1);c++;a("Min Frequency",20,2400,0,1);a("Start Frequency",20,2400,440,1);a("Max Frequency",20,2400,2E3,1);a("Slide",-1,1,0);a("Delta Slide",-1,1,0);c++;a("Vibrato Depth",0,1,0);a("Vibrato Frequency",0.01,48,8);a("Vibrato Depth Slide",-0.3,1,0);a("Vibrato Frequency Slide",-1,1,0);c++;a("Change Amount",-1,1,0);a("Change Speed",0,1,0.1);c++;a("Square Duty",0,0.5,0);a("Square Duty Sweep",-1,1,0);c++;a("Repeat Speed",0,0.8,
0);c++;a("Phaser Offset",-1,1,0);a("Phaser Sweep",-1,1,0);c++;a("LP Filter Cutoff",0,1,1);a("LP Filter Cutoff Sweep",-1,1,0);a("LP Filter Resonance",0,1,0);a("HP Filter Cutoff",0,1,0);a("HP Filter Cutoff Sweep",-1,1,0);return d};this.p=function(a){var d=2*Math.PI,c=Math.sin,b=Math.pow,p=Math.abs,f=h.n,g=a.T|0;1>g&&(g=1);for(var f=f*g,r=[{c:0,f:1,time:a.K},{c:1+a.U,f:1,time:a.V},{c:1,f:0,time:a.L}],u=r.length,n=0;n<u;n++)r[n].e=1+(r[n].time*f|0);for(var K=void 0,qa=0,ra=-1,Xa=0,ia=-1,q=0,n=0;n<u;n++)q+=
r[n].e;q<f/2&&(q=f/2);var Ga=Array(q/g|0),s=0,Y=0,Z=da.g[a.M];void 0===Z&&(Z=this.g.j);var Q=0,Q=a.R;square_slide=a.S/f;var $=0,G=a.b*d/f,sa=1+64*b(a.D,3)/f,aa=b(a.w,3)/(1E3*f);void 0!==g&&(aa/=g);a.m>a.b&&(a.m=a.b);a.l<a.b&&(a.l=a.b);for(var Ya=a.m*d/f,Za=a.l*d/f,Ha=0,Ia=a.Y*d/f,U=a.W,zb=1+3*b(a.Z,3)/f,ta=a.X/f,ua=0,Ja=a.v*f,ka=b(a.k,2),ka=0<a.k?1+10*ka:1-0.9*ka,Ka=Array(1024),n=0;1024>n;n++)Ka[n]=0;var va=0,N=1020*b(a.P,2),la=4E3*b(a.Q,3)/f,Ab=1E-5<p(la)||1E-5<p(N),Bb=0.0010<a.A||0.999>a.h,ba=0,
ca=0,V=b(a.h,3)/10,Cb=1+a.B/1E4,ma=5/(1+20*b(a.N,2))*(0.01+a.h);0.8<ma&&(ma=0.8);var ma=1-ma,Db=0.999>a.h,wa=0,R=b(a.A,2)/10,Eb=1+a.B/1E4,xa=0,$a=q;0<a.C&&($a=b(1-a.C,2)*f+32);for(var Fb=a.O,La=0,n=0;n<q;n++)s=Z($,Q,0),Q+=square_slide,0>Q?Q=0:0.5<Q&&(Q=0.5),xa>$a&&($=0,G=a.b*d/f,sa=1+3*b(a.D,3)/f,aa=b(a.w,3)/(1E3*f),void 0!==g&&(aa/=g),ua=0,Ja=a.v*f,ka=1+(a.k|0)/12,xa=0),xa+=1,$+=G,sa+=aa,G*=sa,ua>Ja&&(G*=ka,Ja=q),ua+=1,G>Za?G=Za:G<Ya&&(G=Ya),Ha+=Ia,K=G*c(Ha)*U,$+=K,Ia*=zb,ta&&(U+=ta,0>U?ta=U=0:1<
U&&(U=1,ta=0)),Bb&&(0.0010<p(R)&&(R*=Eb,1E-5>R?R=1E-5:0.1<R&&(R=0.1)),K=ba,V*=Cb,0>V?V=0:0.1<V&&(V=0.1),Db?(ca+=(s-ba)*V,ca*=ma):(ba=s,ca=0),ba+=ca,wa+=ba-K,s=wa*=1-R),Ab&&(N+=la,0>N&&(N=-N,la=-la),1023<N&&(N=1023,la=0),Ka[va]=s,s+=Ka[va-(N|0)+1024&1023],va=va+1&1023),n>ia&&(ra+=1,K=ra<u?r[ra]:{c:0,f:0,e:q},qa=K.c,Xa=(K.f-K.c)/(K.e+1),ia+=K.e),s*=qa,qa+=Xa,s*=Fb,1<g?(Y+=s,0===(n+1)%g&&(Ga[La]=Y/g,La+=1,Y=0)):Ga[n]=s;a=f/100|0;padding=Array(a);for(n=0;n<a;n++)padding[n]=0;return padding.concat(Ga).concat(padding)};
this.i=this.I()}).apply(da);var ea={};(function(){this.o=function(a){a=da.p(this.F(a));return h.J(a)};this.F=function(a){for(var d={},c=da.i.length,b=0;b<c;b++)d[da.i[b].id]=a[b];return d}}).apply(ea);var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame;var k=document.getElementById("c"),m=k.getContext("2d"),t=640,v=400,w=16,x="2",fa=1,ga=6,ha=3,ja=1,na=1,oa=12,pa=[1,-6],ya=12,za=10,Aa=[75,370],Ba=[t-24,24],Ca=[95,78];INTRO_THEME="023123467".split("");
var y=null,Da=4,Ea=0,Fa=0,Ma=0,Na=!1,Oa=!1,Pa=!1,Qa=!1,z=0,Ra=null,A=void 0,Sa=3,Ta,B=null,Ua=null,C=3,Va=!1,D=0,Wa=za,E=[],ab=null,bb=null,cb=null,db=null,eb=null,fb={a:null,size:1,position:null,t:null},F=[],gb={a:null,position:null},hb=[],ib={a:null,position:null,speed:6},H=[],I=!1,jb=k.getBoundingClientRect(),kb=0,lb=0,mb=0,nb=document.createElement("canvas"),J=null,ob=[80,53],pb=null,L={};window.addEventListener("keyup",function(a){L[a.keyCode]=void 0},!1);
window.addEventListener("keydown",function(a){L[a.keyCode]=Date.now()},!1);for(var qb=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],rb={},sb=0;sb<qb.length;sb++)rb[sb]=ea.o(["synth",0,0.4,0,0.208,0,0.12,20,qb[sb],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);var tb=INTRO_THEME.slice();function ub(){rb[tb.shift()].play();0<tb.length&&setTimeout(ub,200)}var vb={};function M(a,d){vb[a]=ea.o(d)}
M(0,["square",0,0.4,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,0,0,0,0.783,0,0,0,0]);M(fa,["noise",0,0.4,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);M(5,["square",0,0.4,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);M(8,["saw",0,0.4,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);
M(2,["saw",0,0.4,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,0,0.5,-0.592,0,0.094,0.066,1,0,0,0.28,0]);M(7,["synth",0,0.4,0,0.32,0.348,0.44,20,372,417,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);M(ga,["square",0,0.4,0,0.32,0.348,0.44,20,1521,2400,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);M(4,["noise",0,0.4,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);
M(3,["noise",0,0.4,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);M(9,["square",0,0.4,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);M(10,["square",0,0.4,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);M(11,["noise",0,0.4,0,0.108,0.336,0.124,20,462,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);function O(a){vb[a]&&(vb[a].pause(),vb[a].currentTime=0,vb[a].play())}
var P=0,S=0,T=t/w,wb=v/w;function W(a,d,c){var b=new Image;b.width=d||16;b.height=c||16;b.src=a;return b}Ra=W("img/man.png",16,32);Ua=W("img/crow.png");ab=W("img/ladder.png");bb=W("img/nest.png");cb=W("img/dispenser.png");db=W("img/roof.png");eb=W("img/wall.png");gb.a=W("img/crumbs.png");ib.a=W("img/shot.png");pb=W("img/granny.png");function xb(a,d,c,b){for(d=d.slice();0<d.length;)a.fillText(d.shift(),c,b),b+=13}
function yb(){I=!1;y=Aa.slice();B=Ba.slice();J=Ca.slice();Wa=za;D=0;for(var a=ja,d,c,b,p=F.length=0;p<ha;p++)d=Object.create(fb),d.size=a,c=document.createElement("canvas"),c.width=oa+a,c.height=oa+a,b=c.getContext("2d"),b.setFillColor("yellow"),b.fillRect(0,0,oa+a,oa+a),b.setFillColor("black"),b.fillText(a,5,10),d.a=c,c=85+15*a,b=365-a,d.position=[c,b],d.t=[c,b],F.push(d),a+=na;nb.width=t;nb.height=v;a=nb.getContext("2d");a.clearRect(0,0,t,v);a.font="12px sans-serif";a.setFillColor("rgba(0,0,0,0.7)");
a.fillRect(0,0,t,v);a.setFillColor("fff");a.fillText("Click the crow to start!",t-170,25);xb(a,["Delivery Boy must deliver all the boxes to the green goal.","If you fall from too high, the box will break, and it is returned to start position.","Use arrows to move and jump, SPACEBAR to take/leave boxes, E to eat speed candies.","Speed candies leave crumbs on the ground."],140,330);a.textAlign="right";xb(a,["Crow must hinder Delivery Boy from delivering all the boxes.","Move with mouse, left click to shoot and right click to collect food.",
"Food recharges shots and is found in the nest and crumbs left by Delivery Boy.","Don't touch roofs and don't get too close to Delivery Boy or you'll get stunned.","Oh, and don't get shot!"],440,30);a.font="20px sans-serif";a.textAlign="center";a.fillText("Delivery Boy "+lb+" - "+mb+" Crow",t/2,v/2);a.beginPath();a.arc(t-25,25,16,0,360);a.lineWidth=1;a.strokeStyle="fff";a.stroke();tb=INTRO_THEME.slice()}yb();function Gb(){lb+=1;k.style.cursor="auto";O(ga);yb()}
function Hb(a){return[a.clientX-jb.left,a.clientY-jb.top]}function Ib(){return Math.max(1,Da+Fa-(void 0!==A?F[A].size:0))}k.addEventListener("click",function(a){a=Hb(a);I?0<C&&D<Date.now()&&(C--,O(2),a=Object.create(ib),a.position=B.slice(),H.push(a)):a[0]>t-36&&36>a[1]&&(I=!0,kb=Date.now()+3E5,ub(),k.style.cursor="none")});k.addEventListener("mousemove",function(a){I&&(B=Hb(a).slice())});
k.addEventListener("contextmenu",function(a){a.preventDefault();if(I&&D<Date.now())if(a=Hb(a),"6"===E[T*Math.round(B[1]/w-0.5)+Math.round(B[0]/w-0.5)]&&3>C)O(9),C++;else{var d;for(d=0;d<hb.length;d++)if(Jb(a,hb[d].position)){C=Math.max(C,5);O(9);hb.splice(d,1);break}}});E="4444444444444444444444444444444444444444333333000000000000000000000000000000006055555300000000000000000000000000000000115555500000000000000000000033330000000000555550000000000000020000000000000000000011111100100110011112011100111100000000000000000000000000000200000000001000000000000000000000000007020000000000010000000000011100000000001111110000000000100200000020000000000000333333300003333301021000002000333333000000000000000000000002000000200000000000000000000000000000000200000020000000000000100100100110000202020000002011111111111110000000333110011112111000200333333333300000000000033000000333330020000000000000000000000000000000000000002000000000000000002000000000000200000000201111001111100111201110011111120111110020000000000000000020000000000002000000002000000000000000002070000000000200000000003333300000000000111100002000020000000000000000000000000000000000211112000000000000000000000000000000000020000000000011111111111111111111111111111111111111114444444444444444444444444444444444444444";
function Jb(a,d){return Math.round(a[0]/w)===Math.round(d[0]/w)&&Math.round(a[1]/w)===Math.round(d[1]/w)}function Kb(){var a=Ea,d=Ib();Pa||(a=0);Ea=a=Math.min(d,a+d/5);return X(y,x)?d/3:a}function Lb(a){return Jb(y,[y[0],y[1]+w/2])||E[T*Math.round(y[1]/w)+Math.round(y[0]/w-1)]!==a&&E[T*Math.round(y[1]/w)+Math.round(y[0]/w)]!==a?!1:!0}function X(a,d){return E[T*Math.round(a[1]/w-1)+Math.round(a[0]/w-0.5)]===d?!0:!1}function Mb(a,d){return Math.pow(a[0]-d[0],2)+Math.pow(a[1]-d[1],2)}
function Nb(){var a=void 0!==A?F[A]:void 0;a&&(O(fa),A=void 0,a.position=a.t.slice())}function Ob(){var a=void 0!==A?F[A]:void 0;a&&z>ya-a.size&&Nb()}
(function Pb(d){if(I){var c=Ib(),b=y[0],p=y[1];if(!L[32]||Na||Oa||Qa)if(L[69]&&!Qa){if(Qa=!0,0<Sa){Sa--;Fa=3;Ma=Date.now()+5E3;var f=Object.create(gb);f.position=[y[0]+4,y[1]-7];hb.push(f);O(8)}}else L[32]||(L[69]||!Qa)||(Qa=!1);else{Qa=!0;a:{var f=A,g=void 0!==f?F[f]:void 0;if(void 0===g){for(f=0;f<F.length;f++)if(Jb(y,F[f].position)){A=f;O(4);break a}X(y,"7")&&(Sa=3,O(10))}else A=void 0,O(4),X(y,"5")&&void 0!==g&&(O(5),F.splice(f,1),0>=F.length&&Gb())}}L[38]?X(y,x)?(y[1]=Math.min(v-w,p-2),Pa=!0):
Na||Oa||(z=-7,Ea=c,Oa=Na=!0,O(0)):!L[38]&&Na&&(Na=!1);L[37]&&(y[0]=Math.max(w,b-Kb()),Pa=!0);L[39]&&(y[0]=Math.min(t-2*w,b+Kb()),Pa=!0);L[40]&&((X(y,x)||Lb(x))&&!Lb("1"))&&(y[1]=Math.min(v,p+2),Pa=!0);L[37]||(L[38]||L[39]||L[40])||(Pa=!1)}if(I){jb=k.getBoundingClientRect();z>w/2&&(z+y[1]>Ta&&z)&&(z=w/2,Ob());if(X(y,x)||Lb(x)||Lb("1")||y[1]>v-w){if(Lb(x)||0<z)Ob(),Ea=z=0,Oa=!1;X(y,x)||Lb(x)||0!==z||(y[1]=y[1]-y[1]%w+1)}else Ob(),z+=1,Oa=!0;y[1]+=z;c=y[0];for(b=y[1];b<v-w&&!X([c,b],"1");)b+=w;Ta=b-=
b%w;void 0!==A&&(F[A].position[0]=y[0]+pa[0],F[A].position[1]=y[1]+pa[1]);Ma<d&&0<Fa&&(Fa=0);for(c=0;c<H.length;c++)if(b=H[c],b.position[1]+=b.speed,Jb(y,b.position))Nb(),H.splice(c,1),c--;else if(b.position[1]>v||X(b.position,"3"))H.splice(c,1),c--;kb<d&&(mb+=1,k.style.cursor="auto",O(7),yb());Va=Math.pow(7*Ib()+75,2)>=Mb(B,y);c=X(B,"6")?Ca:B;b=J;b=Math.atan((c[1]-b[1])/(c[0]-b[0]));p=J[0]>c[0]?-1:1;if(3<Math.abs(c[0]-J[0])||3<Math.abs(c[1]-J[1]))J[0]+=1*Math.cos(b)*p,J[1]+=1*Math.sin(b)*p;(Math.pow(7*
Ib()+25,2)>=Mb(B,y)||X(B,"3")||3>Math.sqrt(Mb(J,B)))&&D<d&&(D=d+5E3,O(11),C=0,Wa--,0>=Wa&&Gb())}m.setFillColor("black");m.fillRect(0,0,t,v);for(P=0;P<T;P++)for(S=0;S<wb;S++)b=null,c="00deff","0"!==E[T*S+P]&&("1"===E[T*S+P]?b=eb:"3"===E[T*S+P]?b=db:"4"===E[T*S+P]?c="000":"5"===E[T*S+P]?c="0f0":"6"===E[T*S+P]?b=bb:E[T*S+P]===x?b=ab:"7"===E[T*S+P]?b=cb:c="fff"),m.setFillColor(c),m.fillRect(P*w,S*w,w,w),null!==b&&m.drawImage(b,P*w,S*w,w,w);m.drawImage(Ra,y[0]-8,y[1]-24);Va&&(m.beginPath(),m.arc(y[0],
y[1],7*Ib()+25,0,360),m.lineWidth=2,m.strokeStyle="f09",m.stroke());for(b=0;b<F.length;b++)c=F[b],m.drawImage(c.a,c.position[0]-8,c.position[1]-8);for(b=0;b<hb.length;b++)c=hb[b],m.drawImage(c.a,c.position[0]-8,c.position[1]-8);for(b=0;b<H.length;b++)c=H[b],m.drawImage(c.a,c.position[0]-8,c.position[1]-8);m.drawImage(pb,ob[0],ob[1]);D>d&&0===Math.floor(d/100)%2||m.drawImage(Ua,B[0]-8,B[1]-8);m.setFillColor("red");m.setFillColor("red");m.fillRect(J[0]-1,J[1]-1,2,2);m.beginPath();m.arc(J[0],J[1],5,
0,360);m.lineWidth=2;m.strokeStyle="red";m.stroke();m.setFillColor("00deff");m.fillText("BOY",10,396);m.setFillColor("red");m.fillText("CROW",600,12);m.setFillColor("white");m.fillText("SPEED: "+Ib(),40,396);m.fillText("BOOST TIMEOUT: "+Math.max(0,Math.ceil((Ma-d)/1E3)),100,396);m.fillText("TIME LEFT: "+Math.max(0,Math.ceil((kb-d)/1E3)),210,396);m.fillText("CANDIES: "+Sa,300,396);m.fillText("SHOTS: "+C,540,12);m.fillText("STUN TIMEOUT: "+Math.max(0,Math.ceil((D-d)/1E3)),430,12);m.fillText("HEALTH: "+
Wa,340,12);I||m.drawImage(nb,0,0);window.requestAnimationFrame(Pb)})();

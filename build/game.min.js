var ha={};
(function(a){function c(a,l){return l?J(a&255)+c(a>>8,l-1):""}var B=this.Aa=a||44100,n=2*B,J=String.fromCharCode,e;this.Na=function(a){var k=Audio,D=btoa,x="",y=a.length;for(l=0;l<y;l++)var M=32767*a[l]|0,M=-32768>M?-32768:32767<M?32767:M,M=M+(0>M?65536:0),x=x+String.fromCharCode(M&255,M>>8);a=x;a=["RIFF",36+(e=a.length),"WAVEfmt ",16,1,1,B,n,2,16,"data",e,a];x="";for(l=0;l<a.length;l++)x+="s"=="s4s4224422s4s"[l]?a[l]:c(a[l],"s4s4224422s4s".charCodeAt(l)-48);return new k("data:audio/wav;base64,"+D(x))};
var D,l,z=Math.sin,k=2*Math.PI;this.filter=function(a,c,k,e,y,n,q,J,B,z){k=k?k:1;e=e?e:a.length;D=a.slice(0);for(l=k;l<e;l++)D[l]=c(a,D,k,e,l,y,n,q,J,B,z);return D};this.filters={Ua:function(a,c,l,k,e,n){return c[e-1]+n*(a[e]-c[e-1])},Va:function(a,c,l,k,e,n){return c[e-1]+n*(k-e)/(k-l)*(a[e]-c[e-1])},Ta:function(a,c,k,l,e,n){return n*(c[e-1]+a[e]-a[e-1])}};this.Da=function(a,c,e,n,y,D,q,J,z){c=c*k/B;var F=Array(a|0);for(l=0;l<a;l++)F[l]=e(l*c,n,y,D,q,J,z);return F};var F=0;this.N={Oa:function(a){4>
a%k&&(F=2*Math.random()-1);return F},Wa:Math.random,Qa:Math.sin,Ra:function(a){return z(a)+0.5*z(a/2)+0.3*z(a/4)},Pa:function(a){return 2*(a/k-(a/k+0.5|0))},Ea:function(a,c){return z(a)>c?1:z(a)<c?-1:c}}}).apply(ha);var za={};
(function(){this.ga=[];this.fa={square:ha.N.Ea,saw:ha.N.Pa,sine:ha.N.Qa,noise:ha.N.Oa,synth:ha.N.Ra};this.Ja=function(){var a=[],c;for(c in this.fa)a.push(c);return a};this.Ka=function(){function a(a,e,n,l,z){void 0===z&&(z=(n-e)/1E3);a={name:a,id:a.replace(/ /g,""),min:e,max:n,step:z,Ia:l,type:"range",group:B};c.push(a)}var c=[],B=0,n=this.Ja();(function(a,e,n){a={name:a,id:a.replace(/ /g,""),options:e,Ia:n,type:"option",group:B};c.push(a)})("Generator",n,n[0]);a("SuperSamplingQuality",0,16,0,1);
a("MasterVolume",0,1,0.4);B++;a("AttackTime",0,1,0.1);a("SustainTime",0,2,0.3);a("SustainPunch",0,3,2);a("DecayTime",0,2,1);B++;a("MinFrequency",20,2400,0,1);a("StartFrequency",20,2400,440,1);a("MaxFrequency",20,2400,2E3,1);a("Slide",-1,1,0);a("DeltaSlide",-1,1,0);B++;a("VibratoDepth",0,1,0);a("VibratoFrequency",0.01,48,8);a("VibratoDepth Slide",-0.3,1,0);a("VibratoFrequencySlide",-1,1,0);B++;a("ChangeAmount",-1,1,0);a("ChangeSpeed",0,1,0.1);B++;a("SquareDuty",0,0.5,0);a("SquareDutySweep",-1,1,0);
B++;a("RepeatSpeed",0,0.8,0);B++;a("PhaserOffset",-1,1,0);a("PhaserSweep",-1,1,0);B++;a("LPFilterCutoff",0,1,1);a("LPFilterCutoffSweep",-1,1,0);a("LPFilterResonance",0,1,0);a("HPFilterCutoff",0,1,0);a("HPFilterCutoffSweep",-1,1,0);return c};this.Da=function(a){var c=2*Math.PI,B=Math.sin,n=Math.pow,J=Math.abs,e=ha.Aa,D=a.SuperSamplingQuality|0;1>D&&(D=1);for(var e=e*D,l=[{M:0,aa:1,time:a.AttackTime},{M:1+a.SustainPunch,aa:1,time:a.SustainTime},{M:1,aa:0,time:a.DecayTime}],z=l.length,k=0;k<z;k++)l[k].Y=
1+(l[k].time*e|0);for(var F=void 0,R=0,ua=-1,ya=0,x=-1,y=0,k=0;k<z;k++)y+=l[k].Y;y<e/2&&(y=e/2);var M=Array(y/D|0),q=0,oa=0,va=za.fa[a.Generator];void 0===va&&(va=this.fa.Ea);var V=0,V=a.SquareDuty,ia=a.SquareDutySweep/e,E=0,L=a.StartFrequency*c/e,Q=1+64*n(a.Slide,3)/e,aa=n(a.DeltaSlide,3)/(1E3*e);void 0!==D&&(aa/=D);a.MinFrequency>a.StartFrequency&&(a.MinFrequency=a.StartFrequency);a.MaxFrequency<a.StartFrequency&&(a.MaxFrequency=a.StartFrequency);for(var Aa=a.MinFrequency*c/e,pa=a.MaxFrequency*
c/e,qa=0,Ba=a.VibratoFrequency*c/e,ba=a.VibratoDepth,Ia=1+3*n(a.VibratoFrequencySlide,3)/e,wa=a.VibratoDepthSlide/e,ea=0,fa=a.ChangeSpeed*e,Y=n(a.ChangeAmount,2),Y=0<a.ChangeAmount?1+10*Y:1-0.9*Y,ja=Array(1024),k=0;1024>k;k++)ja[k]=0;var ra=0,S=1020*n(a.PhaserOffset,2),ka=4E3*n(a.PhaserSweep,3)/e,Ja=1E-5<J(ka)||1E-5<J(S),ca=0.0010<a.HPFilterCutoff||0.999>a.LPFilterCutoff,da=0,Z=0,G=n(a.LPFilterCutoff,3)/10,r=1+a.HPFilterCutoffSweep/1E4,$=5/(1+20*n(a.LPFilterResonance,2))*(0.01+a.LPFilterCutoff);0.8<
$&&($=0.8);var $=1-$,t=0.999>a.LPFilterCutoff,s=0,T=n(a.HPFilterCutoff,2)/10,Ca=1+a.HPFilterCutoffSweep/1E4,xa=0,H=y;0<a.RepeatSpeed&&(H=n(1-a.RepeatSpeed,2)*e+32);for(var N=a.MasterVolume,K=0,k=0;k<y;k++)q=va(E,V,0),V+=ia,0>V?V=0:0.5<V&&(V=0.5),xa>H&&(E=0,L=a.StartFrequency*c/e,Q=1+3*n(a.Slide,3)/e,aa=n(a.DeltaSlide,3)/(1E3*e),void 0!==D&&(aa/=D),ea=0,fa=a.ChangeSpeed*e,Y=1+(a.ChangeAmount|0)/12,xa=0),xa+=1,E+=L,Q+=aa,L*=Q,ea>fa&&(L*=Y,fa=y),ea+=1,L>pa?L=pa:L<Aa&&(L=Aa),qa+=Ba,F=L*B(qa)*ba,E+=F,
Ba*=Ia,wa&&(ba+=wa,0>ba?wa=ba=0:1<ba&&(ba=1,wa=0)),ca&&(0.0010<J(T)&&(T*=Ca,1E-5>T?T=1E-5:0.1<T&&(T=0.1)),F=da,G*=r,0>G?G=0:0.1<G&&(G=0.1),t?(Z+=(q-da)*G,Z*=$):(da=q,Z=0),da+=Z,s+=da-F,q=s*=1-T),Ja&&(S+=ka,0>S&&(S=-S,ka=-ka),1023<S&&(S=1023,ka=0),ja[ra]=q,q+=ja[ra-(S|0)+1024&1023],ra=ra+1&1023),k>x&&(ua+=1,F=ua<z?l[ua]:{M:0,aa:0,Y:y},R=F.M,ya=(F.aa-F.M)/(F.Y+1),x+=F.Y),q*=R,R+=ya,q*=N,1<D?(oa+=q,0===(k+1)%D&&(M[K]=oa/D,K+=1,oa=0)):M[k]=q;a=e/100|0;c=Array(a);for(k=0;k<a;k++)c[k]=0;return c.concat(M).concat(c)};
this.ga=this.Ka()}).apply(za);var Oa={};(function(){this.Ca=function(a){a=za.Da(this.Ha(a));return ha.Na(a)};this.Ha=function(a){for(var c={},B=za.ga.length,n=0;n<B;n++)c[za.ga[n].id]=a[n];return c}}).apply(Oa);(function(){function a(m){m.preventDefault();Da=m.changedTouches;ga=Ea.getBoundingClientRect();Pa=!0}var c,B,n,J,e,D,l,z,k;function F(m,b,a,c,d){var f=P[m].frame;m=P[m].i;r.drawImage(la,f.x,f.y,c||f.b,d||f.c,b+m.x,a+m.y,m.b,m.c)}function R(m,b,a,c,d,f){var g=P[m].frame,h=P[m].i;m=P[m].frames;c=f?m[Math.floor(f*c/1E3)%m.length]:m[c];d?r.drawImage(Ka,Ua-(g.x+c.x)-c.b,g.y+c.y,c.b,c.c,b+h.x,a+h.y,c.b,c.c):r.drawImage(la,g.x+c.x,g.y+c.y,c.b,c.c,b+h.x,a+h.y,c.b,c.c)}function ua(){var m=w[t],m={name:"CustomLevel"+
xa++,D:m.D.slice(),C:m.C.slice(),A:m.A.slice(),h:m.h&&m.h.slice(),map:m.map,e:m.e.slice(),m:m.m,X:!0};w.push(m);t=w.length-1}function ya(){if(Qa)try{p.state===v.k&&0<Ra.length&&(Va[Ra.shift()].play(),setTimeout(ya,200))}catch(m){}}function x(m,b){if(Qa)try{Ga[m]=Oa.Ca(b)}catch(a){}}function y(m){if(Qa)try{Ga[m]&&(Ga[m].pause(),Ga[m].currentTime=0,Ga[m].play())}catch(b){}}function M(m){var b=m.A,a,c,d,f;Ha.K=b;for(var g=O.length=0;g<m.e.length;g++)a=m.e[g],c=Object.create(Ha),c.size=a,d=document.createElement("canvas"),
d.width=La+a,d.height=La+a,f=d.getContext("2d"),f.fillStyle="yellow",f.fillRect(0,0,La+a,La+a),f.fillStyle="black",f.fillText(a,5,10),c.ka=d,d=b[0]+16*g,a=b[1]-a,c.position=[d,a],c.K=[d,a],O.push(c)}function q(m){m=p.q=w[m]||w[t];pa(v.g);b.position=m.D.slice();c=m.C.slice();b.L=0;b.$=0;b.d=void 0;b.e=Wa;b.B=!1;b.J=!1;b.a=!1;b.n=!1;b.I=!1;B=Xa;J=n=0;p.time=0;pa(v.g);H=0;m.h?(l=m.h.slice(),z=[m.h[0]+15,m.h[1]+23],k=z.slice()):z=l=null;W="4444444444444444444444444444444444444444"+m.map+"4444444444444444444444444444444444444444";
W=W.split("");M(m);sa.length=0;ma.length=0;Ma.width=N;Ma.height=K;var a=Ma.getContext("2d");a.fillStyle="rgba(0,0,0,0.7)";a.fillRect(0,0,N,K);a.fillStyle="#fff";a.font="20px courier";a.textAlign="center";a.fillText(p.q.name,N/2,K/2-50);a.fillText("Delivery Boy "+p.ia+" - "+p.ja+" Crow",N/2,K/2);a.font="15px courier";a.fillText("Click the crow to start!",N/2,K/2+60);a.fillText("< >: Select level",N/2,K/2+100);a.fillText(m.X?"E: edit   "+(ca?"1":"D")+": delete   "+(ca?"2":"J")+": insert/copy JSON   S: share":
"E: edit",N/2,K/2+120);a.beginPath();a.arc(c[0],c[1],16,0,360);a.lineWidth=1;a.strokeStyle="#fff";a.stroke();Ra=Ya.slice();window.localStorage&&(window.localStorage.ta=JSON.stringify(w))}function oa(){p.ia+=1;G.style.cursor="auto";y(C.za);q(t)}function va(){p.ja+=1;G.style.cursor="auto";y(C.pa);q(t)}function V(a){var b=a.clientX-p.V.left;a=a.clientY-p.V.top;b=Math.max(0,Math.min(b,N-1));a=Math.max(0,Math.min(a,K-1));return[b,a]}function ia(){return Math.max(1,b.speed+b.Z-(void 0!==b.d?O[b.d].size:
0))}function E(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c}function L(){if(p.state===v.f)if(H<ta){var a=Math.floor(s[1]/u);0<a&&a<Sa-1&&(W[X*a+Math.floor(s[0]/u)]=""+H)}else if(H===na.ua)b.position[0]=s[0],b.position[1]=s[1];else if(H===na.s)c[0]=s[0],c[1]=s[1];else if(H===na.j&&l)l[0]=s[0],l[1]=s[1],z=[l[0]+15,l[1]+23],k=z.slice();else{if(H===na.r)for(Ha.K[0]=s[0],Ha.K[1]=s[1],a=0;a<O.length;a++){var Fa=O[a];Fa.position[0]=s[0]+16*a;Fa.position[1]=
s[1]-Fa.size}}else p.state===v.g?s[0]>c[0]-16&&(s[0]<c[0]+16&&s[1]>c[1]-16&&s[1]<c[1]+16)&&(pa(v.k),p.time=$+p.q.m,ya(),G.style.cursor="none"):0<n&&J<$&&(n--,y(C.na),a=Object.create(bb),a.position=c.slice(),ma.push(a))}function Q(a,b){var c=document.getElementById(a);E(c,"touchstart",function(){U.P({keyCode:b})});E(c,"touchend",function(){U.Q({keyCode:b})})}function aa(a,b,c){a=document.getElementById(a);E(a,"touchstart",b);E(a,"touchend",c)}function Aa(a){a.preventDefault();if(p.state===v.f)Ca=!Ca;
else if(p.state===v.k&&J<$)if(a=V(a),(fa(c[0]-8,c[1]-8,16,16,I.v)||ea(c[0],c[1],0,0,I.v))&&n<cb)y(C.ca),n++;else{var b;for(b=0;b<sa.length;b++)if(qa(a,sa[b].position)){n=Math.max(n,db);y(C.ca);sa.splice(b,1);break}}}function pa(a){p.state=a;if(a===v.f){a=document.getElementsByClassName("edit");for(var b=0;b<a.length;b++)a[b].setAttribute("class","btn edit")}else for(a=document.getElementsByClassName("edit"),b=0;b<a.length;b++)a[b].setAttribute("class","btn h edit")}function qa(a,b){return Math.round(a[0]/
u)===Math.round(b[0]/u)&&Math.round(a[1]/u)===Math.round(b[1]/u)}function Ba(){var a=b.d,c=void 0!==a?O[a]:void 0;if(void 0===c){for(a=0;a<O.length;a++)if(qa(b.position,O[a].position)){b.d=a;y(C.ba);return}Y(I.o)&&(b.L=eb,y(C.o))}else b.d=void 0,y(C.ba),Y(I.qa)&&void 0!==c&&(O.splice(a,1),0>=O.length?oa():y(C.ma))}function ba(){var a=b.W,c=ia();b.a||(a=0);a=Math.min(c,a+c/5);b.W=a;return Y(I.p)?c/3:a}function Ia(){G.style.cursor="auto";p.state===v.f&&(w[t].map=W.join("").substring(X,X*Sa-X),w[t].D=
b.position.slice(),w[t].C=c.slice(),l instanceof Array&&(w[t].h=l.slice()),w[t].A=Ha.K.slice());q(t)}function wa(a){var c=ia(),e=b.Ma,n=b.position[0],r=b.position[1],f=U.la;if(p.state===v.g)if(f[d.u]&&!b.a)t=(t+w.length-1)%w.length,q(t),b.a=!0;else if(f[d.w]&&!b.a)t=(t+1)%w.length,q(t),b.a=!0;else if(f[d.l]&&!b.a)b.a=!0,w[t].X||(ua(),q(t)),pa(v.f),f[d.l]=void 0;else if(f[d.da]&&!b.a)b.a=!0,w[t].X&&(w.splice(t,1),t--,q(t));else if(f[d.t]&&w[t].X&&!b.a){if(e=c=prompt("LEVEL JSON",JSON.stringify(w[t])))a:{try{JSON.parse(c);
e=!0;break a}catch(g){alert("Level not valid: "+g.message)}e=!1}e&&(w[t]=JSON.parse(c),q(t));f[d.t]=void 0}else f[d.ha]&&!b.a?(b.a=!0,c=new XMLHttpRequest,c.onload=function(){prompt("Your level share url",this.responseText);f[d.ha]=void 0},c.open("post","http://127.0.0.1:3000/addLevel",!0),c.send(JSON.stringify(w[t]))):f[d.u]||(f[d.w]||f[d.l]||f[d.t]||f[d.ha])||(b.a=!1);else{if(p.state===v.f)if(f[d.u]&&!b.a)H=(H+Ta-1)%Ta,b.a=!0;else if(f[d.w]&&!b.a)H=(H+1)%Ta,b.a=!0;else if(f[d.j]&&!b.a)l instanceof
Array?k=z=l=null:(l=[32,32],z=[l[0]+15,l[1]+23],k=z.slice()),b.a=!0;else if(f[d.r]&&!b.a){b.a=!0;try{var h=JSON.parse(prompt("Set crates",JSON.stringify(w[t].e)));if(h instanceof Array){for(c=0;c<h.length;c++)"number"===!typeof c&&alert("Crates not valid"),h[c]=Math.max(1,Math.min(5,h[c]));w[t].e=h;M(w[t])}}catch(s){alert("Crates not valid: "+s.message)}f[d.r]=void 0}else if(f[d.S]&&!b.a){b.a=!0;if(c=prompt("Set name",w[t].name))w[t].name=c;f[d.S]=!1}else f[d.T]&&!b.a?(b.a=!0,a=+prompt("Set time",
w[t].m),!isNaN(a)&&0<a&&(w[t].m=a),f[d.T]=!1):f[d.l]&&!b.a?(b.a=!0,Ia(),f[d.l]=void 0):f[d.u]||(f[d.w]||f[d.j]||f[d.r]||f[d.S]||f[d.T]||f[d.l])||(b.a=!1);else p.state===v.k&&(!f[d.R]||b.J||b.n||b.B?f[d.l]&&!b.B?(b.B=!0,0<b.L&&(b.L--,b.Z=fb,b.$=a+gb,h=Object.create(hb),h.position=[b.position[0]+4,b.position[1]-7],sa.push(h),y(C.ya))):f[d.R]||(f[d.l]||!b.B)||(b.B=!1):(b.B=!0,Ba()),f[d.U]?Y(I.p)?(b.position[1]=Math.min(K-u,r-e),b.a=!0):b.J||b.n||(b.F=b.La,b.W=c,b.J=!0,b.n=!0,y(C.sa)):!f[d.U]&&b.J&&(b.J=
!1),f[d.u]&&(b.position[0]=Math.max(u,n-ba()),b.a=!0,b.I=!0),f[d.w]&&(b.position[0]=Math.min(N-2*u,n+ba()),b.a=!0,b.I=!1),f[d.ea]&&Y(I.p)&&(b.position[1]=Math.min(K,r+e),b.a=!0),f[d.u]||(f[d.U]||f[d.w]||f[d.ea])||(b.a=!1));f[d.g]&&Ia()}}function ea(a,b,c,d,e){var f=b,g=W[X*Math.floor(f/u)+Math.floor(a/u)];c=a+c;topRight=W[X*Math.floor(f/u)+Math.floor(c/u)];bottomRight=W[X*Math.floor((b+d)/u)+Math.floor(c/u)];bottomLeft=W[X*Math.floor(b/u)+Math.floor(a/u)];return g===e||topRight===e||bottomRight===
e||bottomLeft===e}function fa(a,b,c,d,e){b+=d;d=W[X*Math.floor(b/u)+Math.floor(a/u)];bottomLeft=W[X*Math.floor(b/u)+Math.floor((a+c)/u)];return d===e||bottomLeft===e}function Y(a){return ea(b.position[0]-16,b.position[1]-32,16,32,a)||ea(b.position[0]-8,b.position[1]-8,0,0,a)}function ja(a,b){return Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)}function ra(){return void 0!==b.d?O[b.d]:void 0}function S(a,b){return Math.atan((b[1]-a[1])/(b[0]-a[0]))}function ka(){var a=ra();a&&(y(C.va),b.d=void 0,a.position=
a.K.slice(),b.e--,0>=b.e&&va())}function Ja(a,b,c){var d=null,e="#00deff";a===I.xa?d=A.Ba:a===I.H?d=A.H:a===I.Ga?e="#000":a===I.qa?e="#0f0":a===I.v?d=A.v:a===I.p?d=A.p:a===I.o&&(d=A.o);r.fillStyle=e;r.fillRect(b,c,u,u);null!==d&&F(d,b,c,u,u)}(function(){for(var a=0,b=["webkit","moz"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];
window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);a=c+d;return e});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();for(var ca=!1,ca=!0,da=document.getElementsByClassName("btn"),Z=0;Z<da.length;Z++)-1===da[Z].getAttribute("class").indexOf("edit")&&da[Z].setAttribute("class","btn");var G=document.getElementById("C"),r=G.getContext("2d"),$=0,t=
0,s=[0,0],T=!1,Ca=!1,xa=1,H=0,N=640,K=400,u=16,X=N/u,Sa=K/u,Qa=window.btoa&&window.atob,I={EMPTY:"0",xa:"1",p:"2",H:"3",Ga:"4",qa:"5",v:"6",o:"7"},ta=8,na={ua:ta+0,s:ta+1,j:ta+2,r:ta+3},Ta=ta+4,v={g:0,k:1,f:2},C={sa:0,va:1,na:2,Fa:3,ba:4,ma:5,za:6,pa:7,ya:8,ca:9,o:10,ra:11},Wa=10,La=12,Za=[1,-6],fb=3,gb=5E3,eb=3,cb=3,db=5,Xa=10,Ya="023123467".split(""),d={u:37,U:38,w:39,ea:40,l:69,R:32,g:27,da:68,t:74,j:71,r:67,S:78,T:84,ha:83},A={s:0,oa:1,o:2,j:3,p:4,G:5,v:6,H:7,wa:8,Ba:9},P={};P[A.s]={frame:{x:30,
y:0,b:30,c:14},i:{x:1,y:1,b:30,c:14},frames:[{x:1,y:1,b:15,c:13},{x:17,y:1,b:15,c:13}]};P[A.oa]={frame:{x:14,y:40,b:14,c:8},i:{x:1,y:7,b:14,c:8}};P[A.o]={frame:{x:32,y:14,b:16,c:16},i:{x:0,y:0,b:16,c:16}};P[A.j]={frame:{x:0,y:24,b:14,c:24},i:{x:1,y:7,b:14,c:24}};P[A.p]={frame:{x:16,y:48,b:16,c:16},i:{x:0,y:0,b:16,c:16}};P[A.G]={frame:{x:0,y:0,b:30,c:24},i:{x:1,y:3,b:30,c:24},frames:[{x:0,y:0,b:15,c:24},{x:15,y:0,b:15,c:24}]};P[A.v]={frame:{x:48,y:14,b:16,c:10},i:{x:0,y:10,b:16,c:10}};P[A.H]={frame:{x:14,
y:24,b:16,c:16},i:{x:0,y:0,b:16,c:16}};P[A.wa]={frame:{x:30,y:30,b:6,c:14},i:{x:4,y:1,b:6,c:14}};P[A.Ba]={frame:{x:0,y:48,b:16,c:16},i:{x:0,y:0,b:16,c:16}};var la=new Image,Ka=document.createElement("canvas"),Ua=0;la.onload=function(){Ka.width=Ua=la.naturalWidth;Ka.height=la.naturalHeight;var a=Ka.getContext("2d");a.translate(la.naturalWidth,0);a.scale(-1,1);a.drawImage(la,0,0)};la.src="img/imgmap.png";var b={position:null,speed:4,W:0,Z:0,$:0,Ma:2,La:-7,J:!1,n:!1,a:!1,B:!1,F:0,Xa:!1,d:void 0,L:0,
e:Wa,Sa:!0};e=c=null;n=0;D=!1;J=0;B=Xa;var W=[],Ha={ka:null,size:1,position:null,K:[0,0]},O=[],hb={position:null},sa=[],bb={position:null,speed:6},ma=[],p={state:v.g,V:G.getBoundingClientRect(),time:0,ia:0,ja:0,q:null},Ma=document.createElement("canvas");k=null;l=[80,53];z=[95,78];var ib={name:"Tutorial",D:[33,370],C:[N-24,55],A:[300,365],h:[20,70],map:"00000000000000000000000000000000000000000000000000000000000000000000000000000000330000000000000000000000000000000000006000000000000000000000000000000000000000110000000000033300000000000006000000000000110000000003330000000000001110000000000000000000000333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000555500000000000000000000000000000000000055550000000000000000000000000000000000005555000000000007000000000000002000000000111111111111111111111111111111200000000000000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000000000000020000000001111111111111111111111111111111111111111",
e:[1],m:3E6,O:[[20,340,["PLAYER 1"]],[100,340,["ARROWS: move/jump"]],[250,340,["SPACEBAR: grab/release crate"]],[500,340,["UP/DOWN: Climb ladder"]],[450,250,["Crates break if you fall from too high"]],[160,250,[(ca?"S":"SPACEBAR")+": buy candies when not holding crate","E: Use candy to gain speed"]],[10,230,["Deliver crate to green area"]],[560,30,["PLAYER 2",(ca?"DPad":"Mouse")+": move"]],[410,70,["Don't get shot","Hide in the nest"]],[410,130,[(ca?"2":"RClick")+": eat from nest or candy crumbs",
(ca?"1":"LClick")+": shoot!"]],[140,60,["Don't touch roofs or the boy"]]]},jb={name:"Level 1",D:[25,366],C:[616,24],A:[41,364],h:[513,180],map:"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000003330000000000000000000000000000000000003333300000000000000000000000000000000000055500000000000000000000000000000000000005550000020000000000000200000000000000000555020002000111111111120000333000000000111112000200133333330002000000000000000000000200021130000000000200000000000000000000020002000000000000020000000000000000000002000200020000000002111111100111001101111100111112000000000200000000000000000000000033333200000000020000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000000001111111111111111111111111111111111111111",
e:[1,2],m:6E4},kb={name:"Level 2",D:[28,143],C:[600,296],A:[588,365],h:[51,50],map:"33330000000000000000000000000000000000005550000000000033000000000330000000000000555000000000000000000000000000000000000055500000000000000003030000000000000000001111111000000000000030000000000000110010000000010000000000000000000000000100301000000000000200000200000200000200000000100000000011120111102000201111021113002010111100000002000000020200000002000000211100000000000100000000200000000100000020000000000000000000000000000000000002002000000000000000000000000000000000030211100000001110000000000000000000000030020000000000000000000000003333300000000002000000000000000000000000000000000003020200000000000001100000000000000000000002110000000000000000000000000020700000020200000000000000000000000000112110000002020000060000000000010000000000200000000201000011100000000000000000000020000000020000000000000000000000000000002000000002000000000000000000000000000000200000000200000000001111111111111111111111111111111111111111",
e:[1,2],m:12E4},lb={name:"Level 5",D:[75,370],C:[N-24,24],A:[83,365],h:[80,53],map:"33333300000000000000000000000000000000605555530000000000000000000000000000000011555550000000000000000000003333000000000055555000000000000002000000000000000000001111110010011001111201110011110000000000000000000000000000020000000000100000000000000000000000000702000000000001000000000001110000000000111111000000000010020000002000000000000033333330000333330102100000200033333300000000000000000000000200000020000000000000000000000000000000020000002000000000000010010010011000020202000000201111111111111000000033311001111211100020033333333330000000000003300000033333002000000000000000000000000000000000000000200000000000000000200000000000020000000020111100111110011120111001111112011111002000000000000000002000000000000200000000200000000000000000207000000000020000000000333330000000000011110000200002000000000000000000000000000000000021111200000000000000000000000000000000002000000000001111111111111111111111111111111111111111",
e:[1,2,3],m:3E5},w=window.localStorage&&window.localStorage.ta&&JSON.parse(window.localStorage.ta)||[ib,jb,kb,lb],U={la:{},Q:function(a){U.la[a.keyCode]=void 0},P:function(a){U.la[a.keyCode]=$}};window.addEventListener("keyup",U.Q,!1);window.addEventListener("keydown",U.P,!1);for(var $a=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],Va={},Na=0;Na<$a.length;Na++)Va[Na]=Oa.Ca(["synth",0,0.4,0,0.208,0,0.12,20,$a[Na],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);var Ra=Ya.slice(),
Ga={};x(C.sa,["square",0,0.4,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,0,0,0,0.783,0,0,0,0]);x(C.va,["noise",0,0.4,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);x(C.ma,["square",0,0.4,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);x(C.ya,["saw",0,0.4,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);x(C.na,["saw",0,0.4,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,0,0.5,
-0.592,0,0.094,0.066,1,0,0,0.28,0]);x(C.pa,["synth",0,0.4,0,0.32,0.348,0.44,20,372,417,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);x(C.za,["synth",0,0.4,0,0.13,0.345,0.41,253,1168,1407,-0.0060,-0.082,0,0.01,3E-4,0,0.206,0.166,0,0,0,0,0,1,0,0,0,0]);x(C.ba,["noise",0,0.4,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);x(C.Fa,["noise",0,0.4,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);x(C.ca,["square",
0,0.4,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);x(C.o,["square",0,0.4,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);x(C.ra,["noise",0,0.4,0,0.108,0.336,0.124,20,462,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);q(t);E(G,"click",L);E(G,"mousedown",function(a){1===a.which&&(T=!0);p.state===v.f&&T&&L()});E(G,"mouseup",function(a){1===a.which&&(T=!1)});E(G,"mousemove",function(a){var b=V(a);s=[b[0],b[1]];p.state===v.k?
e=V(a).slice():p.state===v.f&&T&&L()});aa("s",function(){p.state===v.g?U.P({keyCode:d.da}):L()},function(){U.Q({keyCode:d.da})});E(G,"contextmenu",Aa);aa("e",function(a){p.state===v.g?U.P({keyCode:d.t}):Aa(a)},function(){U.Q({keyCode:d.t})});var Ea=document.getElementById("o"),ga=Ea.getBoundingClientRect(),ab=[100,100],Pa=!1,Da;E(Ea,"touchstart",a);E(Ea,"touchmove",a);E(Ea,"touchend",function(a){a.preventDefault();Pa=!1});aa("p",function(){U.P({keyCode:p.state!==v.g?d.R:d.t})},function(){U.Q({keyCode:p.state!==
v.g?d.R:d.t})});Q("a",d.l);Q("l",d.u);Q("u",d.U);Q("r",d.w);Q("d",d.ea);Q("g",d.j);Q("c",d.r);Q("t",d.T);Q("n",d.S);(function Fa(a){wa(a);$=a;if(Pa&&Da){for(var d,q,f=0;f<Da.length;f++)if(q=Da[f],q.clientX>=ga.left&&q.clientX<ga.left+ga.width&&q.clientY>=ga.top&&q.clientY<ga.top+ga.height){d=Da[f];break}if(d){d=[d.clientX-ga.left,d.clientY-ga.top];q=S(ab,d);var f=Math.sqrt(ja(ab,d))/12.5,g;p.state===v.k?g=c:p.state===v.f&&(g=s);g&&(g[0]+=(p.state===v.f?Math.round(Math.cos(q)):Math.cos(q))*(100>d[0]?
-f:f),g[1]+=(p.state===v.f?Math.round(Math.sin(q)):Math.sin(q))*(100>d[0]?-f:f),g[0]=Math.max(0,Math.min(g[0],N-1)),g[1]=Math.max(0,Math.min(g[1],K-1)));Ca&&L()}}if(p.state===v.k){p.V=G.getBoundingClientRect();g=0;for(var h;g<=b.F;){if(fa(b.position[0]-8,b.position[1]+g,16,0,I.xa)){h=b.position[1]+g-(b.position[1]+g)%u;break}g+=u}h?(b.position[1]=h,b.n&&(b.W=0,(h=ra())&&b.F>12-h.size&&ka()),b.n=!1,b.F=0):fa(b.position[0]-16,b.position[1]-32,16,32,I.p)?b.n=!1:(b.F+=1,b.n=!0,b.position[1]+=b.F);void 0!==
b.d&&(O[b.d].position[0]=b.position[0]+Za[0],O[b.d].position[1]=b.position[1]+Za[1]);b.$<a&&0<b.Z&&(b.Z=0);for(h=0;h<ma.length;h++)if(g=ma[h],g.position[1]+=g.speed,qa(b.position,g.position))ka(),ma.splice(h,1),h--;else if(g.position[1]>K||fa(g.position[0],g.position[1],0,0,I.H))ma.splice(h,1),h--;p.time<a&&va();c&&e&&(q=S(c,e),f=c[0]>e[0]?-1:1,h=Math.abs(c[0]-e[0]),g=Math.abs(c[1]-e[1]),3<h||3<g)&&(d=16*Math.cos(q)*f,q=16*Math.sin(q)*f,Math.abs(d)>h&&(d=h*d/Math.abs(d)),Math.abs(q)>g&&(q=g*q/Math.abs(q)),
c[0]+=d,c[1]+=q);D=Math.pow(7*ia()+75,2)>=ja(c,b.position);l&&(h=fa(c[0],c[1],0,0,I.v)?z:c,g=S(k,h),d=k[0]>h[0]?-1:1,3<Math.abs(h[0]-k[0])||3<Math.abs(h[1]-k[1]))&&(k[0]+=1*Math.cos(g)*d,k[1]+=1*Math.sin(g)*d);(Math.pow(7*ia()+25,2)>=ja(c,b.position)||ea(c[0],c[1],0,0,I.H)||l&&3>Math.sqrt(ja(k,c)))&&J<a&&(J=a+5E3,y(C.ra),n=0,B--,0>=B&&oa())}p.V=G.getBoundingClientRect();r.fillStyle="black";r.fillRect(0,0,N,K);for(h=0;h<X;h++)for(g=0;g<Sa;g++)Ja(W[X*g+h],h*u,g*u);for(g=0;g<O.length;g++)g!==b.d&&(h=
O[g],r.drawImage(h.ka,h.position[0]-8,h.position[1]-8));for(g=0;g<sa.length;g++)h=sa[g],F(A.oa,h.position[0]-8,h.position[1]-8);for(g=0;g<ma.length;g++)h=ma[g],F(A.wa,h.position[0]-8,h.position[1]-8);l&&F(A.j,l[0],l[1]);if(p.q.O)for(h=0;h<p.q.O.length;h++){g=r;var x=p.q.O[h][2];d=p.q.O[h][0];var E=p.q.O[h][1];q=g.fillColor;f=g.textAlign;g.fillStyle="black";for(x=x.slice();0<x.length;)g.fillText(x.shift(),d,E),E+=10;g.fillStyle=q;g.textAlign=f}p.state===v.k?b.n?R(A.G,b.position[0]-8,b.position[1]-
24,0,b.I):b.a?R(A.G,b.position[0]-8,b.position[1]-24,10,b.I,a):R(A.G,b.position[0]-8,b.position[1]-24,1,b.I):R(A.G,b.position[0]-8,b.position[1]-24,1);void 0!==b.d&&(h=O[b.d],r.drawImage(h.ka,b.I?h.position[0]+2:h.position[0]-16-h.size,h.position[1]-10));D&&(r.beginPath(),r.arc(b.position[0],b.position[1],7*ia()+25,0,360),r.lineWidth=2,r.strokeStyle="#f09",r.stroke());p.state===v.k?J>a&&0===Math.floor(a/100)%2||R(A.s,c[0]-8,c[1]-8,2,!1,a):R(A.s,c[0]-8,c[1]-8,0);l&&(r.fillStyle="red",r.fillRect(k[0]-
1,k[1]-1,2,2),r.beginPath(),r.arc(k[0],k[1],5,0,360),r.lineWidth=2,r.strokeStyle="red",r.stroke());p.state===v.k?(r.fillStyle="#00deff",r.fillText("BOY",10,396),r.fillStyle="red",r.fillText("CROW",600,12),r.fillStyle="white",r.fillText("SPEED: "+ia()+"   BOOST: "+Math.max(0,Math.ceil((b.$-a)/1E3))+"   TIME: "+Math.max(0,Math.ceil((p.time-a)/1E3))+"   CANDIES: "+b.L+"   CRATES: "+b.e,50,396),r.fillText("SHOTS: "+n+"   STUN: "+Math.max(0,Math.ceil((J-a)/1E3))+"   HEALTH: "+B,410,12)):p.state===v.f&&
(r.fillStyle="white",r.fillText("< > CHANGE BLOCK   G: GRANNY   C: CRATES   T: TIME ("+w[t].m+")   N: NAME ("+w[t].name+")"+(ca?"   1: PAINT   2: TOGGLE PAINT":""),12,12));p.state===v.g&&r.drawImage(Ma,0,0);p.state===v.f&&(r.globalAlpha=0.6,H<ta?(Ja(""+H,s[0]-s[0]%u,s[1]-s[1]%u),r.strokeStyle="#000",r.strokeRect(s[0]-s[0]%u,s[1]-s[1]%u,u,u)):H===na.ua?R(A.G,s[0]-8,s[1]-24,1):H===na.s?R(A.s,s[0]-8,s[1]-8,0):H===na.j?F(A.j,s[0],s[1]):H===na.r&&(r.fillStyle="yellow",r.fillRect(s[0]-8,s[1]-8,16,16),r.fillStyle=
"#000",r.fillText("C",s[0]-4,s[1]+4)),r.globalAlpha=1);window.requestAnimationFrame(Fa)})()})();

var h={};
(function(a){function d(a,b){return b?p(a&255)+d(a>>8,b-1):""}var c=this.n=a||44100,b=2*c,p=String.fromCharCode;this.J=function(a){var f=Audio,m=btoa,p="",ha=a.length;for(g=0;g<ha;g++)var q=32767*a[g]|0,q=-32768>q?-32768:32767<q?32767:q,q=q+(0>q?65536:0),p=p+String.fromCharCode(q&255,q>>8);a=p;a=["RIFF",36+(l=a.length),"WAVEfmt ",16,1,1,c,b,2,16,"data",l,a];p="";for(g=0;g<a.length;g++)p+="s"=="s4s4224422s4s"[g]?a[g]:d(a[g],"s4s4224422s4s".charCodeAt(g)-48);return new f("data:audio/wav;base64,"+m(p))};
var f,g,r=Math.sin,u=2*Math.PI;this.filter=function(a,b,c,d,p,q,m,s,r,u){c=c?c:1;d=d?d:a.length;f=a.slice(0);for(g=c;g<d;g++)f[g]=b(a,f,c,d,g,p,q,m,s,r,u);return f};this.filters={aa:function(a,b,c,d,f,g){return b[f-1]+g*(a[f]-b[f-1])},ba:function(a,b,c,d,f,g){return b[f-1]+g*(d-f)/(d-c)*(a[f]-b[f-1])},$:function(a,b,c,d,f,g){return g*(b[f-1]+a[f]-a[f-1])}};this.p=function(a,b,d,f,p,m,r,s,W){b=b*u/c;var X=Array(a|0);for(g=0;g<a;g++)X[g]=d(g*b,f,p,m,r,s,W);return X};var m=0;this.d={q:function(a){4>
a%u&&(m=2*Math.random()-1);return m},ca:Math.random,s:Math.sin,u:function(a){return r(a)+0.5*r(a/2)+0.3*r(a/4)},r:function(a){return 2*(a/u-(a/u+0.5|0))},j:function(a,b){return r(a)>b?1:r(a)<b?-1:b}}}).apply(h);var ba={};
(function(){this.i=[];this.g={j:h.d.j,r:h.d.r,s:h.d.s,q:h.d.q,u:h.d.u};this.H=function(){var a=[];for(e in this.g)a.push(e);return a};this.I=function(){function a(a,b,g,r,u){void 0===u&&(u=(g-b)/1E3);a={name:a,id:a.replace(/ /g,""),min:b,max:g,step:u,G:r,type:"range",group:c};d.push(a)}var d=[],c=0,b=this.H();(function(a,b,g){a={name:a,id:a.replace(/ /g,""),options:b,G:g,type:"option",group:c};d.push(a)})("Generator",b,b[0]);a("Super Sampling Quality",0,16,0,1);a("Master Volume",0,1,0.4);c++;a("Attack Time",
0,1,0.1);a("Sustain Time",0,2,0.3);a("Sustain Punch",0,3,2);a("Decay Time",0,2,1);c++;a("Min Frequency",20,2400,0,1);a("Start Frequency",20,2400,440,1);a("Max Frequency",20,2400,2E3,1);a("Slide",-1,1,0);a("Delta Slide",-1,1,0);c++;a("Vibrato Depth",0,1,0);a("Vibrato Frequency",0.01,48,8);a("Vibrato Depth Slide",-0.3,1,0);a("Vibrato Frequency Slide",-1,1,0);c++;a("Change Amount",-1,1,0);a("Change Speed",0,1,0.1);c++;a("Square Duty",0,0.5,0);a("Square Duty Sweep",-1,1,0);c++;a("Repeat Speed",0,0.8,
0);c++;a("Phaser Offset",-1,1,0);a("Phaser Sweep",-1,1,0);c++;a("LP Filter Cutoff",0,1,1);a("LP Filter Cutoff Sweep",-1,1,0);a("LP Filter Resonance",0,1,0);a("HP Filter Cutoff",0,1,0);a("HP Filter Cutoff Sweep",-1,1,0);return d};this.p=function(a){var d=2*Math.PI,c=Math.sin,b=Math.pow,p=Math.abs,f=h.n,g=a.T|0;1>g&&(g=1);for(var f=f*g,r=[{c:0,f:1,time:a.K},{c:1+a.U,f:1,time:a.V},{c:1,f:0,time:a.L}],u=r.length,m=0;m<u;m++)r[m].e=1+(r[m].time*f|0);for(var H=void 0,pa=0,qa=-1,Va=0,ha=-1,q=0,m=0;m<u;m++)q+=
r[m].e;q<f/2&&(q=f/2);var Ea=Array(q/g|0),s=0,W=0,X=ba.g[a.M];void 0===X&&(X=this.g.j);var P=0,P=a.R;square_slide=a.S/f;var Y=0,F=a.b*d/f,ra=1+64*b(a.D,3)/f,Z=b(a.w,3)/(1E3*f);void 0!==g&&(Z/=g);a.m>a.b&&(a.m=a.b);a.l<a.b&&(a.l=a.b);for(var Wa=a.m*d/f,Xa=a.l*d/f,Fa=0,Ga=a.Y*d/f,T=a.W,vb=1+3*b(a.Z,3)/f,sa=a.X/f,ta=0,Ha=a.v*f,ja=b(a.k,2),ja=0<a.k?1+10*ja:1-0.9*ja,Ia=Array(1024),m=0;1024>m;m++)Ia[m]=0;var ua=0,K=1020*b(a.P,2),ka=4E3*b(a.Q,3)/f,wb=1E-5<p(ka)||1E-5<p(K),xb=0.0010<a.A||0.999>a.h,$=0,aa=
0,U=b(a.h,3)/10,yb=1+a.B/1E4,la=5/(1+20*b(a.N,2))*(0.01+a.h);0.8<la&&(la=0.8);var la=1-la,zb=0.999>a.h,va=0,Q=b(a.A,2)/10,Ab=1+a.B/1E4,wa=0,Ya=q;0<a.C&&(Ya=b(1-a.C,2)*f+32);for(var Bb=a.O,Ja=0,m=0;m<q;m++)s=X(Y,P,0),P+=square_slide,0>P?P=0:0.5<P&&(P=0.5),wa>Ya&&(Y=0,F=a.b*d/f,ra=1+3*b(a.D,3)/f,Z=b(a.w,3)/(1E3*f),void 0!==g&&(Z/=g),ta=0,Ha=a.v*f,ja=1+(a.k|0)/12,wa=0),wa+=1,Y+=F,ra+=Z,F*=ra,ta>Ha&&(F*=ja,Ha=q),ta+=1,F>Xa?F=Xa:F<Wa&&(F=Wa),Fa+=Ga,H=F*c(Fa)*T,Y+=H,Ga*=vb,sa&&(T+=sa,0>T?sa=T=0:1<T&&(T=
1,sa=0)),xb&&(0.0010<p(Q)&&(Q*=Ab,1E-5>Q?Q=1E-5:0.1<Q&&(Q=0.1)),H=$,U*=yb,0>U?U=0:0.1<U&&(U=0.1),zb?(aa+=(s-$)*U,aa*=la):($=s,aa=0),$+=aa,va+=$-H,s=va*=1-Q),wb&&(K+=ka,0>K&&(K=-K,ka=-ka),1023<K&&(K=1023,ka=0),Ia[ua]=s,s+=Ia[ua-(K|0)+1024&1023],ua=ua+1&1023),m>ha&&(qa+=1,H=qa<u?r[qa]:{c:0,f:0,e:q},pa=H.c,Va=(H.f-H.c)/(H.e+1),ha+=H.e),s*=pa,pa+=Va,s*=Bb,1<g?(W+=s,0===(m+1)%g&&(Ea[Ja]=W/g,Ja+=1,W=0)):Ea[m]=s;a=f/100|0;padding=Array(a);for(m=0;m<a;m++)padding[m]=0;return padding.concat(Ea).concat(padding)};
this.i=this.I()}).apply(ba);var ca={};(function(){this.o=function(a){a=ba.p(this.F(a));return h.J(a)};this.F=function(a){for(var d={},c=ba.i.length,b=0;b<c;b++)d[ba.i[b].id]=a[b];return d}}).apply(ca);var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame;var k=document.getElementById("c"),n=k.getContext("2d"),t=640,v=400,w=16,da="2",ea=1,fa=3,ga=1,ia=1,ma=12,na=[1,-6],oa=12,xa=[75,370],ya=[t-24,24],za=[95,78];INTRO_THEME="023123467".split("");
var x=null,Aa=4,Ba=0,Ca=0,Da=0,Ka=!1,La=!1,Ma=!1,Na=!1,y=0,Oa=null,Pa=!1,z=void 0,Qa=3,A=null,Ra=null,B=3,Sa=!1,Ta=0,C=[],Ua=null,Za=null,$a=null,ab=null,bb=null,cb={a:null,size:1,position:null,t:null},D=[],db={a:null,position:null},eb=[],fb={a:null,position:null,speed:6},E=[],G=!1,gb=k.getBoundingClientRect(),hb=0,ib=0,jb=0,kb=document.createElement("canvas"),I=null,lb=[80,53],mb=null,J={};window.addEventListener("keyup",function(a){J[a.keyCode]=void 0},!1);
window.addEventListener("keydown",function(a){J[a.keyCode]=Date.now()},!1);for(var nb=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],ob={},pb=0;pb<nb.length;pb++)ob[pb]=ca.o(["synth",0,0.4,0,0.208,0,0.12,20,nb[pb],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);var qb=INTRO_THEME.slice();function rb(){ob[qb.shift()].play();0<qb.length&&setTimeout(rb,200)}var sb={};function L(a,d){sb[a]=ca.o(d)}
L(0,["square",0,0.4,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,0,0,0,0.783,0,0,0,0]);L(ea,["noise",0,0.4,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);L(5,["square",0,0.4,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);L(8,["saw",0,0.4,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);
L(2,["saw",0,0.4,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,0,0.5,-0.592,0,0.094,0.066,1,0,0,0.28,0]);L(7,["synth",0,0.4,0,0.32,0.348,0.44,20,372,417,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);L(6,["square",0,0.4,0,0.32,0.348,0.44,20,1521,2400,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);L(4,["noise",0,0.4,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);
L(3,["noise",0,0.4,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);L(9,["square",0,0.4,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);L(10,["square",0,0.4,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);L(11,["noise",0,0.4,0,0.108,0.336,0.124,20,462,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);function M(a){sb[a]&&(sb[a].pause(),sb[a].currentTime=0,sb[a].play())}
var N=0,O=0,R=t/w,tb=v/w;function S(a,d,c){var b=new Image;b.width=d||16;b.height=c||16;b.src=a;return b}Oa=S("img/man.png",16,32);Ra=S("img/crow.png");Ua=S("img/ladder.png");Za=S("img/nest.png");$a=S("img/dispenser.png");ab=S("img/roof.png");bb=S("img/wall.png");db.a=S("img/crumbs.png");fb.a=S("img/shot.png");mb=S("img/granny.png");function ub(a,d,c,b){for(d=d.slice();0<d.length;)a.fillText(d.shift(),c,b),b+=13}
function Cb(){G=!1;x=xa.slice();A=ya.slice();I=za.slice();for(var a=ga,d,c,b,p=D.length=0;p<fa;p++)d=Object.create(cb),d.size=a,c=document.createElement("canvas"),c.width=ma+a,c.height=ma+a,b=c.getContext("2d"),b.setFillColor("yellow"),b.fillRect(0,0,ma+a,ma+a),b.setFillColor("black"),b.fillText(a,5,10),d.a=c,c=85+15*a,b=365-a,d.position=[c,b],d.t=[c,b],D.push(d),a+=ia;kb.width=t;kb.height=v;a=kb.getContext("2d");a.clearRect(0,0,t,v);a.font="12px sans-serif";a.setFillColor("rgba(0,0,0,0.7)");a.fillRect(0,
0,t,v);a.setFillColor("fff");a.fillText("Click the crow to start!",t-170,25);ub(a,["Delivery Boy must deliver all the boxes to the green goal.","If you fall from too high, the box will break, and it is returned to start position.","Use arrows to move and jump, SPACEBAR to take/leave boxes, E to eat speed candies.","Speed candies leave crumbs on the ground."],140,330);a.textAlign="right";ub(a,["Crow must hinder Delivery Boy from delivering all the boxes.","Move with mouse, left click to shoot and right click to collect food.",
"Food recharges shots and is found in the nest and crumbs left by Delivery Boy.","Don't touch roofs and don't get too close to Delivery Boy or you'll get stunned.","Oh, and don't get shot!"],440,30);a.font="20px sans-serif";a.textAlign="center";a.fillText("Delivery Boy "+ib+" - "+jb+" Crow",t/2,v/2);a.beginPath();a.arc(t-25,25,16,0,360);a.lineWidth=1;a.strokeStyle="fff";a.stroke();qb=INTRO_THEME.slice()}Cb();function Db(a){return[a.clientX-gb.left,a.clientY-gb.top]}
function Eb(){return Math.max(1,Aa+Ca-(void 0!==z?D[z].size:0))}k.addEventListener("click",function(a){a=Db(a);G?0<B&&Ta<Date.now()&&(B--,M(2),a=Object.create(fb),a.position=A.slice(),E.push(a)):a[0]>t-36&&36>a[1]&&(G=!0,hb=Date.now()+3E5,rb(),k.style.cursor="none")});k.addEventListener("mousemove",function(a){G&&(A=Db(a).slice())});
k.addEventListener("contextmenu",function(a){a.preventDefault();if(G&&Ta<Date.now())if(a=Db(a),"6"===C[R*Math.round(A[1]/w-0.5)+Math.round(A[0]/w-0.5)]&&3>B)M(9),B++;else{var d;for(d=0;d<eb.length;d++)if(Fb(a,eb[d].position)){B=Math.max(B,5);M(9);eb.splice(d,1);break}}});C="4444444444444444444444444444444444444444333333000000000000000000000000000000006000000300000000000000000000000000000000110000000000000000000000000033330000000000055500000000000000020000000000000000000011111100100110011112011100111100000000000000000000000000000200000000001000000000000000000000000007020000000000010000000000011100000000001111110000000000100200000020000000000000333333300003333301021000002000333333000000000000000000000002000000200000000000000000000000000000000200000020000000000000100100100110000202020000002011111111111110000000333110011112111000200333333333300000000000033000000333330020000000000000000000000000000000000000002000000000000000002000000000000200000000201111001111110111201110011111120111110020000000000000000020000000000002000000002000000000000000002070000000000200000000003333300000000000111100002000020000000000000000000000000000000000211112000000000000000000000000000000000020000000000011111111111111111111111111111111111111114444444444444444444444444444444444444444";
function Fb(a,d){return Math.round(a[0]/w)===Math.round(d[0]/w)&&Math.round(a[1]/w)===Math.round(d[1]/w)}function Gb(){var a=Ba,d=Eb();Ma||(a=0);Ba=a=Math.min(d,a+d/5);return V(x,da)?d/3:a}function Hb(a){return Fb(x,[x[0],x[1]+w/2])||C[R*Math.round(x[1]/w)+Math.round(x[0]/w-1)]!==a&&C[R*Math.round(x[1]/w)+Math.round(x[0]/w)]!==a?!1:!0}function V(a,d){return C[R*Math.round(a[1]/w-1)+Math.round(a[0]/w-0.5)]===d?!0:!1}function Ib(a,d){return Math.pow(a[0]-d[0],2)+Math.pow(a[1]-d[1],2)}
function Jb(){var a=void 0!==z?D[z]:void 0;a&&(M(ea),z=void 0,a.position=a.t.slice())}function Kb(){var a=void 0!==z?D[z]:void 0;a&&y>oa-a.size&&Jb()}
(function Lb(d){if(G){var c=Eb(),b=x[0],p=x[1];if(!J[32]||Ka||La||Na)if(J[69]&&!Na){if(Na=!0,0<Qa){Qa--;Ca=3;Da=Date.now()+5E3;var f=Object.create(db);f.position=[x[0]+4,x[1]-7];eb.push(f);M(8)}}else J[32]||(J[69]||!Na)||(Na=!1);else{Na=!0;a:{var f=z,g=void 0!==f?D[f]:void 0;if(void 0===g){for(f=0;f<D.length;f++)if(Fb(x,D[f].position)){z=f;M(4);break a}V(x,"7")&&(Qa=3,M(10))}else z=void 0,M(4),V(x,"5")&&void 0!==g&&(M(5),D.splice(f,1),0>=D.length&&(ib+=1,k.style.cursor="auto",M(6),Cb()))}}J[38]?V(x,
da)?(x[1]=Math.min(v-w,p-2),Ma=!0):Ka||La||(y=-7,Ba=c,La=Ka=!0,M(0)):!J[38]&&Ka&&(Ka=!1);J[37]&&(x[0]=Math.max(w,b-Gb()),Ma=!0);J[39]&&(x[0]=Math.min(t-2*w,b+Gb()),Ma=!0);J[40]&&(V(x,da)&&!Hb("1"))&&(x[1]=Math.min(v,p+2),Ma=!0);J[37]||(J[38]||J[39]||J[40])||(Ma=!1)}if(G){gb=k.getBoundingClientRect();if(V(x,da)||Hb("1")||x[1]>v-w){if(0<y||Hb(da))Kb(),Ba=y=0,La=!1}else 0<y&&Pa&&(Kb(),y=w/3),y+=1,La=!0;x[1]+=y;Pa="1"===Math.round(x[1]/w)+Math.round(x[0]/w)?!0:!1;void 0!==z&&(D[z].position[0]=x[0]+na[0],
D[z].position[1]=x[1]+na[1]);Da<d&&0<Ca&&(Ca=0);for(c=0;c<E.length;c++)if(b=E[c],b.position[1]+=b.speed,Fb(x,b.position))Jb(),E.splice(c,1),c--;else if(b.position[1]>v||V(b.position,"3"))E.splice(c,1),c--;hb<d&&(jb+=1,k.style.cursor="auto",M(7),Cb());Sa=Math.pow(7*Eb()+75,2)>=Ib(A,x);c=V(A,"6")?za:A;b=I;b=Math.atan((c[1]-b[1])/(c[0]-b[0]));p=I[0]>c[0]?-1:1;if(3<Math.abs(c[0]-I[0])||3<Math.abs(c[1]-I[1]))I[0]+=1.5*Math.cos(b)*p,I[1]+=1.5*Math.sin(b)*p;(Math.pow(7*Eb()+25,2)>=Ib(A,x)||V(A,"3")||3>Math.sqrt(Ib(I,
A)))&&Ta<d&&(Ta=d+5E3,M(11),B=0)}n.setFillColor("black");n.fillRect(0,0,t,v);for(N=0;N<R;N++)for(O=0;O<tb;O++)b=null,c="00deff","0"!==C[R*O+N]&&("1"===C[R*O+N]?b=bb:"3"===C[R*O+N]?b=ab:"4"===C[R*O+N]?c="000":"5"===C[R*O+N]?c="0f0":"6"===C[R*O+N]?b=Za:C[R*O+N]===da?b=Ua:"7"===C[R*O+N]?b=$a:c="fff"),n.setFillColor(c),n.fillRect(N*w,O*w,w,w),null!==b&&n.drawImage(b,N*w,O*w,w,w);n.drawImage(Oa,x[0]-8,x[1]-24);Sa&&(n.beginPath(),n.arc(x[0],x[1],7*Eb()+25,0,360),n.lineWidth=2,n.strokeStyle="f09",n.stroke());
for(b=0;b<D.length;b++)c=D[b],n.drawImage(c.a,c.position[0]-8,c.position[1]-8);for(b=0;b<eb.length;b++)c=eb[b],n.drawImage(c.a,c.position[0]-8,c.position[1]-8);for(b=0;b<E.length;b++)c=E[b],n.drawImage(c.a,c.position[0]-8,c.position[1]-8);n.drawImage(mb,lb[0],lb[1]);Ta>d&&0===Math.floor(d/100)%2||n.drawImage(Ra,A[0]-8,A[1]-8);n.setFillColor("red");n.setFillColor("red");n.fillRect(I[0]-1,I[1]-1,2,2);n.beginPath();n.arc(I[0],I[1],5,0,360);n.lineWidth=2;n.strokeStyle="red";n.stroke();n.setFillColor("00deff");
n.fillText("BOY",10,396);n.setFillColor("red");n.fillText("CROW",600,12);n.setFillColor("white");n.fillText("SPEED: "+Eb(),40,396);n.fillText("BOOST TIMEOUT: "+Math.max(0,Math.ceil((Da-d)/1E3)),100,396);n.fillText("TIME LEFT: "+Math.max(0,Math.ceil((hb-d)/1E3)),210,396);n.fillText("CANDIES: "+Qa,300,396);n.fillText("SHOTS: "+B,540,12);n.fillText("STUN: "+Math.max(0,Math.ceil((Ta-d)/1E3)),480,12);G||n.drawImage(kb,0,0);window.requestAnimationFrame(Lb)})();

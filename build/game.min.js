var la={};
(function(b){function w(b,D){return D?l(b&255)+w(b>>8,D-1):""}var p=this.Fa=b||44100,t=2*p,l=String.fromCharCode,d;this.Ya=function(b){var D=Audio,q=btoa,N="",U=b.length;for(f=0;f<U;f++)var l=32767*b[f]|0,l=-32768>l?-32768:32767<l?32767:l,l=l+(0>l?65536:0),N=N+String.fromCharCode(l&255,l>>8);b=N;b=["RIFF",36+(d=b.length),"WAVEfmt ",16,1,1,p,t,2,16,"data",d,b];N="";for(f=0;f<b.length;f++)N+="s"=="s4s4224422s4s"[f]?b[f]:w(b[f],"s4s4224422s4s".charCodeAt(f)-48);return new D("data:audio/wav;base64,"+q(N))};
var I,f,M=Math.sin,q=2*Math.PI;this.filter=function(b,D,d,l,q,p,t,w,J,M){d=d?d:1;l=l?l:b.length;I=b.slice(0);for(f=d;f<l;f++)I[f]=D(b,I,d,l,f,q,p,t,w,J,M);return I};this.filters={fb:function(b,d,l,q,p,f){return d[p-1]+f*(b[p]-d[p-1])},gb:function(b,d,l,p,f,q){return d[f-1]+q*(p-f)/(p-l)*(b[f]-d[f-1])},eb:function(b,d,l,p,f,q){return q*(d[f-1]+b[f]-b[f-1])}};this.Ha=function(b,d,l,t,w,I,G,J,M){d=d*q/p;var F=Array(b|0);for(f=0;f<b;f++)F[f]=l(f*d,t,w,I,G,J,M);return F};var J=0;this.Q={Za:function(b){4>
b%q&&(J=2*Math.random()-1);return J},hb:Math.random,ab:Math.sin,bb:function(b){return M(b)+0.5*M(b/2)+0.3*M(b/4)},$a:function(b){return 2*(b/q-(b/q+0.5|0))},Na:function(b,d){return M(b)>d?1:M(b)<d?-1:d}}}).apply(la);var Ja={};
(function(){this.ia=[];this.fa={square:la.Q.Na,saw:la.Q.$a,sine:la.Q.ab,noise:la.Q.Za,synth:la.Q.bb};this.Va=function(){var b=[],w;for(w in this.fa)b.push(w);return b};this.Wa=function(){function b(b,d,t,f,M){void 0===M&&(M=(t-d)/1E3);b={name:b,id:b.replace(/ /g,""),min:d,max:t,step:M,Ua:f,type:"range",group:p};w.push(b)}var w=[],p=0,t=this.Va();(function(b,d,t){b={name:b,id:b.replace(/ /g,""),options:d,Ua:t,type:"option",group:p};w.push(b)})("Generator",t,t[0]);b("SuperSamplingQuality",0,16,0,1);
b("MasterVolume",0,1,0.4);p++;b("AttackTime",0,1,0.1);b("SustainTime",0,2,0.3);b("SustainPunch",0,3,2);b("DecayTime",0,2,1);p++;b("MinFrequency",20,2400,0,1);b("StartFrequency",20,2400,440,1);b("MaxFrequency",20,2400,2E3,1);b("Slide",-1,1,0);b("DeltaSlide",-1,1,0);p++;b("VibratoDepth",0,1,0);b("VibratoFrequency",0.01,48,8);b("VibratoDepth Slide",-0.3,1,0);b("VibratoFrequencySlide",-1,1,0);p++;b("ChangeAmount",-1,1,0);b("ChangeSpeed",0,1,0.1);p++;b("SquareDuty",0,0.5,0);b("SquareDutySweep",-1,1,0);
p++;b("RepeatSpeed",0,0.8,0);p++;b("PhaserOffset",-1,1,0);b("PhaserSweep",-1,1,0);p++;b("LPFilterCutoff",0,1,1);b("LPFilterCutoffSweep",-1,1,0);b("LPFilterResonance",0,1,0);b("HPFilterCutoff",0,1,0);b("HPFilterCutoffSweep",-1,1,0);return w};this.Ha=function(b){var w=2*Math.PI,p=Math.sin,t=Math.pow,l=Math.abs,d=la.Fa,I=b.SuperSamplingQuality|0;1>I&&(I=1);for(var d=d*I,f=[{P:0,ba:1,time:b.AttackTime},{P:1+b.SustainPunch,ba:1,time:b.SustainTime},{P:1,ba:0,time:b.DecayTime}],M=f.length,q=0;q<M;q++)f[q].aa=
1+(f[q].time*d|0);for(var J=void 0,x=0,D=-1,T=0,N=-1,U=0,q=0;q<M;q++)U+=f[q].aa;U<d/2&&(U=d/2);var Ea=Array(U/I|0),G=0,ea=0,ta=Ja.fa[b.Generator];void 0===ta&&(ta=this.fa.Na);var F=0,F=b.SquareDuty,Pa=b.SquareDutySweep/d,ga=0,V=b.StartFrequency*w/d,W=1+64*t(b.Slide,3)/d,X=t(b.DeltaSlide,3)/(1E3*d);void 0!==I&&(X/=I);b.MinFrequency>b.StartFrequency&&(b.MinFrequency=b.StartFrequency);b.MaxFrequency<b.StartFrequency&&(b.MaxFrequency=b.StartFrequency);for(var ua=b.MinFrequency*w/d,ha=b.MaxFrequency*w/
d,Ka=0,ma=b.VibratoFrequency*w/d,Y=b.VibratoDepth,La=1+3*t(b.VibratoFrequencySlide,3)/d,ca=b.VibratoDepthSlide/d,va=0,Fa=b.ChangeSpeed*d,na=t(b.ChangeAmount,2),na=0<b.ChangeAmount?1+10*na:1-0.9*na,wa=Array(1024),q=0;1024>q;q++)wa[q]=0;var xa=0,aa=1020*t(b.PhaserOffset,2),ia=4E3*t(b.PhaserSweep,3)/d,Qa=1E-5<l(ia)||1E-5<l(aa),O=0.0010<b.HPFilterCutoff||0.999>b.LPFilterCutoff,H=0,y=0,P=t(b.LPFilterCutoff,3)/10,Ra=1+b.HPFilterCutoffSweep/1E4,E=5/(1+20*t(b.LPFilterResonance,2))*(0.01+b.LPFilterCutoff);
0.8<E&&(E=0.8);var E=1-E,ya=0.999>b.LPFilterCutoff,za=0,ba=t(b.HPFilterCutoff,2)/10,Sa=1+b.HPFilterCutoffSweep/1E4,Aa=0,z=U;0<b.RepeatSpeed&&(z=t(1-b.RepeatSpeed,2)*d+32);for(var g=b.MasterVolume,Ga=0,q=0;q<U;q++)G=ta(ga,F,0),F+=Pa,0>F?F=0:0.5<F&&(F=0.5),Aa>z&&(ga=0,V=b.StartFrequency*w/d,W=1+3*t(b.Slide,3)/d,X=t(b.DeltaSlide,3)/(1E3*d),void 0!==I&&(X/=I),va=0,Fa=b.ChangeSpeed*d,na=1+(b.ChangeAmount|0)/12,Aa=0),Aa+=1,ga+=V,W+=X,V*=W,va>Fa&&(V*=na,Fa=U),va+=1,V>ha?V=ha:V<ua&&(V=ua),Ka+=ma,J=V*p(Ka)*
Y,ga+=J,ma*=La,ca&&(Y+=ca,0>Y?ca=Y=0:1<Y&&(Y=1,ca=0)),O&&(0.0010<l(ba)&&(ba*=Sa,1E-5>ba?ba=1E-5:0.1<ba&&(ba=0.1)),J=H,P*=Ra,0>P?P=0:0.1<P&&(P=0.1),ya?(y+=(G-H)*P,y*=E):(H=G,y=0),H+=y,za+=H-J,G=za*=1-ba),Qa&&(aa+=ia,0>aa&&(aa=-aa,ia=-ia),1023<aa&&(aa=1023,ia=0),wa[xa]=G,G+=wa[xa-(aa|0)+1024&1023],xa=xa+1&1023),q>N&&(D+=1,J=D<M?f[D]:{P:0,ba:0,aa:U},x=J.P,T=(J.ba-J.P)/(J.aa+1),N+=J.aa),G*=x,x+=T,G*=g,1<I?(ea+=G,0===(q+1)%I&&(Ea[Ga]=ea/I,Ga+=1,ea=0)):Ea[q]=G;b=d/100|0;w=Array(b);for(q=0;q<b;q++)w[q]=
0;return w.concat(Ea).concat(w)};this.ia=this.Wa()}).apply(Ja);var eb={};(function(){this.Ga=function(b){b=Ja.Ha(this.Ta(b));return la.Ya(b)};this.Ta=function(b){for(var w={},p=Ja.ia.length,t=0;t<p;t++)w[Ja.ia[t].id]=b[t];return w}}).apply(eb);(function(){var b,w,p,t;function l(c,n,a){c.addEventListener?c.addEventListener(n,a,!1):c.attachEvent?c.attachEvent("on"+n,a):c["on"+n]=a}function d(c,a,b,d,e,m){var g=ya[c].frame,f=ya[c].g;c=ya[c].frames;d=m?c[Math.floor(m*d/1E3)%c.length]:c[d];e?r.drawImage(Ta,qb-(g.x+d.x)-d.a,g.y+d.y,d.a,d.b,a+f.x,b+f.y,d.a,d.b):r.drawImage(oa,g.x+d.x,g.y+d.y,d.a,d.b,a+f.x,b+f.y,d.a,d.b)}function I(c,a,b){c.beginPath();c.arc(a,b,0,360);c.lineWidth=2;c.strokeStyle=void 0;c.stroke()}function f(c,a,b,d,e,g){var f=
ya[a].frame;a=ya[a].g;c.drawImage(oa,f.x,f.y,e||f.a,g||f.b,b+a.x,d+a.y,a.a,a.b)}function M(c,a){var b=c-m.Y.left,d=a-m.Y.top,b=Math.max(0,Math.min(b,O-1)),d=Math.max(0,Math.min(d,H-1));return[b,d]}function q(c,a,b,d,e,f,g){var m=c.fillStyle,k=c.textAlign,p=c.font;c.fillStyle=e;c.font=g;c.textAlign=f;for(a=a.slice();0<a.length;)c.fillText(a.shift(),b,d),d+=10;c.fillStyle=m;c.font=p;c.textAlign=k}function J(c){da.style.cursor=c?"auto":"none"}function x(c,a){if(ba)try{Ma[c]=eb.Ga(a)}catch(b){}}function D(c){if(ba)try{Ma[c]&&
(Ma[c].pause(),Ma[c].currentTime=0,Ma[c].play())}catch(a){}}function T(c,a){var b=document.getElementById(c);l(b,Ua,function(c){c.preventDefault();ja.La({keyCode:a})});l(b,fb,function(c){c.preventDefault();ja.Ma({keyCode:a})})}function N(c,a,b,d){var e=Object.create(Bb);e.position=a;e.text=[c];e.color=b;e.time=pa+Cb;e.Ia=d||!1;Na.push(e)}function U(c,a,b,d,e){var f=Object.create(Db);f.position=c.slice();f.d=a.slice();f.color=b;f.time=pa+Eb;f.size=d;f.speed=e;Ba.push(f)}function Ea(c){var a=c[s.ca],
b,d,e,f;Va.T=a;for(var g=Q.length=0;g<c[s.h].length;g++)b=c[s.h][g],d=Object.create(Va),d.size=b,e=document.createElement("canvas"),e.width=Ha+b,e.height=Ha+b,f=e.getContext("2d"),f.fillStyle="#ea0",f.strokeStyle="#330",f.fillRect(0,0,Ha+b,Ha+b),f.strokeRect(0,0,Ha+b,Ha+b),f.fillStyle="#000",f.fillText(b,5,10),d.ma=e,e=a[0]+16*g,b=a[1]-b,d.position=[e,b],d.T=[e,b],Q.push(d)}function G(c){c=m.o=B[c]||B[v];a.position=c[s.ha].slice();a.u=0;a.v=0;a.oa=0;a.c=void 0;a.Z=rb;a.w=!1;a.G=!1;a.r=!1;a.e=!1;a.j=
!1;e.$=sb;e.i=0;e.A=0;e.position=c[s.U].slice();e.d=c[s.U].slice();b=c[s.L].slice();w=[c[s.L][0]+15,c[s.L][1]+23];p=w.slice();t=1;C.position=C.d=null;C.na=gb;m.time=0;ta(A.k);S=0;Ca.length=0;qa.length=0;Na.length=0;Ba.length=0;fa="4444444444444444444444444444444444444444"+c[s.ga]+"4444444444444444444444444444444444444444";fa=fa.split("");Ia=null;Ea(c);Wa=Sa.slice();window.localStorage&&(window.localStorage.Aa=JSON.stringify(B));ea()}function ea(){var c,a;for(c=0;c<P;c++)for(a=0;a<Ra;a++)aa(Fb,fa[P*
a+c],c*y,a*y)}function ta(c){m.state=c;if(R){var a=document.getElementsByClassName("e");c="b e"+(c===A.f?"":" h");for(var b=0;b<a.length;b++)a[b].setAttribute("class",c)}}function F(c){ta(A.l);m.time=pa+m.o[s.n];ba&&(Xa=c+Aa);J()}function Pa(c){m.ka+=1;J(!0);D(z.Ea);Ya=!0;G(v);Za=c+Ga}function ga(c){m.la+=1;J(!0);D(z.wa);Ya=!1;G(v);Za=c+Ga}function V(c,a){return Math.atan((a[1]-c[1])/(a[0]-c[0]))}function W(c,a){return c&&a&&Math.sqrt(Math.pow(c[0]-a[0],2)+Math.pow(c[1]-a[1],2))}function X(c,a){return fa[P*
Math.floor(a/y)+Math.floor(c/y)]}function ua(c,a,b,d,e){var f=a,g=X(c,f);b=c+b;topRight=X(b,f);bottomRight=X(b,a+d);bottomLeft=X(c,a);return g===e||topRight===e||bottomRight===e||bottomLeft===e}function ha(a,b,d,e,f){b+=e;e=X(a,b);bottomLeft=X(a+d,b);return e===f||bottomLeft===f}function Ka(){var c=a.v,b=ma();if(a.e)c=a.v;else if(a.r)c=Math.min(b,c+b/25);else if(c*=Math.min(0.2*b,0.8),0.2>c||Y(L.q))c=0;a.v=c;return Y(L.q)?b/2:c}function ma(){return Math.max(1,a.speed+a.S-(void 0!==a.c?Q[a.c].size:
0))}function Y(c){return ua(a.position[0]-8,a.position[1]-32,16,32,c)||ua(a.position[0],a.position[1]-8,0,0,c)}function La(a){a&&a.preventDefault();if(m.state===A.f)hb=!hb;else if(m.state===A.l&&e.A<pa){a=M(u[0],u[1]);var b=e.i;if((ha(e.position[0]-8,e.position[1]-8,16,16,L.C)||ua(e.position[0],e.position[1],0,0,L.C))&&e.i<Gb)D(z.ea),e.i++,N("+"+(e.i-b)+"\u21a1",[e.position[0]-4,e.position[1]-4],"#0c0");else{var d;for(d=0;d<Ca.length;d++)if(W(a,Ca[d].position)<ib){e.i=Math.max(e.i,Hb);N("+"+(e.i-
b)+"\u21a1",[e.position[0]-4,e.position[1]-4],"#0c0");D(z.ea);Ca.splice(d,1);break}}}}function ca(){if(m.state===A.f)if(S<Da){var c=P*Math.floor(u[1]/y)+Math.floor(u[0]/y);c<fa.length-P&&c>P&&(fa[c]=""+S);ea()}else if(S===ra.Ba)a.position=u.slice();else if(S===ra.B)e.position=u.slice();else if(S===ra.K)b=u.slice(),w=[b[0]+15,b[1]+23],p=w.slice();else{if(S===ra.h)for(Va.T=u.slice(),c=0;c<Q.length;c++){var d=Q[c];d.position[0]=u[0]+16*c;d.position[1]=u[1]-d.size}}else m.state!==A.k||R?0<e.i&&e.A<pa&&
(e.i--,D(z.ua),c=Object.create(Ib),c.position=e.position.slice(),qa.push(c)):u[0]>e.position[0]-16&&(u[0]<e.position[0]+16&&u[1]>e.position[1]-16&&u[1]<e.position[1]+16)&&F(pa)}function va(a){for(var b=60;0<b--;)U(e.position,[e.position[0]-Math.floor(128*Math.random()-64),e.position[1]+Math.ceil(128*Math.random()-64)],"#000",Math.ceil(3*Math.random()),Math.ceil(5*Math.random()));e.A=a+Jb;D(z.ta);e.i=0;e.$--;N("-1\u2665",[e.position[0]-4,e.position[1]-4],"#c00");0>=e.$?Pa(a):na(a);jb=a+tb}function Fa(a){if(!Ia){Ia=
[];for(var b=0;b<fa.length;b++)fa[b]===L.D&&Ia.push(b)}b=Ia[Math.floor(Math.random()*Ia.length)]+1;b=[b%P*y,Math.floor(b/P)*y];C.d=[b[0]-6,b[1]-10];C.position?D(z.ra):C.position=C.d.slice();C.Ka=a+Kb;t+=0.05}function na(a){C.position||0<--C.na||(C.na=gb,D(z.qa),Fa(a),ea())}function wa(c,d){for(var e=80;0<e--;)U(a.position,[a.position[0]-Math.floor(128*Math.random()-64),a.position[1]-16-Math.ceil(128*Math.random()-64)],0.4>Math.random()?"#330":"#ea0",Math.ceil(3*Math.random()),Math.ceil(4*Math.random()));
N(0.5<Math.random()?"My mirrors!":"Be careful!",[b[0]+4,b[1]],"#fff",!0);D(z.Ca);a.c=void 0;c.position=c.T.slice();a.Z--;N("-1\u25fc",[a.position[0]-4,a.position[1]-32],"#c00");jb=d+tb;0>=a.Z?ga(d):na(d)}function xa(a){var b=a||B[v];a=[a?b[s.m]:"CustomLevel"+Lb++,b[s.ha].slice(),b[s.U].slice(),b[s.ca].slice(),b[s.L].slice(),b[s.n],b[s.ga],b[s.h].slice(),null,!0];B.push(a);m.state===A.k&&(v=B.length-1,G(v))}function aa(a,b,d,e){var g=null,m=C.position?"rgb("+Math.pow(e,2)+","+Math.floor(e/3)+","+Math.floor(e)+
")":"rgb("+Math.floor(e/3)+","+Math.floor(e)+","+Math.pow(e,2)+")";b===L.D?g=E.D:b===L.O?g=E.O:b===L.Sa?m="#000":b===L.xa?m="#0f0":b===L.C?g=E.C:b===L.q?g=E.q:b===L.s&&(g=E.s);a.fillStyle=m;a.fillRect(d,e,y,y);null!==g&&f(a,g,d,e,y,y)}function ia(a,b,d){if(a.position&&a.d){var e=V(a.position,a.d),f=a.position[0]>a.d[0]?-1:1,g=Math.abs(a.position[0]-a.d[0]),m=Math.abs(a.position[1]-a.d[1]);return g>b||m>b?(b=Math.cos(e)*f*d,d*=Math.sin(e)*f,Math.abs(b)>g&&(b=g*b/Math.abs(b)),Math.abs(d)>m&&(d=m*d/
Math.abs(d)),a.position[0]+=b,a.position[1]+=d,!0):!1}}function Qa(c){if(!(Za>c)){var n=ja.R;if(m.state===A.k)if(n[g.W]&&!$)v=(v+B.length-1)%B.length,G(v);else if(n[g.X]&&!$)v=(v+1)%B.length,G(v);else if(n[g.I]&&!$)B[v][s.V]||xa(),ta(A.f),n[g.I]=void 0;else if(n[g.H]&&!$)B[v][s.V]&&(B.splice(v,1),v--,G(v)),n[g.H]=void 0;else if(n[g.J]&&B[v][s.V]&&!$){var l=prompt("JSON",JSON.stringify(B[v]));n[g.J]=void 0}else{if(n[g.ya]||R&&n[g.N]){if(l=prompt("JSON"))try{xa(JSON.parse(l))}catch(M){alert("Error")}n[g.N]=
void 0;n[g.ya]=void 0}}else{if(m.state===A.f){var x=c;if(!$){if(n[g.W])S=(S+kb-1)%kb;else if(n[g.X])S=(S+1)%kb;else if(n[g.h]){try{if(l=JSON.parse(prompt("Crates",JSON.stringify(B[v][s.h]))),l instanceof Array){for(x=0;x<l.length;x++)"number"===!typeof x&&alert("Error"),l[x]=Math.max(1,Math.min(5,l[x]));B[v][s.h]=l;Ea(B[v])}}catch(T){alert("Error")}n[g.h]=void 0}else n[g.m]?((l=prompt("Name",B[v][s.m]))&&(B[v][s.m]=l),n[g.m]=!1):n[g.n]&&(x=+prompt("Time",B[v][s.n]),!isNaN(x)&&0<x&&(B[v][s.n]=x),n[g.n]=
!1);R&&(n[g.H]&&!$)&&ca();R&&(n[g.J]&&!$)&&La()}}else if(m.state===A.l){n[g.ja]?Y(L.q)?(a.position[1]=Math.min(H-y,a.position[1]-a.Ja),a.F=!0):a.G||a.e||(a.p=a.Xa,a.G=!0,a.e=!0,a.F=!1,D(z.za)):!n[g.ja]&&a.G?(a.G=!1,a.F=!1):n[g.va]&&Y(L.q)?(a.position[1]=Math.min(H,a.position[1]+a.Ja),a.F=!0):a.F=!1;n[g.W]&&!a.e?(a.r=!0,a.j=!0):n[g.X]&&!a.e?(a.r=!0,a.j=!1):a.r=!1;if(a.r||0<a.v)a.position[0]=Math.min(O-y,Math.max(y,a.position[0]+(a.j?-1:1)*Ka()));if(!n[g.N]||a.G||a.e||a.w)n[g.I]&&!a.w?(a.w=!0,0<a.u&&
(a.u--,a.S=Mb,a.oa=c+Nb,l=Object.create(Ob),l.position=[a.position[0]+4,a.position[1]-7],Ca.push(l),D(z.pa))):n[g.N]||(n[g.I]||!a.w)||(a.w=!1);else a:if(a.w=!0,l=a.c,x=void 0!==l?Q[l]:void 0,void 0===x){for(l=0;l<Q.length;l++)if(W(a.position,Q[l].position)<ib){a.c=l;D(z.da);break a}Y(L.s)&&a.u<lb&&(N("+"+(lb-a.u)+"\u00a7",[a.position[0]-4,a.position[1]-32],"#0c0"),a.u=lb,D(z.s))}else a.c=void 0,D(z.da),Y(L.xa)&&void 0!==x&&(Q.splice(l,1),N(0.5<Math.random()?"Thank you!":"Good boy!",[b[0]+4,b[1]],
"#fff",!0),0>=Q.length?Pa(c):D(z.sa));R&&(n[g.H]&&!$)&&ca();R&&(n[g.J]&&!$)&&La()}n[g.k]&&(J(!0),m.state===A.f&&(B[v][s.ga]=fa.join("").substring(P,P*Ra-P),B[v][s.ha]=a.position.slice(),B[v][s.U]=e.position.slice(),B[v][s.L]=b.slice(),B[v][s.ca]=Va.T.slice()),G(v))}$=!1;for(var F in ja.R)$=$||!!ja.R[F];if(mb&&sa){var K;if(sa.clientX)K=sa;else if(sa instanceof TouchList)for(F=0;F<sa.length;F++)if(n=sa[F],n.clientX>=ka.left&&n.clientX<ka.left+ka.width&&n.clientY>=ka.top&&n.clientY<ka.top+ka.height){K=
sa[F];break}if(K){K=[K.clientX-ka.left,K.clientY-ka.top];n=V(ub,K);F=W(ub,K)/12.5;var k;m.state===A.l?k=e.d:m.state===A.f&&(k=u);k&&(k[0]+=(m.state===A.f?Math.round(Math.cos(n)):Math.cos(n))*(100>K[0]?-F:F),k[1]+=(m.state===A.f?Math.round(Math.sin(n)):Math.sin(n))*(100>K[0]?-F:F),k[0]=Math.max(0,Math.min(k[0],O-1)),k[1]=Math.max(0,Math.min(k[1],H-1)));hb&&ca()}}}pa=c;m.Y=da.getBoundingClientRect();try{Xa<c&&m.state===A.l&&0<Wa.length&&(vb[Wa.shift()].play(),Xa+=Aa)}catch(X){}if(m.state===A.l){K=2;
var h;k=0;if(!a.e&&ha(a.position[0]-4,a.position[1],8,0,L.D))h=a.position[1]-a.position[1]%y;else for(;K<=a.p;){if(ha(a.position[0]-4,a.position[1]+K,8,0,L.D)){h=a.position[1]+K-(a.position[1]+K)%y;break}K+=y}h?(a.position[1]=h,a.e&&(a.v/=2,h=void 0!==a.c&&Q[a.c])&&(K=Pb-h.size,k=h.size,a.p>K&&wa(h,c)),a.e=!1,a.p>10-2*k&&D(z.Da),a.p=0):ha(a.position[0]-4,a.position[1]-32,8,16,L.q)?(a.e=!1,a.p=0):(a.p+=0.6,a.e=!0,a.position[1]+=a.p);a.oa<c&&0<a.S&&(a.S=0);void 0!==a.c&&(Q[a.c].position[0]=a.position[0]+
wb[0],Q[a.c].position[1]=a.position[1]+wb[1]);h=ha(e.position[0],e.position[1],0,0,L.C)?w:e.position;k=V(p,h);K=p[0]>h[0]?-1:1;if(Math.abs(h[0]-p[0])>nb||Math.abs(h[1]-p[1])>nb)p[0]+=Math.cos(k)*K*t,p[1]+=Math.sin(k)*K*t;ia(e,Qb,Rb);for(h=0;h<qa.length;h++)if(k=qa[h],k.position[1]+=k.speed,W(a.position,k.position)<ib&&void 0!==a.c)wa(Q[a.c],c),qa.splice(h,1),h--;else if(k.position[1]>H||ha(k.position[0],k.position[1],0,0,L.O))qa.splice(h,1),h--;e.A<c&&(ma()*ob+xb>=W(e.position,a.position)||ua(e.position[0],
e.position[1],0,0,L.O)||W(p,e.position)<nb)&&va(c);C.position&&(void 0!==a.c&&15>W(a.position,C.position)?(wa(Q[a.c],c),C.position=null,t=1,ea()):e.A<c&&15>W(e.position,C.position)?(va(c),C.position=null,t=1,ea()):(ia(C,Sb,Tb)&&U(C.position,[C.d[0]+Math.floor(128*Math.random()-64),C.d[1]+Math.floor(128*Math.random()-64)],"#000",Math.ceil(2*Math.random()),Math.ceil(5*Math.random())),C.Ka<c&&Fa(c)));for(k=0;k<Ba.length;k++)if(h=Ba[k],!ia(h,3,h.speed)||h.time<c)Ba.splice(k,1),k--;m.time<c&&ga(c)}m.Y=
da.getBoundingClientRect();r.fillStyle="#000";r.fillRect(0,0,O,H);k=h=0;jb>c&&(h=Math.floor(8*Math.random()-4),k=Math.floor(8*Math.random()-4));r.drawImage($a,h,k);for(k=0;k<Q.length;k++)k!==a.c&&(h=Q[k],r.drawImage(h.ma,h.position[0]-8,h.position[1]-8));for(k=0;k<Ca.length;k++)h=Ca[k],f(r,E.Qa,h.position[0]-8,h.position[1]-8);for(k=0;k<qa.length;k++)h=qa[k],f(r,E.Ra,h.position[0]-8,h.position[1]-8);f(r,E.K,b[0],b[1]);if(m.o[s.M])for(h=0;h<m.o[s.M].length;h++)q(r,m.o[s.M][h][2],m.o[s.M][h][0],m.o[s.M][h][1],
"#000");C.position&&f(r,5<W(C.position,C.d)?E.Pa:E.Oa,C.position[0]-8,C.position[1]);m.state===A.l?(a.e?d(E.t,a.position[0]-8,a.position[1]-24,0,a.j):a.r||a.F?d(E.t,a.position[0]-8,a.position[1]-24,10,a.j,c):d(E.t,a.position[0]-8,a.position[1]-24,1,a.j),a.S&&(a.e||a.r)&&(r.globalAlpha=0.6,d(E.t,a.position[0]+(a.j?-4:-12),a.position[1]-24,10,a.j,c),r.globalAlpha=0.3,d(E.t,a.position[0]+(a.j?2:-18),a.position[1]-24,10,a.j,c),r.globalAlpha=1)):d(E.t,a.position[0]-8,a.position[1]-24,1);void 0!==a.c&&
(h=Q[a.c],r.drawImage(h.ma,a.j?h.position[0]+2:h.position[0]-15-h.size,h.position[1]-10));ma()*ob+Ub>=W(e.position,a.position)&&I(a.position,ma()*ob+xb,"#f00");m.state===A.l?e.A>c&&0===Math.floor(c/100)%2||d(E.B,e.position[0]-8,e.position[1]-8,2,!1,c):d(E.B,e.position[0]-8,e.position[1]-8,0);r.fillStyle=C.position?"#00f":"#f00";r.fillRect(p[0]-1,p[1]-1,2,2);I(p,5,C.position?"#00f":"#f00");r.fillStyle="#fff";m.state===A.l?(k=Math.max(0,Math.ceil((m.time-c)/1E3)),h=k%60,k=Math.floor(k/60),10>h&&(h=
"0"+h),r.fillText("\u00a7 "+a.u+"   \u25fc "+a.Z+"   \u2732 "+k+":"+h,50,396),r.fillText("\u21a1 "+e.i+"   \u2665 "+e.$,540,12),r.fillStyle="#00deff",r.fillText("LUKE",10,396),r.fillStyle="#f00",r.fillText("CROW",600,12)):m.state===A.f&&r.fillText("< > CHANGE BLOCK   C: CRATES   T: TIME ("+B[v][s.n]+")   N: NAME ("+B[v][s.m]+")"+(R?"   S: PAINT   A: TOGGLE PAINT   analogPad: MOVE":""),12,12);for(k=0;k<Ba.length;k++)h=Ba[k],r.fillStyle=h.color,r.fillRect(h.position[0],h.position[1],h.size,h.size);
for(k=0;k<Na.length;k++)h=Na[k],h.time<c?(Na.splice(k,1),k--):(q(r,h.text,h.position[0]+1,h.position[1]+1,"#000","center","14px sans-serif"),q(r,h.text,h.position[0],h.position[1],h.color,"center","14px sans-serif"),h.Ia||(h.position[1]-=0.5));m.state===A.k&&(h=m.o,Z.fillStyle="rgba(0,0,0,0.7)",Z.clearRect(0,0,O,H),Z.fillRect(0,0,O,H),Z.fillStyle="#fff",Z.textAlign="center",Z.font="20px courier",Z.fillText(m.o[s.m],O/2,H/2-50),q(Z,["Luke "+m.ka],O/2-50,H/2,!0===Ya?"#0f0":"#fff","right"),q(Z,[m.la+
" Crow"],O/2+50,H/2,!1===Ya?"#0f0":"#fff","left"),Z.font="15px courier",Z.fillText("A 13kB game by Alberto Congiu",O/2,12),Za<c&&(Z.fillText("Click the "+(R?"screen":"crow")+" to start",O/2,H/2+60),Z.fillText("< >: Select level",O/2,H/2+100),Z.fillText(h[s.V]?"E: EDIT   "+(R?"S":"D")+": DELETE   "+(R?"A":"J")+": EXPORT   I: IMPORT":"E: EDIT   I: IMPORT",O/2,H/2+120)),I(e.position,16,"#fff"),r.drawImage(ab,0,0));m.state===A.f&&(r.globalAlpha=0.6,S<Da?(aa(r,""+S,u[0]-u[0]%y,u[1]-u[1]%y),r.strokeStyle=
"#000",r.strokeRect(u[0]-u[0]%y,u[1]-u[1]%y,y,y)):S===ra.Ba?d(E.t,u[0]-8,u[1]-24,1):S===ra.B?d(E.B,u[0]-8,u[1]-8,0):S===ra.K?f(r,E.K,u[0],u[1]):S===ra.h&&(r.fillStyle="#ea0",r.strokeStyle="#330",r.fillRect(u[0]-8,u[1]-8,16,16),r.strokeRect(u[0]-8,u[1]-8,16,16),r.fillStyle="#000",r.fillText("C",u[0]-4,u[1]+4)),r.globalAlpha=1);window.requestAnimationFrame(Qa)}var O=640,H=400,y=16,P=O/y,Ra=H/y,E={B:0,Qa:1,s:2,K:3,q:4,t:5,C:6,O:7,Ra:8,D:9,Oa:10,Pa:11},ya=[{frame:{x:30,y:0,a:30,b:14},g:{x:1,y:1,a:30,
b:14},frames:[{x:1,y:1,a:15,b:11},{x:17,y:1,a:15,b:13}]},{frame:{x:14,y:40,a:14,b:8},g:{x:1,y:7,a:14,b:8}},{frame:{x:32,y:14,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:0,y:24,a:14,b:24},g:{x:1,y:7,a:14,b:24}},{frame:{x:16,y:48,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:0,y:0,a:30,b:24},g:{x:1,y:3,a:30,b:24},frames:[{x:0,y:0,a:15,b:24},{x:16,y:0,a:13,b:24}]},{frame:{x:48,y:14,a:16,b:10},g:{x:0,y:10,a:16,b:10}},{frame:{x:14,y:24,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:31,y:32,a:6,b:14},g:{x:4,
y:1,a:6,b:14}},{frame:{x:0,y:48,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:36,y:32,a:11,b:13},g:{x:0,y:0,a:12,b:13}},{frame:{x:49,y:30,a:15,b:16},g:{x:0,y:0,a:15,b:16}}],za=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],ba=!(!window.btoa||!window.atob),Sa="023123467".split(""),Aa=200,z={za:0,Ca:1,ua:2,ta:3,da:4,sa:5,Ea:6,wa:7,pa:8,ea:9,s:10,qa:11,ra:12,Da:13},g={W:37,ja:38,X:39,va:40,I:69,N:32,k:27,H:68,J:74,h:67,m:78,n:84,ya:73},Ga=2E3,A={k:0,l:1,f:2},tb=500,Cb=1500,Eb=1500,ib=15,
L={EMPTY:"0",D:"1",q:"2",O:"3",Sa:"4",xa:"5",C:"6",s:"7"},Da=8,ra={Ba:Da+0,B:Da+1,K:Da+2,h:Da+3},kb=Da+4,Mb=3,Nb=5E3,Ub=75,xb=25,ob=7,lb=3,Gb=3,Hb=5,Jb=5E3,sb=10,Rb=16,Qb=3,nb=3,Sb=3,gb=3,Tb=16,Kb=2E3,rb=10,Ha=12,wb=[1,-6],Pb=13,s={m:0,ha:1,U:2,ca:3,L:4,n:5,ga:6,h:7,M:8,V:9};(function(){for(var a=0,b=["webkit","moz"],d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[b[d]+"RequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var d=
(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);a=d+e;return f})})();var R=!1,Oa=document.getElementById("o"),ka=Oa.getBoundingClientRect(),ub=[100,100],mb=!1,sa=null,Ua=null,fb=null,yb=null;if("ontouchstart"in document.documentElement||window.navigator.msMaxTouchPoints)for(var R=!0,Ua=window.navigator.msMaxTouchPoints?"MSPointerDown":"touchstart",fb=window.navigator.msMaxTouchPoints?"MSPointerUp":"touchend",yb=window.navigator.msMaxTouchPoints?"MSPointerMove":
"touchmove",pb=document.getElementsByClassName("b"),bb=0;bb<pb.length;bb++)-1===pb[bb].getAttribute("class").indexOf("e")&&pb[bb].setAttribute("class","b");var da=document.getElementById("C"),r=da.getContext("2d"),oa=new Image,Ta=document.createElement("canvas"),qb=0,ab=document.createElement("canvas"),Z=ab.getContext("2d"),$a=document.createElement("canvas"),Fb=$a.getContext("2d"),Ma=[],vb={},Wa=null,Xa=0,u=[0,0],cb=!1,$=!1,ja={R:{},Ma:function(a){ja.R[a.keyCode]=void 0},La:function(a){ja.R[a.keyCode]=
pa}},pa=0,m={state:A.k,Y:da.getBoundingClientRect(),time:0,ka:0,la:0,o:null},jb=0,Za=0,Ya=void 0,Bb={position:null,text:void 0,color:"#0f0",time:0,Ia:!1},Na=[],fa=[],Ia=null,hb=!1,S=0,a={position:null,speed:4,v:0,S:0,oa:0,Ja:2,Xa:-6.8,F:!1,G:!1,e:!1,r:!1,w:!1,p:0,c:void 0,u:0,Z:rb,cb:!1},e={position:null,d:null,i:0,A:0,$:sb};p=w=b=null;t=1;var C={position:null,d:null,Ka:0,na:gb},Va={ma:null,position:null,T:null,size:1},Q=[],Ob={position:null},Ca=[],Ib={position:null,speed:6},qa=[],Db={position:null,
d:null,color:"#000",time:0,size:2,speed:2},Ba=[],zb=[["Tutorial",[33,370],[O-24,55],[300,365],[20,70],3E6,"00000000000000000000000000000000000000000000000000000000000000000000000000000000330000000000000000000000000000000000006000000000000000000000000000000000000000110000000000033300000000000006000000000000110000000003330000000000001110000000000000000000000333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005500000000000000000000000000000000000000550000000000007000000000000002000000000111111111111111111111111111111200000000000000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000000000000020000000001111111111111111111111111111111111111111",
[1],[[20,340,["PLAYER 1"]],[100,340,["ARROWS: move/jump"]],[250,340,[(R?"I":"SPACEBAR")+": grab/release crate"]],[500,340,["UP/DOWN: Climb"]],[450,250,["Crates break if you fall from too high"]],[160,250,[(R?"I":"SPACEBAR")+": buy candies when not holding crate","E: Use candy to gain speed"]],[10,230,["Deliver crate to green area"]],[560,30,["PLAYER 2",(R?"analogPad":"Mouse")+": move"]],[390,80,["Hide from granny in nest"]],[390,130,[(R?"A":"RClick")+": eat from nest or crumbs",(R?"S":"LClick")+": shoot!"]],
[150,70,["Don't touch roofs or Luke"]]]],["Level 1",[25,366],[616,24],[41,364],[513,180],6E4,"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000003330000000000000000000000000000000000003333300033000000000000000000000000000000000000000000000000000000000000000000000000550000020000000000000200000000000000000055020002000111111111120000333000000000111112000200133333330002000000000000000000000200021130000000000200000000000000000000020002000000000000020000000000000000000002000200020000000002111111100111001101111100111112000000000200000000000000000000000033333200000000000000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000700001111111111111111111111111111111111111111",
[1,2]],["Level 2",[28,143],[600,296],[588,365],[51,50],12E4,"33330000000000000000000000000000000000000000000000000033000000000330000000000000055000000000000000000000000000000000000005500000000000000003030000000000000000001111111000000000000030000000000000110010000000010000000000000000000000000100301000000000000200000200000200000200000000100000000011120111102000201111021113002010111100000002000000020200000002000000211100000000000100000000200000000100000020000000000000000000000000000000000002002000000000000000000000000000000000030211100000001110000000000000000000000030020000000000000000000000003333300000000002000000000000000000000000000000000003020200000000000001100000000000000000000002110000000000000000000000000020700000020200000000000600000000000000112110000002020000060000111000010000000000200000000201000011100000000000000000000020000000020000000000000000000000000000002000000002000000000000000000000000000000200000000200000000001111111111111111111111111111111111111111",
[1,2]],["Level 3",[17,349],[281,39],[88,317],[49,163],24E4,"00000000000000010001000000000000000000000000000000300001666100003000000000000020000000000003000111110003000000000007002000000000000030000000003000000000001110203000000000000000000000000000000000000020332200000000000000000000000000000000002033202000000000000000000000000000000000203320320000000000222000000000000000000020332033111001111100011111000110011001102055200000000000000000000000000110011000205520000000000000000000000000000000000020111100000000000000000000000000000000002000000000000000030003000000000220022000200000000000000030000030000200000000000020000000000000000300030000020000000000002000003030300000000200000002011001100110200003030303030303020000000200011001100020000000000030303032111111000000000000000000000000000000000203030303030000000000000000011100070000023030303030300000000000000000000011100002000000000000000000000011110000000000000200000000000000000000001111111111111111111111111111111111111111",
[1,2,3]],["Level 4",[75,370],[O-24,24],[83,365],[80,53],3E5,"33333300000000000000000000000000000000600000000000000000000000000000000000000011055000000000000000000000003333000000000005500000000000000002000000000000000000001111110011010101111201110011110000000000000000000003030000000000000000100000000000000000000000000700000000000001000000000001110000000000111111000000000010020000002000000000000033333330000333330112100000200033333300000000000000000000000200000020000000000000000000000000000000020000002000000000000010101010111000020200000000211111111111111000000033311001111011100020033333333330000000000003300000033333002000000000000000000000000000000000000000200000000000000000200000000000020000000020111100111110011120111001111112011111002000000000000000000000000303030200000000000000000000000000007000000000020000000000333330003030300011110000200002000000000000000000000000000000000021111200000000000000000000000000000000002000000000001111111111111111111111111111111111111111",
[2,3,4]]],B=window.localStorage&&window.localStorage.Aa&&JSON.parse(window.localStorage.Aa)||zb,Lb=B.length-zb.length+1,v=0;oa.onload=function(){Ta.width=qb=oa.naturalWidth;Ta.height=oa.naturalHeight;var a=Ta.getContext("2d");a.translate(oa.naturalWidth,0);a.scale(-1,1);a.drawImage(oa,0,0);G(v);Qa(1)};oa.src="imgmap.png";ab.width=$a.width=O;ab.height=$a.height=H;for(var db=0;db<za.length;db++)vb[db]=eb.Ga(["synth",0,0.1,0,0.208,0,0.12,20,za[db],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);Wa=
Sa.slice();x(z.za,["square",0,0.3,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,0,0,0,0.783,0,0,0,0]);x(z.Ca,["noise",0,0.3,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);x(z.sa,["square",0,0.3,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);x(z.pa,["saw",0,0.3,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);x(z.ua,["saw",0,0.3,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,
0,0.5,-0.592,0,0.094,0.066,1,0,0,0.28,0]);x(z.wa,["synth",0,0.3,0,0.32,0.348,0.44,20,372,417,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);x(z.Ea,["synth",0,0.3,0,0.13,0.345,0.41,253,1168,1407,-0.0060,-0.082,0,0.01,3E-4,0,0.206,0.166,0,0,0,0,0,1,0,0,0,0]);x(z.da,["noise",0,0.3,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);x(z.ta,["noise",0,0.3,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);x(z.ea,
["square",0,0.3,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);x(z.s,["square",0,0.3,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);x(z.qa,["synth",0,0.3,0,0.44,0.579,1.004,20,1793,2400,-0.202,0,0,8.6962,0.5346,0.666,-0.298,0.671,0,0,0,0,0,1,0,0,0,0]);x(z.ra,["noise",0,0.127,0.043,0.124,0,0.282,20,2400,20,1,-1,0,0.01,-0.3,-1,0.956,0.272,0,0.68,0,-0.998,-1,1,1,0,0,-0.998]);x(z.Da,["noise",0,0.126,0,0.07,0,0.232,2400,2400,2400,
-1,-1,0,0.01,-0.3,-1,-1,0,0,-1,0,0.0040,0,1,1,0,0,-1]);window.addEventListener("keyup",ja.Ma,!1);window.addEventListener("keydown",ja.La,!1);if(R){l(da,Ua,function(a){a.preventDefault();m.state===A.k&&F()});T("x",g.k);T("e",g.I);T("l",g.W);T("u",g.ja);T("r",g.X);T("d",g.va);T("i",g.N);T("s",g.H);T("a",g.J);T("c",g.h);T("t",g.n);T("n",g.m);var Ab=function(a){a.preventDefault();sa=a.changedTouches||a;ka=Oa.getBoundingClientRect();mb=!0};l(Oa,Ua,Ab);l(Oa,yb,Ab);l(Oa,fb,function(a){a.preventDefault();
mb=!1});l(document.body,"contextmenu",function(a){a.preventDefault()})}else l(da,"click",ca),l(da,"contextmenu",La),l(da,"mousedown",function(a){1===a.which&&(cb=!0);m.state===A.f&&cb&&ca()}),l(da,"mouseup",function(a){1===a.which&&(cb=!1)}),l(da,"mousemove",function(a){u=M(a.clientX,a.clientY);m.state===A.l?e.d=u.slice():m.state===A.f&&cb&&ca()})})();

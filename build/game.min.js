/*1.4.7 */var oa={};
(function(b){function y(b,e){return e?l(b&255)+y(b>>8,e-1):""}var p=this.Fa=b||44100,q=2*p,l=String.fromCharCode,e;this.Ya=function(b){var L=Audio,m=btoa,l="",U=b.length;for(z=0;z<U;z++)var E=32767*b[z]|0,E=-32768>E?-32768:32767<E?32767:E,E=E+(0>E?65536:0),l=l+String.fromCharCode(E&255,E>>8);b=l;b=["RIFF",36+(e=b.length),"WAVEfmt ",16,1,1,p,q,2,16,"data",e,b];l="";for(z=0;z<b.length;z++)l+="s"=="s4s4224422s4s"[z]?b[z]:y(b[z],"s4s4224422s4s".charCodeAt(z)-48);return new L("data:audio/wav;base64,"+m(l))};
var D,z,F=Math.sin,m=2*Math.PI;this.filter=function(b,e,l,p,m,E,q,y,r,F){l=l?l:1;p=p?p:b.length;D=b.slice(0);for(z=l;z<p;z++)D[z]=e(b,D,l,p,z,m,E,q,y,r,F);return D};this.filters={fb:function(b,e,l,p,m,q){return e[m-1]+q*(b[m]-e[m-1])},gb:function(b,e,l,p,m,q){return e[m-1]+q*(p-m)/(p-l)*(b[m]-e[m-1])},eb:function(b,e,l,p,m,q){return q*(e[m-1]+b[m]-b[m-1])}};this.Ha=function(b,e,l,q,y,r,D,F,qa){e=e*m/p;var V=Array(b|0);for(z=0;z<b;z++)V[z]=l(z*e,q,y,r,D,F,qa);return V};var r=0;this.Q={Za:function(b){4>
b%m&&(r=2*Math.random()-1);return r},hb:Math.random,ab:Math.sin,bb:function(b){return F(b)+0.5*F(b/2)+0.3*F(b/4)},$a:function(b){return 2*(b/m-(b/m+0.5|0))},Na:function(b,e){return F(b)>e?1:F(b)<e?-1:e}}}).apply(oa);var Ka={};
(function(){this.ia=[];this.fa={square:oa.Q.Na,saw:oa.Q.$a,sine:oa.Q.ab,noise:oa.Q.Za,synth:oa.Q.bb};this.Va=function(){var b=[],y;for(y in this.fa)b.push(y);return b};this.Wa=function(){function b(b,e,q,z,F){void 0===F&&(F=(q-e)/1E3);b={name:b,id:b.replace(/ /g,""),min:e,max:q,step:F,Ua:z,type:"range",group:p};y.push(b)}var y=[],p=0,q=this.Va();(function(b,e,q){b={name:b,id:b.replace(/ /g,""),options:e,Ua:q,type:"option",group:p};y.push(b)})("Generator",q,q[0]);b("SuperSamplingQuality",0,16,0,1);
b("MasterVolume",0,1,0.4);p++;b("AttackTime",0,1,0.1);b("SustainTime",0,2,0.3);b("SustainPunch",0,3,2);b("DecayTime",0,2,1);p++;b("MinFrequency",20,2400,0,1);b("StartFrequency",20,2400,440,1);b("MaxFrequency",20,2400,2E3,1);b("Slide",-1,1,0);b("DeltaSlide",-1,1,0);p++;b("VibratoDepth",0,1,0);b("VibratoFrequency",0.01,48,8);b("VibratoDepth Slide",-0.3,1,0);b("VibratoFrequencySlide",-1,1,0);p++;b("ChangeAmount",-1,1,0);b("ChangeSpeed",0,1,0.1);p++;b("SquareDuty",0,0.5,0);b("SquareDutySweep",-1,1,0);
p++;b("RepeatSpeed",0,0.8,0);p++;b("PhaserOffset",-1,1,0);b("PhaserSweep",-1,1,0);p++;b("LPFilterCutoff",0,1,1);b("LPFilterCutoffSweep",-1,1,0);b("LPFilterResonance",0,1,0);b("HPFilterCutoff",0,1,0);b("HPFilterCutoffSweep",-1,1,0);return y};this.Ha=function(b){var y=2*Math.PI,p=Math.sin,q=Math.pow,l=Math.abs,e=oa.Fa,D=b.SuperSamplingQuality|0;1>D&&(D=1);for(var e=e*D,z=[{P:0,ba:1,time:b.AttackTime},{P:1+b.SustainPunch,ba:1,time:b.SustainTime},{P:1,ba:0,time:b.DecayTime}],F=z.length,m=0;m<F;m++)z[m].aa=
1+(z[m].time*e|0);for(var r=void 0,K=0,L=-1,ea=0,za=-1,U=0,m=0;m<F;m++)U+=z[m].aa;U<e/2&&(U=e/2);var E=Array(U/D|0),M=0,pa=0,qa=Ka.fa[b.Generator];void 0===qa&&(qa=this.fa.Na);var V=0,V=b.SquareDuty,Oa=b.SquareDutySweep/e,fa=0,H=b.StartFrequency*y/e,Y=1+64*q(b.Slide,3)/e,Z=q(b.DeltaSlide,3)/(1E3*e);void 0!==D&&(Z/=D);b.MinFrequency>b.StartFrequency&&(b.MinFrequency=b.StartFrequency);b.MaxFrequency<b.StartFrequency&&(b.MaxFrequency=b.StartFrequency);for(var ja=b.MinFrequency*y/e,Pa=b.MaxFrequency*
y/e,ra=0,ga=b.VibratoFrequency*y/e,$=b.VibratoDepth,sa=1+3*q(b.VibratoFrequencySlide,3)/e,Aa=b.VibratoDepthSlide/e,Ba=0,Ga=b.ChangeSpeed*e,ka=q(b.ChangeAmount,2),ka=0<b.ChangeAmount?1+10*ka:1-0.9*ka,Ha=Array(1024),m=0;1024>m;m++)Ha[m]=0;var Ca=0,W=1020*q(b.PhaserOffset,2),ta=4E3*q(b.PhaserSweep,3)/e,N=1E-5<l(ta)||1E-5<l(W),P=0.0010<b.HPFilterCutoff||0.999>b.LPFilterCutoff,A=0,Q=0,ha=q(b.LPFilterCutoff,3)/10,G=1+b.HPFilterCutoffSweep/1E4,aa=5/(1+20*q(b.LPFilterResonance,2))*(0.01+b.LPFilterCutoff);
0.8<aa&&(aa=0.8);var aa=1-aa,Qa=0.999>b.LPFilterCutoff,ua=0,ba=q(b.HPFilterCutoff,2)/10,Ra=1+b.HPFilterCutoffSweep/1E4,v=0,h=U;0<b.RepeatSpeed&&(h=q(1-b.RepeatSpeed,2)*e+32);for(var Sa=b.MasterVolume,x=0,m=0;m<U;m++)M=qa(fa,V,0),V+=Oa,0>V?V=0:0.5<V&&(V=0.5),v>h&&(fa=0,H=b.StartFrequency*y/e,Y=1+3*q(b.Slide,3)/e,Z=q(b.DeltaSlide,3)/(1E3*e),void 0!==D&&(Z/=D),Ba=0,Ga=b.ChangeSpeed*e,ka=1+(b.ChangeAmount|0)/12,v=0),v+=1,fa+=H,Y+=Z,H*=Y,Ba>Ga&&(H*=ka,Ga=U),Ba+=1,H>Pa?H=Pa:H<ja&&(H=ja),ra+=ga,r=H*p(ra)*
$,fa+=r,ga*=sa,Aa&&($+=Aa,0>$?Aa=$=0:1<$&&($=1,Aa=0)),P&&(0.0010<l(ba)&&(ba*=Ra,1E-5>ba?ba=1E-5:0.1<ba&&(ba=0.1)),r=A,ha*=G,0>ha?ha=0:0.1<ha&&(ha=0.1),Qa?(Q+=(M-A)*ha,Q*=aa):(A=M,Q=0),A+=Q,ua+=A-r,M=ua*=1-ba),N&&(W+=ta,0>W&&(W=-W,ta=-ta),1023<W&&(W=1023,ta=0),Ha[Ca]=M,M+=Ha[Ca-(W|0)+1024&1023],Ca=Ca+1&1023),m>za&&(L+=1,r=L<F?z[L]:{P:0,ba:0,aa:U},K=r.P,ea=(r.ba-r.P)/(r.aa+1),za+=r.aa),M*=K,K+=ea,M*=Sa,1<D?(pa+=M,0===(m+1)%D&&(E[x]=pa/D,x+=1,pa=0)):E[m]=M;b=e/100|0;y=Array(b);for(m=0;m<b;m++)y[m]=0;
return y.concat(E).concat(y)};this.ia=this.Wa()}).apply(Ka);var eb={};(function(){this.Ga=function(b){b=Ka.Ha(this.Ta(b));return oa.Ya(b)};this.Ta=function(b){for(var y={},p=Ka.ia.length,q=0;q<p;q++)y[Ka.ia[q].id]=b[q];return y}}).apply(eb);(function(){var b,y,p,q;function l(c,a,b){c.addEventListener?c.addEventListener(a,b,!1):c.attachEvent?c.attachEvent("on"+a,b):c["on"+a]=b}function e(c,a,b,d,e,m){var h=aa[c].frame,f=aa[c].g;c=aa[c].frames;d=m?c[Math.floor(m*d/1E3)%c.length]:c[d];e?n.drawImage(Ta,qb-(h.x+d.x)-d.a,h.y+d.y,d.a,d.b,a+f.x,b+f.y,d.a,d.b):n.drawImage(va,h.x+d.x,h.y+d.y,d.a,d.b,a+f.x,b+f.y,d.a,d.b)}function D(c,a,b,d,e,h){var f=aa[a].frame;a=aa[a].g;c.drawImage(va,f.x,f.y,e||f.a,h||f.b,b+a.x,d+a.y,a.a,a.b)}function z(c,a){var b=
c-f.Y.left,d=a-f.Y.top,b=Math.max(0,Math.min(b,N-1)),d=Math.max(0,Math.min(d,P-1));return[b,d]}function F(c,a,b,d,e,f,h){var m=c.fillStyle,k=c.textAlign,n=c.font;c.fillStyle=e;c.font=h;c.textAlign=f;for(a=a.slice();0<a.length;)c.fillText(a.shift(),b,d),d+=10;c.fillStyle=m;c.font=n;c.textAlign=k}function m(c){da.style.cursor=c?"auto":"none"}function r(c,a){if(ua)try{La[c]=eb.Ga(a)}catch(b){}}function K(c){if(ua)try{La[c]&&(La[c].pause(),La[c].currentTime=0,La[c].play())}catch(a){}}function L(c,a){var b=
document.getElementById(c);l(b,Ua,function(c){c.preventDefault();la.La({keyCode:a})});l(b,fb,function(c){c.preventDefault();la.Ma({keyCode:a})})}function ea(c,a,b,d){var e=Object.create(Bb);e.position=a;e.text=[c];e.color=b;e.time=wa+Cb;e.Ia=d||!1;Ma.push(e)}function za(c,a,b,d,e){var f=Object.create(Db);f.position=c.slice();f.d=a.slice();f.color=b;f.time=wa+Eb;f.size=d;f.speed=e;Da.push(f)}function U(c){var a=c[t.ca],b,d,e,f;Va.T=a;for(var h=R.length=0;h<c[t.h].length;h++)b=c[t.h][h],d=Object.create(Va),
d.size=b,e=document.createElement("canvas"),e.width=Ia+b,e.height=Ia+b,f=e.getContext("2d"),f.fillStyle="#ea0",f.strokeStyle="#330",f.fillRect(0,0,Ia+b,Ia+b),f.strokeRect(0,0,Ia+b,Ia+b),f.fillStyle="#000",f.fillText(b,5,10),d.ma=e,e=a[0]+16*h,b=a[1]-b,d.position=[e,b],d.T=[e,b],R.push(d)}function E(c){c=f.o=C[c]||C[w];a.position=c[t.ha].slice();a.u=0;a.v=0;a.oa=0;a.c=void 0;a.Z=rb;a.w=!1;a.G=!1;a.r=!1;a.e=!1;a.j=!1;d.$=sb;d.i=0;d.A=0;d.position=c[t.U].slice();d.d=c[t.U].slice();b=c[t.L].slice();y=
[c[t.L][0]+15,c[t.L][1]+23];p=y.slice();q=1;B.position=B.d=null;B.na=gb;f.time=0;pa(x.k);T=0;Ea.length=0;xa.length=0;Ma.length=0;Da.length=0;ia="4444444444444444444444444444444444444444"+c[t.ga]+"4444444444444444444444444444444444444444";ia=ia.split("");Ja=null;U(c);Wa=ba.slice();window.localStorage&&(window.localStorage.Aa=JSON.stringify(C));M()}function M(){var c,a;for(c=0;c<Q;c++)for(a=0;a<ha;a++)Ca(Fb,ia[Q*a+c],c*A,a*A)}function pa(c){f.state=c;if(S){var a=document.getElementsByClassName("e");
c="b e"+(c===x.f?"":" h");for(var b=0;b<a.length;b++)a[b].setAttribute("class",c)}}function qa(c){pa(x.l);f.time=wa+f.o[t.n];ua&&(Xa=c+Ra);m()}function V(c){f.ka+=1;m(!0);K(v.Ea);Ya=!0;E(w);Za=c+Sa}function Oa(c){f.la+=1;m(!0);K(v.wa);Ya=!1;E(w);Za=c+Sa}function fa(c,a){return Math.atan((a[1]-c[1])/(a[0]-c[0]))}function H(c,a){return c&&a&&Math.sqrt(Math.pow(c[0]-a[0],2)+Math.pow(c[1]-a[1],2))}function Y(a,b){return ia[Q*Math.floor(b/A)+Math.floor(a/A)]}function Z(a,b,d,e,f){var h=b,m=Y(a,h);d=a+
d;topRight=Y(d,h);bottomRight=Y(d,b+e);bottomLeft=Y(a,b);return m===f||topRight===f||bottomRight===f||bottomLeft===f}function ja(a,b,d,e,f){b+=e;e=Y(a,b);bottomLeft=Y(a+d,b);return e===f||bottomLeft===f}function Pa(){var c=a.v,b=ra();if(a.e)c=a.v;else if(a.r)c=Math.min(b,c+b/25);else if(c*=Math.min(0.2*b,0.8),0.2>c||ga(J.q))c=0;a.v=c;return ga(J.q)?b/2:c}function ra(){return Math.max(1,a.speed+a.S-(void 0!==a.c?R[a.c].size:0))}function ga(c){return Z(a.position[0]-8,a.position[1]-32,16,32,c)||Z(a.position[0],
a.position[1]-8,0,0,c)}function $(a){a&&a.preventDefault();if(f.state===x.f)hb=!hb;else if(f.state===x.l&&d.A<wa){a=z(u[0],u[1]);var b=d.i;if((ja(d.position[0]-8,d.position[1]-8,16,16,J.C)||Z(d.position[0],d.position[1],0,0,J.C))&&d.i<Gb)K(v.ea),d.i++,ea("+"+(d.i-b)+"\u21a1",[d.position[0]-4,d.position[1]-4],"#0c0");else{var e;for(e=0;e<Ea.length;e++)if(H(a,Ea[e].position)<ib){d.i=Math.max(d.i,Hb);ea("+"+(d.i-b)+"\u21a1",[d.position[0]-4,d.position[1]-4],"#0c0");K(v.ea);Ea.splice(e,1);break}}}}function sa(){if(f.state===
x.f)if(T<Fa){var c=Q*Math.floor(u[1]/A)+Math.floor(u[0]/A);c<ia.length-Q&&c>Q&&(ia[c]=""+T);M()}else if(T===ya.Ba)a.position=u.slice();else if(T===ya.B)d.position=u.slice();else if(T===ya.K)b=u.slice(),y=[b[0]+15,b[1]+23],p=y.slice();else{if(T===ya.h)for(Va.T=u.slice(),c=0;c<R.length;c++){var e=R[c];e.position[0]=u[0]+16*c;e.position[1]=u[1]-e.size}}else f.state!==x.k||S?0<d.i&&d.A<wa&&(d.i--,K(v.ua),c=Object.create(Ib),c.position=d.position.slice(),xa.push(c)):u[0]>d.position[0]-16&&(u[0]<d.position[0]+
16&&u[1]>d.position[1]-16&&u[1]<d.position[1]+16)&&qa(wa)}function Aa(a){for(var b=60;0<b--;)za(d.position,[d.position[0]-Math.floor(128*Math.random()-64),d.position[1]+Math.ceil(128*Math.random()-64)],"#000",Math.ceil(3*Math.random()),Math.ceil(5*Math.random()));d.A=a+Jb;K(v.ta);d.i=0;d.$--;ea("-1\u2665",[d.position[0]-4,d.position[1]-4],"#c00");0>=d.$?V(a):Ga(a);jb=a+tb}function Ba(a){if(!Ja){Ja=[];for(var b=0;b<ia.length;b++)ia[b]===J.D&&Ja.push(b)}b=Ja[Math.floor(Math.random()*Ja.length)]+1;b=
[b%Q*A,Math.floor(b/Q)*A];B.d=[b[0]-6,b[1]-10];B.position?K(v.ra):B.position=B.d.slice();B.Ka=a+Kb;q+=0.05}function Ga(a){B.position||0<--B.na||(B.na=gb,K(v.qa),Ba(a),M())}function ka(c,d){for(var e=80;0<e--;)za(a.position,[a.position[0]-Math.floor(128*Math.random()-64),a.position[1]-16-Math.ceil(128*Math.random()-64)],0.4>Math.random()?"#330":"#ea0",Math.ceil(3*Math.random()),Math.ceil(4*Math.random()));ea(0.5<Math.random()?"My mirrors!":"Be careful!",[b[0]+4,b[1]],"#fff",!0);K(v.Ca);a.c=void 0;
c.position=c.T.slice();a.Z--;ea("-1\u25fc",[a.position[0]-4,a.position[1]-32],"#c00");jb=d+tb;0>=a.Z?Oa(d):Ga(d)}function Ha(a){var b=a||C[w];a=[a?b[t.m]:"CustomLevel"+Lb++,b[t.ha].slice(),b[t.U].slice(),b[t.ca].slice(),b[t.L].slice(),b[t.n],b[t.ga],b[t.h].slice(),null,!0];C.push(a);f.state===x.k&&(w=C.length-1,E(w))}function Ca(a,b,d,e){var f=null,h=B.position?"rgb("+Math.pow(e,2)+","+Math.floor(e/3)+","+Math.floor(e)+")":"rgb("+Math.floor(e/3)+","+Math.floor(e)+","+Math.pow(e,2)+")";b===J.D?f=G.D:
b===J.O?f=G.O:b===J.Sa?h="#000":b===J.xa?h="#0f0":b===J.C?f=G.C:b===J.q?f=G.q:b===J.s&&(f=G.s);a.fillStyle=h;a.fillRect(d,e,A,A);null!==f&&D(a,f,d,e,A,A)}function W(a,b,d){if(a.position&&a.d){var e=fa(a.position,a.d),f=a.position[0]>a.d[0]?-1:1,h=Math.abs(a.position[0]-a.d[0]),m=Math.abs(a.position[1]-a.d[1]);return h>b||m>b?(b=Math.cos(e)*f*d,d*=Math.sin(e)*f,Math.abs(b)>h&&(b=h*b/Math.abs(b)),Math.abs(d)>m&&(d=m*d/Math.abs(d)),a.position[0]+=b,a.position[1]+=d,!0):!1}}function ta(c){if(!(Za>c)){var s=
la.R;if(f.state===x.k)if(s[h.W]&&!X)w=(w+C.length-1)%C.length,E(w);else if(s[h.X]&&!X)w=(w+1)%C.length,E(w);else if(s[h.I]&&!X)C[w][t.V]||Ha(),pa(x.f),s[h.I]=void 0;else if(s[h.H]&&!X)C[w][t.V]&&(C.splice(w,1),w--,E(w)),s[h.H]=void 0;else if(s[h.J]&&C[w][t.V]&&!X){var l=prompt("JSON",JSON.stringify(C[w]));s[h.J]=void 0}else{if(s[h.ya]||S&&s[h.N]){if(l=prompt("JSON"))try{Ha(JSON.parse(l))}catch(z){alert("Error")}s[h.N]=void 0;s[h.ya]=void 0}}else{if(f.state===x.f){var r=c;if(!X){if(s[h.W])T=(T+kb-
1)%kb;else if(s[h.X])T=(T+1)%kb;else if(s[h.h]){try{if(l=JSON.parse(prompt("Crates",JSON.stringify(C[w][t.h]))),l instanceof Array){for(r=0;r<l.length;r++)"number"===!typeof r&&alert("Error"),l[r]=Math.max(1,Math.min(5,l[r]));C[w][t.h]=l;U(C[w])}}catch(L){alert("Error")}s[h.h]=void 0}else s[h.m]?((l=prompt("Name",C[w][t.m]))&&(C[w][t.m]=l),s[h.m]=!1):s[h.n]&&(r=+prompt("Time",C[w][t.n]),!isNaN(r)&&0<r&&(C[w][t.n]=r),s[h.n]=!1);S&&(s[h.H]&&!X)&&sa();S&&(s[h.J]&&!X)&&$()}}else if(f.state===x.l){s[h.ja]?
ga(J.q)?(a.position[1]=Math.min(P-A,a.position[1]-a.Ja),a.F=!0):a.G||a.e||(a.p=a.Xa,a.G=!0,a.e=!0,a.F=!1,K(v.za)):!s[h.ja]&&a.G?(a.G=!1,a.F=!1):s[h.va]&&ga(J.q)?(a.position[1]=Math.min(P,a.position[1]+a.Ja),a.F=!0):a.F=!1;s[h.W]&&!a.e?(a.r=!0,a.j=!0):s[h.X]&&!a.e?(a.r=!0,a.j=!1):a.r=!1;if(a.r||0<a.v)a.position[0]=Math.min(N-A,Math.max(A,a.position[0]+(a.j?-1:1)*Pa()));if(!s[h.N]||a.G||a.e||a.w)s[h.I]&&!a.w?(a.w=!0,0<a.u&&(a.u--,a.S=Mb,a.oa=c+Nb,l=Object.create(Ob),l.position=[a.position[0]+4,a.position[1]-
7],Ea.push(l),K(v.pa))):s[h.N]||(s[h.I]||!a.w)||(a.w=!1);else a:if(a.w=!0,l=a.c,r=void 0!==l?R[l]:void 0,void 0===r){for(l=0;l<R.length;l++)if(H(a.position,R[l].position)<ib){a.c=l;K(v.da);break a}ga(J.s)&&a.u<lb&&(ea("+"+(lb-a.u)+"\u00a7",[a.position[0]-4,a.position[1]-32],"#0c0"),a.u=lb,K(v.s))}else a.c=void 0,K(v.da),ga(J.xa)&&void 0!==r&&(R.splice(l,1),ea(0.5<Math.random()?"Thank you!":"Good boy!",[b[0]+4,b[1]],"#fff",!0),0>=R.length?V(c):K(v.sa));S&&(s[h.H]&&!X)&&sa();S&&(s[h.J]&&!X)&&$()}s[h.k]&&
(m(!0),f.state===x.f&&(C[w][t.ga]=ia.join("").substring(Q,Q*ha-Q),C[w][t.ha]=a.position.slice(),C[w][t.U]=d.position.slice(),C[w][t.L]=b.slice(),C[w][t.ca]=Va.T.slice()),E(w))}X=!1;for(var ca in la.R)X=X||!!la.R[ca];if(mb&&ma){var I;if(ma.clientX)I=ma;else if(ma&&ma[0])for(ca=0;ca<ma.length;ca++)if(s=ma[ca],s.clientX>=na.left&&s.clientX<na.left+na.width&&s.clientY>=na.top&&s.clientY<na.top+na.height){I=ma[ca];break}if(I){I=[I.clientX-na.left,I.clientY-na.top];s=fa(ub,I);ca=H(ub,I)/12.5;var k;f.state===
x.l?k=d.d:f.state===x.f&&(k=u);k&&(k[0]+=(f.state===x.f?Math.round(Math.cos(s)):Math.cos(s))*(100>I[0]?-ca:ca),k[1]+=(f.state===x.f?Math.round(Math.sin(s)):Math.sin(s))*(100>I[0]?-ca:ca),k[0]=Math.max(0,Math.min(k[0],N-1)),k[1]=Math.max(0,Math.min(k[1],P-1)));hb&&sa()}}}wa=c;f.Y=da.getBoundingClientRect();try{Xa<c&&f.state===x.l&&0<Wa.length&&(vb[Wa.shift()].play(),Xa+=Ra)}catch(Y){}if(f.state===x.l){I=2;var g;k=0;if(!a.e&&ja(a.position[0]-4,a.position[1],8,0,J.D))g=a.position[1]-a.position[1]%A;
else for(;I<=a.p;){if(ja(a.position[0]-4,a.position[1]+I,8,0,J.D)){g=a.position[1]+I-(a.position[1]+I)%A;break}I+=A}g?(a.position[1]=g,a.e&&(a.v/=2,g=void 0!==a.c&&R[a.c])&&(I=Pb-g.size,k=g.size,a.p>I&&ka(g,c)),a.e=!1,a.p>10-2*k&&K(v.Da),a.p=0):ja(a.position[0]-4,a.position[1]-32,8,16,J.q)?(a.e=!1,a.p=0):(a.p+=0.6,a.e=!0,a.position[1]+=a.p);a.oa<c&&0<a.S&&(a.S=0);void 0!==a.c&&(R[a.c].position[0]=a.position[0]+wb[0],R[a.c].position[1]=a.position[1]+wb[1]);g=ja(d.position[0],d.position[1],0,0,J.C)?
y:d.position;k=fa(p,g);I=p[0]>g[0]?-1:1;if(Math.abs(g[0]-p[0])>nb||Math.abs(g[1]-p[1])>nb)p[0]+=Math.cos(k)*I*q,p[1]+=Math.sin(k)*I*q;W(d,Qb,Rb);for(g=0;g<xa.length;g++)if(k=xa[g],k.position[1]+=k.speed,H(a.position,k.position)<ib&&void 0!==a.c)ka(R[a.c],c),xa.splice(g,1),g--;else if(k.position[1]>P||ja(k.position[0],k.position[1],0,0,J.O))xa.splice(g,1),g--;d.A<c&&(ra()*ob+xb>=H(d.position,a.position)||Z(d.position[0],d.position[1],0,0,J.O)||H(p,d.position)<nb)&&Aa(c);B.position&&(void 0!==a.c&&
15>H(a.position,B.position)?(ka(R[a.c],c),B.position=null,q=1,M()):d.A<c&&15>H(d.position,B.position)?(Aa(c),B.position=null,q=1,M()):(W(B,Sb,Tb)&&za(B.position,[B.d[0]+Math.floor(128*Math.random()-64),B.d[1]+Math.floor(128*Math.random()-64)],"#000",Math.ceil(2*Math.random()),Math.ceil(5*Math.random())),B.Ka<c&&Ba(c)));for(k=0;k<Da.length;k++)if(g=Da[k],!W(g,3,g.speed)||g.time<c)Da.splice(k,1),k--;f.time<c&&Oa(c)}f.Y=da.getBoundingClientRect();n.fillStyle="#000";n.fillRect(0,0,N,P);k=g=0;jb>c&&(g=
Math.floor(8*Math.random()-4),k=Math.floor(8*Math.random()-4));n.drawImage($a,g,k);for(k=0;k<R.length;k++)k!==a.c&&(g=R[k],n.drawImage(g.ma,g.position[0]-8,g.position[1]-8));for(k=0;k<Ea.length;k++)g=Ea[k],D(n,G.Qa,g.position[0]-8,g.position[1]-8);for(k=0;k<xa.length;k++)g=xa[k],D(n,G.Ra,g.position[0]-8,g.position[1]-8);D(n,G.K,b[0],b[1]);if(f.o[t.M])for(g=0;g<f.o[t.M].length;g++)F(n,f.o[t.M][g][2],f.o[t.M][g][0],f.o[t.M][g][1],"#000");B.position&&D(n,5<H(B.position,B.d)?G.Pa:G.Oa,B.position[0]-8,
B.position[1]);f.state===x.l?(a.e?e(G.t,a.position[0]-8,a.position[1]-24,0,a.j):a.r||a.F?e(G.t,a.position[0]-8,a.position[1]-24,10,a.j,c):e(G.t,a.position[0]-8,a.position[1]-24,1,a.j),a.S&&(a.e||a.r)&&(n.globalAlpha=0.6,e(G.t,a.position[0]+(a.j?-4:-12),a.position[1]-24,10,a.j,c),n.globalAlpha=0.3,e(G.t,a.position[0]+(a.j?2:-18),a.position[1]-24,10,a.j,c),n.globalAlpha=1)):e(G.t,a.position[0]-8,a.position[1]-24,1);void 0!==a.c&&(g=R[a.c],n.drawImage(g.ma,a.j?g.position[0]+2:g.position[0]-15-g.size,
g.position[1]-10));ra()*ob+Ub>=H(d.position,a.position)&&(n.beginPath(),n.arc(a.position[0],a.position[1],ra()*ob+xb,0,360),n.lineWidth=2,n.strokeStyle=B.position?"#00f":"#f00",n.stroke());f.state===x.l?d.A>c&&0===Math.floor(c/100)%2||e(G.B,d.position[0]-8,d.position[1]-8,2,!1,c):e(G.B,d.position[0]-8,d.position[1]-8,0);n.fillStyle=B.position?"#00f":"#f00";n.fillRect(p[0]-1,p[1]-1,2,2);n.beginPath();n.arc(p[0],p[1],5,0,360);n.lineWidth=2;n.strokeStyle=B.position?"#00f":"#f00";n.stroke();n.fillStyle=
"#fff";f.state===x.l?(k=Math.max(0,Math.ceil((f.time-c)/1E3)),g=k%60,k=Math.floor(k/60),10>g&&(g="0"+g),n.fillText("\u00a7 "+a.u+"   \u25fc "+a.Z+"   \u2732 "+k+":"+g,50,396),n.fillText("\u21a1 "+d.i+"   \u2665 "+d.$,540,12),n.fillStyle="#00deff",n.fillText("LUKE",10,396),n.fillStyle="#f00",n.fillText("CROW",600,12)):f.state===x.f&&n.fillText("< > CHANGE BLOCK   C: CRATES   T: TIME ("+C[w][t.n]+")   N: NAME ("+C[w][t.m]+")"+(S?"   S: PAINT   A: TOGGLE PAINT   analogPad: MOVE":""),12,12);for(k=0;k<
Da.length;k++)g=Da[k],n.fillStyle=g.color,n.fillRect(g.position[0],g.position[1],g.size,g.size);for(k=0;k<Ma.length;k++)g=Ma[k],g.time<c?(Ma.splice(k,1),k--):(F(n,g.text,g.position[0]+1,g.position[1]+1,"#000","center","14px sans-serif"),F(n,g.text,g.position[0],g.position[1],g.color,"center","14px sans-serif"),g.Ia||(g.position[1]-=0.5));f.state===x.k&&(g=f.o,O.fillStyle="rgba(0,0,0,0.7)",O.clearRect(0,0,N,P),O.fillRect(0,0,N,P),O.fillStyle="#fff",O.textAlign="center",O.font="20px courier",O.fillText(f.o[t.m],
N/2,P/2-50),F(O,["Luke "+f.ka],N/2-50,P/2,!0===Ya?"#0f0":"#fff","right"),F(O,[f.la+" Crow"],N/2+50,P/2,!1===Ya?"#0f0":"#fff","left"),O.font="15px courier",O.fillText("A 13kB game by Alberto Congiu",N/2,12),Za<c&&(O.fillText("Click the "+(S?"screen":"crow")+" to start",N/2,P/2+60),O.fillText("< >: Select level",N/2,P/2+100),O.fillText(g[t.V]?"E: EDIT   "+(S?"S":"D")+": DELETE   "+(S?"A":"J")+": EXPORT   I: IMPORT":"E: EDIT   I: IMPORT",N/2,P/2+120)),O.beginPath(),O.arc(d.position[0],d.position[1],
16,0,360),O.lineWidth=2,O.strokeStyle="#fff",O.stroke(),n.drawImage(ab,0,0));f.state===x.f&&(n.globalAlpha=0.6,T<Fa?(Ca(n,""+T,u[0]-u[0]%A,u[1]-u[1]%A),n.strokeStyle="#000",n.strokeRect(u[0]-u[0]%A,u[1]-u[1]%A,A,A)):T===ya.Ba?e(G.t,u[0]-8,u[1]-24,1):T===ya.B?e(G.B,u[0]-8,u[1]-8,0):T===ya.K?D(n,G.K,u[0],u[1]):T===ya.h&&(n.fillStyle="#ea0",n.strokeStyle="#330",n.fillRect(u[0]-8,u[1]-8,16,16),n.strokeRect(u[0]-8,u[1]-8,16,16),n.fillStyle="#000",n.fillText("C",u[0]-4,u[1]+4)),n.globalAlpha=1);window.requestAnimationFrame(ta)}
var N=640,P=400,A=16,Q=N/A,ha=P/A,G={B:0,Qa:1,s:2,K:3,q:4,t:5,C:6,O:7,Ra:8,D:9,Oa:10,Pa:11},aa=[{frame:{x:30,y:0,a:30,b:14},g:{x:1,y:1,a:30,b:14},frames:[{x:1,y:1,a:15,b:11},{x:17,y:1,a:15,b:13}]},{frame:{x:14,y:40,a:14,b:8},g:{x:1,y:7,a:14,b:8}},{frame:{x:32,y:14,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:0,y:24,a:14,b:24},g:{x:1,y:7,a:14,b:24}},{frame:{x:16,y:48,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:0,y:0,a:30,b:24},g:{x:1,y:3,a:30,b:24},frames:[{x:0,y:0,a:15,b:24},{x:16,y:0,a:13,b:24}]},
{frame:{x:48,y:14,a:16,b:10},g:{x:0,y:10,a:16,b:10}},{frame:{x:14,y:24,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:31,y:32,a:6,b:14},g:{x:4,y:1,a:6,b:14}},{frame:{x:0,y:48,a:16,b:16},g:{x:0,y:0,a:16,b:16}},{frame:{x:36,y:32,a:11,b:13},g:{x:0,y:0,a:12,b:13}},{frame:{x:49,y:30,a:15,b:16},g:{x:0,y:0,a:15,b:16}}],Qa=[523.25,587.33,659.26,698.46,783.99,880,987.77,1046.5,1108.73],ua=!(!window.btoa||!window.atob),ba="023123467".split(""),Ra=200,v={za:0,Ca:1,ua:2,ta:3,da:4,sa:5,Ea:6,wa:7,pa:8,ea:9,s:10,qa:11,
ra:12,Da:13},h={W:37,ja:38,X:39,va:40,I:69,N:32,k:27,H:68,J:74,h:67,m:78,n:84,ya:73},Sa=2E3,x={k:0,l:1,f:2},tb=500,Cb=1500,Eb=1500,ib=15,J={EMPTY:"0",D:"1",q:"2",O:"3",Sa:"4",xa:"5",C:"6",s:"7"},Fa=8,ya={Ba:Fa+0,B:Fa+1,K:Fa+2,h:Fa+3},kb=Fa+4,Mb=3,Nb=5E3,Ub=75,xb=25,ob=7,lb=3,Gb=3,Hb=5,Jb=5E3,sb=10,Rb=16,Qb=3,nb=3,Sb=3,gb=3,Tb=16,Kb=2E3,rb=10,Ia=12,wb=[1,-6],Pb=13,t={m:0,ha:1,U:2,ca:3,L:4,n:5,ga:6,h:7,M:8,V:9};(function(){for(var a=0,b=["webkit","moz"],d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=
window[b[d]+"RequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);a=d+e;return f})})();var S=!1,Na=document.getElementById("o"),na=Na.getBoundingClientRect(),ub=[100,100],mb=!1,ma=null,Ua=null,fb=null,yb=null;if("ontouchstart"in document.documentElement||window.navigator.msMaxTouchPoints)for(var S=!0,Ua=window.navigator.msMaxTouchPoints?"MSPointerDown":"touchstart",
fb=window.navigator.msMaxTouchPoints?"MSPointerUp":"touchend",yb=window.navigator.msMaxTouchPoints?"MSPointerMove":"touchmove",pb=document.getElementsByClassName("b"),bb=0;bb<pb.length;bb++)-1===pb[bb].getAttribute("class").indexOf("e")&&pb[bb].setAttribute("class","b");var da=document.getElementById("C"),n=da.getContext("2d"),va=new Image,Ta=document.createElement("canvas"),qb=0,ab=document.createElement("canvas"),O=ab.getContext("2d"),$a=document.createElement("canvas"),Fb=$a.getContext("2d"),La=
[],vb={},Wa=null,Xa=0,u=[0,0],cb=!1,X=!1,la={R:{},Ma:function(a){la.R[a.keyCode]=void 0},La:function(a){la.R[a.keyCode]=wa}},wa=0,f={state:x.k,Y:da.getBoundingClientRect(),time:0,ka:0,la:0,o:null},jb=0,Za=0,Ya=void 0,Bb={position:null,text:void 0,color:"#0f0",time:0,Ia:!1},Ma=[],ia=[],Ja=null,hb=!1,T=0,a={position:null,speed:4,v:0,S:0,oa:0,Ja:2,Xa:-6.8,F:!1,G:!1,e:!1,r:!1,w:!1,p:0,c:void 0,u:0,Z:rb,cb:!1},d={position:null,d:null,i:0,A:0,$:sb};p=y=b=null;q=1;var B={position:null,d:null,Ka:0,na:gb},
Va={ma:null,position:null,T:null,size:1},R=[],Ob={position:null},Ea=[],Ib={position:null,speed:6},xa=[],Db={position:null,d:null,color:"#000",time:0,size:2,speed:2},Da=[],zb=[["Tutorial",[33,370],[N-24,55],[300,365],[20,70],3E6,"00000000000000000000000000000000000000000000000000000000000000000000000000000000330000000000000000000000000000000000006000000000000000000000000000000000000000110000000000033300000000000006000000000000110000000003330000000000001110000000000000000000000333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005500000000000000000000000000000000000000550000000000007000000000000002000000000111111111111111111111111111111200000000000000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000000000000020000000001111111111111111111111111111111111111111",
[1],[[20,340,["PLAYER 1"]],[100,340,["ARROWS: move/jump"]],[250,340,[(S?"I":"SPACEBAR")+": grab/release crate"]],[500,340,["UP/DOWN: Climb"]],[450,250,["Crates break if you fall from too high"]],[160,250,[(S?"I":"SPACEBAR")+": buy candies when not holding crate","E: Use candy to gain speed"]],[10,230,["Deliver crate to green area"]],[560,30,["PLAYER 2",(S?"analogPad":"Mouse")+": move"]],[390,80,["Hide from granny in nest"]],[390,130,[(S?"A":"RClick")+": eat from nest or crumbs",(S?"S":"LClick")+": shoot!"]],
[150,70,["Don't touch roofs or Luke"]]]],["Level 1",[25,366],[616,24],[41,364],[513,180],6E4,"00000000000000000000000000000000000000600000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000003330000000000000000000000000000000000003333300033000000000000000000000000000000000000000000000000000000000000000000000000550000020000000000000200000000000000000055020002000111111111120000333000000000111112000200133333330002000000000000000000000200021130000000000200000000000000000000020002000000000000020000000000000000000002000200020000000002111111100111001101111100111112000000000200000000000000000000000033333200000000000000000000000000000000000000020000000000000000000000000000000000000002000000000000000000000000000000000000000200000000000000000000000000000700001111111111111111111111111111111111111111",
[1,2]],["Level 2",[28,143],[600,296],[588,365],[51,50],12E4,"33330000000000000000000000000000000000000000000000000033000000000330000000000000055000000000000000000000000000000000000005500000000000000003030000000000000000001111111000000000000030000000000000110010000000010000000000000000000000000100301000000000000200000200000200000200000000100000000011120111102000201111021113002010111100000002000000020200000002000000211100000000000100000000200000000100000020000000000000000000000000000000000002002000000000000000000000000000000000030211100000001110000000000000000000000030020000000000000000000000003333300000000002000000000000000000000000000000000003020200000000000001100000000000000000000002110000000000000000000000000020700000020200000000000600000000000000112110000002020000060000111000010000000000200000000201000011100000000000000000000020000000020000000000000000000000000000002000000002000000000000000000000000000000200000000200000000001111111111111111111111111111111111111111",
[1,2]],["Level 3",[17,349],[281,39],[88,317],[49,163],24E4,"00000000000000010001000000000000000000000000000000300001666100003000000000000020000000000003000111110003000000000007002000000000000030000000003000000000001110203000000000000000000000000000000000000020332200000000000000000000000000000000002033202000000000000000000000000000000000203320320000000000222000000000000000000020332033111001111100011111000110011001102055200000000000000000000000000110011000205520000000000000000000000000000000000020111100000000000000000000000000000000002000000000000000030003000000000220022000200000000000000030000030000200000000000020000000000000000300030000020000000000002000003030300000000200000002011001100110200003030303030303020000000200011001100020000000000030303032111111000000000000000000000000000000000203030303030000000000000000011100070000023030303030300000000000000000000011100002000000000000000000000011110000000000000200000000000000000000001111111111111111111111111111111111111111",
[1,2,3]],["Level 4",[75,370],[N-24,24],[83,365],[80,53],3E5,"33333300000000000000000000000000000000600000000000000000000000000000000000000011055000000000000000000000003333000000000005500000000000000002000000000000000000001111110011010101111201110011110000000000000000000003030000000000000000100000000000000000000000000700000000000001000000000001110000000000111111000000000010020000002000000000000033333330000333330112100000200033333300000000000000000000000200000020000000000000000000000000000000020000002000000000000010101010111000020200000000211111111111111000000033311001111011100020033333333330000000000003300000033333002000000000000000000000000000000000000000200000000000000000200000000000020000000020111100111110011120111001111112011111002000000000000000000000000303030200000000000000000000000000007000000000020000000000333330003030300011110000200002000000000000000000000000000000000021111200000000000000000000000000000000002000000000001111111111111111111111111111111111111111",
[2,3,4]]],C=window.localStorage&&window.localStorage.Aa&&JSON.parse(window.localStorage.Aa)||zb,Lb=C.length-zb.length+1,w=0;va.onload=function(){Ta.width=qb=va.naturalWidth;Ta.height=va.naturalHeight;var a=Ta.getContext("2d");a.translate(va.naturalWidth,0);a.scale(-1,1);a.drawImage(va,0,0);E(w);ta(1)};va.src="imgmap.png";ab.width=$a.width=N;ab.height=$a.height=P;for(var db=0;db<Qa.length;db++)vb[db]=eb.Ga(["synth",0,0.1,0,0.208,0,0.12,20,Qa[db],2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0.1,0]);Wa=
ba.slice();r(v.za,["square",0,0.3,0,0.174,0,0.28,20,497,2400,0.22,0,0,0.01,3E-4,0,0,0,0.0665,0,0,0,0,0.783,0,0,0,0]);r(v.Ca,["noise",0,0.3,0,0.14,0.405,0.116,20,479,2400,-0.07,0,0,0.01,3E-4,0,0,0,0,0,0,-0.086,-0.122,1,0,0,0,0]);r(v.sa,["square",0,0.3,0,0.098,0.504,0.282,20,1582,2400,0,0,0,0.01,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);r(v.pa,["saw",0,0.3,0,0.324,0,0.284,20,631,2400,0.172,0,0.498,19.35,3E-4,0,0,0,0,0,0,0,0,1,0,0,0,0]);r(v.ua,["saw",0,0.3,0,0.212,0,0.028,20,1169,2400,-0.52,0,0,0.01,3E-4,0,0,
0,0.5,-0.592,0,0.094,0.066,1,0,0,0.28,0]);r(v.wa,["synth",0,0.3,0,0.32,0.348,0.44,20,372,417,0,0,0,0.01,3E-4,0,0.374,0.264,0,0,0,0,0,1,0,0,0,0]);r(v.Ea,["synth",0,0.3,0,0.13,0.345,0.41,253,1168,1407,-0.0060,-0.082,0,0.01,3E-4,0,0.206,0.166,0,0,0,0,0,1,0,0,0,0]);r(v.da,["noise",0,0.3,0,0.0020,0.024,0.09,20,372,2400,0,0,0,0.01,3E-4,0,-0.342,0.809,0,0,0,0,0,1,0,0,0,0]);r(v.ta,["noise",0,0.3,0,0.152,0.393,0.274,20,839,2400,-0.31,0,0,0.01,3E-4,0,-0.34,0.783,0,0,0.6096,0.526,-0.0080,1,0,0,0,0]);r(v.ea,
["square",0,0.3,0,0.04,0,0.048,20,578,2400,0.104,0,0.683,19.158,3E-4,0,0,0,0.385,0,0,0,0,1,0,0,0,0]);r(v.s,["square",0,0.3,0,0.046,0.477,0.24,20,1197,2400,0,0,0,0.01,3E-4,0,0.498,0.204,0,0,0,0,0,1,0,0,0,0]);r(v.qa,["synth",0,0.3,0,0.44,0.579,1.004,20,1793,2400,-0.202,0,0,8.6962,0.5346,0.666,-0.298,0.671,0,0,0,0,0,1,0,0,0,0]);r(v.ra,["noise",0,0.127,0.043,0.124,0,0.282,20,2400,20,1,-1,0,0.01,-0.3,-1,0.956,0.272,0,0.68,0,-0.998,-1,1,1,0,0,-0.998]);r(v.Da,["noise",0,0.126,0,0.07,0,0.232,2400,2400,2400,
-1,-1,0,0.01,-0.3,-1,-1,0,0,-1,0,0.0040,0,1,1,0,0,-1]);window.addEventListener("keyup",la.Ma,!1);window.addEventListener("keydown",la.La,!1);if(S){l(da,Ua,function(a){a.preventDefault();f.state===x.k&&qa()});L("x",h.k);L("e",h.I);L("l",h.W);L("u",h.ja);L("r",h.X);L("d",h.va);L("i",h.N);L("s",h.H);L("a",h.J);L("c",h.h);L("t",h.n);L("n",h.m);var Ab=function(a){a.preventDefault();ma=a.changedTouches||a;na=Na.getBoundingClientRect();mb=!0};l(Na,Ua,Ab);l(Na,yb,Ab);l(Na,fb,function(a){a.preventDefault();
mb=!1});l(document.body,"contextmenu",function(a){a.preventDefault()})}else l(da,"click",sa),l(da,"contextmenu",$),l(da,"mousedown",function(a){1===a.which&&(cb=!0);f.state===x.f&&cb&&sa()}),l(da,"mouseup",function(a){1===a.which&&(cb=!1)}),l(da,"mousemove",function(a){u=z(a.clientX,a.clientY);f.state===x.l?d.d=u.slice():f.state===x.f&&cb&&sa()})})();
